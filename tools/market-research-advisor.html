<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…ÙØ±Ø´ÙÙ‘Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
  <link rel="icon" href="../favicon.svg">
  <link rel="stylesheet" href="../global-styles.css" />
  <style>
    .card{background:#fff;border:1px solid #eee;border-radius:14px;padding:18px;margin:12px 0;box-shadow:0 2px 12px rgba(0,0,0,.04)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row .col{flex:1 1 260px}
    .muted{color:#666;font-size:.92rem}
    .kpi{display:flex;gap:12px;flex-wrap:wrap}
    .kpi div{background:#f6f7f9;border:1px solid #e7e9ee;border-radius:10px;padding:10px 12px}
    .pill{display:inline-block;background:#eef6ff;color:#1453b3;border:1px solid #cfe3ff;padding:4px 10px;border-radius:999px;margin:2px}
    .pill-broad{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}
    .pill-phrase{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}
    .pill-exact{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
    .chips{display:flex;gap:6px;flex-wrap:wrap}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .btn{background:#4CAF50;color:#fff;border:none;border-radius:20px;padding:8px 14px;cursor:pointer}
    .btn-secondary{background:#6c757d}
    .platforms{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .platforms label{display:flex;align-items:center;gap:6px;background:#f6f7f9;border:1px solid #e7e9ee;border-radius:999px;padding:6px 10px;cursor:pointer}
    .intent-group{margin:8px 0;padding:12px;background:#f9f9f9;border-radius:8px;border-left:4px solid #007bff}
    .intent-title{font-weight:bold;color:#007bff;margin-bottom:6px;font-size:0.95rem}
    .success{background:#e8f5e8;color:#2d5a2d;border:1px solid #b8d8b8;padding:10px 12px;border-radius:10px;margin:10px 0;display:none}
    .small{font-size:.85rem}
    .advanced{background:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;padding:12px;margin:10px 0}
    .match-info{background:#e7f3ff;padding:8px;border-radius:6px;margin:5px 0;font-size:0.9rem}
    .search-box{position:relative}
    .sector-suggestions{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ddd;border-radius:8px;max-height:200px;overflow-y:auto;z-index:1000;display:none}
    .sector-item{padding:8px 12px;cursor:pointer;border-bottom:1px solid #f0f0f0}
    .sector-item:hover{background:#f5f5f5}
    .sector-item:last-child{border-bottom:none}
  </style>
</head>
<body>
  <div class="container" id="app">
    <h1>ğŸ¯ Ù…ÙØ±Ø´ÙÙ‘Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h1>
    <p class="muted">Ø£Ø¯Ø§Ø© ØªÙˆÙ„ÙŠØ¯ ÙƒÙ„Ù…Ø§Øª Ø¨Ø­Ø« Ø¹Ø±Ø¨ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù…Ø¹ <b>50+ Ù…Ø¬Ø§Ù„ Ù…Ø¹Ø±ÙˆÙ</b> ÙˆÙ‚Ø§Ù…ÙˆØ³ Ù„Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© + Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ© ÙˆØªØµØ¯ÙŠØ± XLSX Ù…ØªÙ‚Ø¯Ù…. Ù…ØµÙ…Ù…Ø© Ø®ØµÙŠØµØ§Ù‹ Ù„Ù„Ù€ Media Buyers Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ†.</p>

    <div class="success" id="successMsg">âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø®Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù†Ø³Ø® Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø£Ùˆ ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù XLSX Ù…ØªÙ‚Ø¯Ù….</div>

    <div class="card">
      <div class="row">
        <div class="col">
          <label>Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
          <select id="country">
            <option value="">Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø©</option>
            <option value="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
            <option value="Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
            <option value="Ø§Ù„ÙƒÙˆÙŠØª">Ø§Ù„ÙƒÙˆÙŠØª</option>
            <option value="Ù‚Ø·Ø±">Ù‚Ø·Ø±</option>
            <option value="Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†">Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
            <option value="Ø¹ÙÙ…Ø§Ù†">Ø¹ÙÙ…Ø§Ù†</option>
            <option value="Ù…ØµØ±">Ù…ØµØ±</option>
            <option value="Ø§Ù„Ø£Ø±Ø¯Ù†">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
            <option value="Ù„Ø¨Ù†Ø§Ù†">Ù„Ø¨Ù†Ø§Ù†</option>
            <option value="Ø§Ù„Ù…ØºØ±Ø¨">Ø§Ù„Ù…ØºØ±Ø¨</option>
            <option value="ØªÙˆÙ†Ø³">ØªÙˆÙ†Ø³</option>
            <option value="Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
          </select>
        </div>
        <div class="col">
          <div class="search-box">
            <label>Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ (Ø§Ø¨Ø­Ø« Ø£Ùˆ Ø§ÙƒØªØ¨)</label>
            <input id="sectorFree" placeholder="Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù„Ø¨Ø­Ø« ÙÙŠ 50+ Ù…Ø¬Ø§Ù„ Ø£Ùˆ Ø§ÙƒØªØ¨ Ù…Ø¬Ø§Ù„ Ø¬Ø¯ÙŠØ¯..." autocomplete="off" />
            <div id="sectorSuggestions" class="sector-suggestions"></div>
          </div>
        </div>
        <div class="col">
          <label>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</label>
          <input id="budget" type="number" min="500" step="100" value="5000" />
        </div>
      </div>

      <div class="advanced">
        <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
        <div class="row">
          <div class="col">
            <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
            <select id="matchType">
              <option value="broad">Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø© (Broad Match)</option>
              <option value="phrase" selected>Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© (Phrase Match)</option>
              <option value="exact">Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø© (Exact Match)</option>
              <option value="mixed">Ù…Ø²ÙŠØ¬ (Ù…ÙˆØµÙ‰)</option>
            </select>
          </div>
          <div class="col">
            <label>ØªØ¶Ù…ÙŠÙ† ÙƒÙ„Ù…Ø§Øª Ø³Ù„Ø¨ÙŠØ©</label>
            <input type="checkbox" id="includeNegatives" checked /> Ù†Ø¹Ù… (Ù…ÙˆØµÙ‰ Ø¨Ù‚ÙˆØ©)
          </div>
          <div class="col">
            <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹</label>
            <select id="expansionLevel">
              <option value="conservative">Ù…Ø­Ø§ÙØ¸ (30-40 ÙƒÙ„Ù…Ø©)</option>
              <option value="moderate" selected>Ù…ØªÙˆØ³Ø· (50-80 ÙƒÙ„Ù…Ø©)</option>
              <option value="aggressive">ØªÙˆØ³Ø¹ÙŠ (100+ ÙƒÙ„Ù…Ø©)</option>
            </select>
          </div>
        </div>
        
        <div class="match-info">
          <strong>Ù…Ø¹Ù„ÙˆÙ…Ø©:</strong> Ø§Ù„Ù…Ø²ÙŠØ¬ ÙŠÙˆØ²Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ù†Ø³Ø¨ Ù…Ø¯Ø±ÙˆØ³Ø©: 60% Ø¹Ø¨Ø§Ø±Ø© + 25% ÙˆØ§Ø³Ø¹Ø© + 15% ØªØ§Ù…Ø©. Ø£ÙØ¶Ù„ Ù„Ù„Ø­Ù…Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.
        </div>
      </div>

      <div class="row">
        <div class="col" style="flex:1 1 100%">
          <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ§Øª</label>
          <div class="platforms" id="platformToggles"></div>
        </div>
      </div>

      <button id="run">ğŸš€ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© + Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</button>
      <div class="actions">
        <button id="copyAll" class="btn">Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</button>
        <button id="copyNegatives" class="btn btn-secondary">Ù†Ø³Ø® Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</button>
        <button id="exportXlsx" class="btn">ØªÙ†Ø²ÙŠÙ„ XLSX Ù…ØªÙ‚Ø¯Ù…</button>
        <button id="exportGoogleAds" class="btn btn-secondary">ØªØµØ¯ÙŠØ± Google Ads</button>
        <button id="demo" class="btn">Ù…Ø«Ø§Ù„ Ø³Ø±ÙŠØ¹</button>
      </div>
    </div>

    <div id="out" style="display:none">
      <div class="card">
        <h2>ğŸ”‘ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</h2>
        <div id="keywords"></div>
        <p class="muted small" id="keywordStats"></p>
      </div>

      <div class="card" id="negativesCard" style="display:none">
        <h2>ğŸš« Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</h2>
        <div id="negativeKeywords" class="chips"></div>
        <p class="muted small">ÙƒÙ„Ù…Ø§Øª Ù„Ø§Ø³ØªØ¨Ø¹Ø§Ø¯Ù‡Ø§ Ù…Ù† Ø­Ù…Ù„Ø§ØªÙƒ Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø± ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬ÙˆØ¯Ø©</p>
      </div>

      <div class="card">
        <h2>âœ… Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</h2>
        <div id="mix" class="chips"></div>
        <p class="muted small" id="mixNote"></p>
      </div>

      <div class="card">
        <h2>ğŸ’° ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</h2>
        <div id="allocation" class="kpi"></div>
      </div>

      <div class="card">
        <h2>ğŸ“ˆ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª</h2>
        <div id="forecasts" class="kpi"></div>
      </div>

      <div class="card">
        <h2>ğŸ“‹ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø³Ø±ÙŠØ¹</h2>
        <ol id="playbook"></ol>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script>
    const COUNTRY_DATA = {
      'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': {currency:'SAR', cpm:{Facebook:1.8,'Google Ads':2.2,Instagram:2.0,Snapchat:3.1,TikTok:2.5}},
      'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': {currency:'AED', cpm:{Facebook:2.1,'Google Ads':2.8,Instagram:2.3,LinkedIn:4.2,YouTube:1.9}},
      'Ø§Ù„ÙƒÙˆÙŠØª': {currency:'KWD', cpm:{Facebook:1.5,'Google Ads':1.9,Instagram:1.7,Snapchat:2.8}},
      'Ù‚Ø·Ø±': {currency:'QAR', cmp:{Facebook:2.3,'Google Ads':3.1,Instagram:2.6,YouTube:2.0}},
      'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†': {currency:'BHD', cpm:{Facebook:1.4,'Google Ads':1.8,Instagram:1.6}},
      'Ø¹ÙÙ…Ø§Ù†': {currency:'OMR', cpm:{Facebook:1.6,'Google Ads':2.0,Instagram:1.8}},
      'Ù…ØµØ±': {currency:'EGP', cpm:{Facebook:0.4,'Google Ads':0.6,Instagram:0.5,TikTok:0.7,YouTube:0.3}},
      'Ø§Ù„Ø£Ø±Ø¯Ù†': {currency:'JOD', cpm:{Facebook:1.2,'Google Ads':1.6,Instagram:1.4}},
      'Ù„Ø¨Ù†Ø§Ù†': {currency:'LBP', cpm:{Facebook:0.8,'Google Ads':1.1,Instagram:0.9}},
      'Ø§Ù„Ù…ØºØ±Ø¨': {currency:'MAD', cpm:{Facebook:0.6,'Google Ads':0.9,Instagram:0.7}},
      'ØªÙˆÙ†Ø³': {currency:'TND', cpm:{Facebook:0.5,'Google Ads':0.8,Instagram:0.6}},
      'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±': {currency:'DZD', cpm:{Facebook:0.3,'Google Ads':0.5,Instagram:0.4}}
    };

    const ALL_SECTORS = {
      // Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©
      'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«': ['Ù†Ù‚Ù„','ØªØ±Ø­ÙŠÙ„','Ø´Ø­Ù†','ØªØ­Ù…ÙŠÙ„','Ø£Ø«Ø§Ø«','Ø¹ÙØ´','Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§'],
      'Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©': ['ØªÙ†Ø¸ÙŠÙ','Ù†Ø¸Ø§ÙØ©','ØªØ¹Ù‚ÙŠÙ…','ØºØ³ÙŠÙ„','ØªÙ„Ù…ÙŠØ¹','Ù…Ù†Ø§Ø²Ù„','Ø´Ù‚Ù‚'],
      'Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ': ['ØµØ±Ù ØµØ­ÙŠ','Ù…Ø¬Ø§Ø±ÙŠ','ØªØ³Ù„ÙŠÙƒ','Ø´ÙØ·','Ø¨ÙŠØ§Ø±Ø§Øª','ØªØ³Ø±Ø¨Ø§Øª'],
      'Ù…ÙƒØ§ÙØ­Ø© Ø­Ø´Ø±Ø§Øª': ['Ù…ÙƒØ§ÙØ­Ø© Ø­Ø´Ø±Ø§Øª','Ø±Ø´ Ù…Ø¨ÙŠØ¯Ø§Øª','Ù‚Ø¶Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…Ù„','Ù…ÙƒØ§ÙØ­Ø© ØµØ±Ø§ØµÙŠØ±'],
      'ØµÙŠØ§Ù†Ø© Ù…Ù†Ø²Ù„ÙŠØ©': ['ØµÙŠØ§Ù†Ø©','Ø¥ØµÙ„Ø§Ø­','ÙƒÙ‡Ø±Ø¨Ø§Ø¡','Ø³Ø¨Ø§ÙƒØ©','Ø¯Ù‡Ø§Ù†','Ø¯ÙŠÙƒÙˆØ±'],
      
      // Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª
      'Ø¹Ù‚Ø§Ø±Ø§Øª': ['Ø¹Ù‚Ø§Ø±Ø§Øª','Ø´Ù‚Ù‚ Ù„Ù„Ø¨ÙŠØ¹','ÙÙ„Ù„ Ù„Ù„Ø¨ÙŠØ¹','Ø£Ø±Ø§Ø¶ÙŠ','Ø§Ø³ØªØ«Ù…Ø§Ø± Ø¹Ù‚Ø§Ø±ÙŠ'],
      'Ø¥ÙŠØ¬Ø§Ø± Ø¹Ù‚Ø§Ø±Ø§Øª': ['Ø´Ù‚Ù‚ Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±','ÙÙ„Ù„ Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±','Ù…ÙƒØ§ØªØ¨ Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±','Ù…Ø­Ù„Ø§Øª Ù„Ù„Ø¥ÙŠØ¬Ø§Ø±'],
      'ØªØ·ÙˆÙŠØ± Ø¹Ù‚Ø§Ø±ÙŠ': ['Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¹Ù‚Ø§Ø±ÙŠØ©','ÙƒÙ…Ø¨ÙˆÙ†Ø¯Ø§Øª','ØªØ·ÙˆÙŠØ± Ø¹Ù‚Ø§Ø±ÙŠ','ÙˆØ­Ø¯Ø§Øª Ø³ÙƒÙ†ÙŠØ©'],
      
      // Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©
      'Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†': ['Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†','Ø·Ø¨ÙŠØ¨ Ø£Ø³Ù†Ø§Ù†','ØªÙ‚ÙˆÙŠÙ… Ø£Ø³Ù†Ø§Ù†','ØªØ¨ÙŠÙŠØ¶ Ø£Ø³Ù†Ø§Ù†'],
      'Ø¹ÙŠØ§Ø¯Ø© Ø¹Ø§Ù…Ø©': ['Ø¹ÙŠØ§Ø¯Ø©','Ø·Ø¨ÙŠØ¨','ÙƒØ´Ù Ø·Ø¨ÙŠ','ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ©'],
      'ØµÙŠØ¯Ù„ÙŠØ©': ['ØµÙŠØ¯Ù„ÙŠØ©','Ø£Ø¯ÙˆÙŠØ©','Ø¹Ù‚Ø§Ù‚ÙŠØ±','Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø·Ø¨ÙŠØ©'],
      'Ù…Ø®ØªØ¨Ø± Ø·Ø¨ÙŠ': ['Ù…Ø®ØªØ¨Ø±','ØªØ­Ø§Ù„ÙŠÙ„','ÙØ­ÙˆØµØ§Øª','Ø£Ø´Ø¹Ø©','Ø³ÙˆÙ†Ø§Ø±'],
      
      // Ø§Ù„ØªØ¹Ù„ÙŠÙ…
      'Ù…Ø¯Ø±Ø³Ø© Ø®Ø§ØµØ©': ['Ù…Ø¯Ø±Ø³Ø© Ø®Ø§ØµØ©','ØªØ¹Ù„ÙŠÙ… Ø®Ø§Øµ','Ù…Ù†Ø§Ù‡Ø¬','Ø´Ù‡Ø§Ø¯Ø§Øª'],
      'Ø¯ÙˆØ±Ø§Øª ØªØ¯Ø±ÙŠØ¨ÙŠØ©': ['Ø¯ÙˆØ±Ø§Øª','ØªØ¯Ø±ÙŠØ¨','ÙƒÙˆØ±Ø³Ø§Øª','Ø´Ù‡Ø§Ø¯Ø§Øª Ù…Ù‡Ù†ÙŠØ©'],
      'ØªØ¹Ù„ÙŠÙ… Ù„ØºØ§Øª': ['ØªØ¹Ù„ÙŠÙ… Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ','Ø¯ÙˆØ±Ø§Øª Ù„ØºØ©','Ù…Ø¹Ù‡Ø¯ Ù„ØºØ§Øª'],
      'Ø¬Ø§Ù…Ø¹Ø©': ['Ø¬Ø§Ù…Ø¹Ø©','ÙƒÙ„ÙŠØ©','Ø¯Ø±Ø§Ø³Ø§Øª Ø¹Ù„ÙŠØ§','Ù…Ø§Ø¬Ø³ØªÙŠØ±','Ø¯ÙƒØªÙˆØ±Ø§Ù‡'],
      
      // Ø§Ù„Ù…Ø·Ø§Ø¹Ù… ÙˆØ§Ù„Ø£ØºØ°ÙŠØ©
      'Ù…Ø·Ø¹Ù…': ['Ù…Ø·Ø¹Ù…','Ù…Ø£ÙƒÙˆÙ„Ø§Øª','Ø·Ø¹Ø§Ù…','ÙˆØ¬Ø¨Ø§Øª','ØªÙˆØµÙŠÙ„ Ø·Ø¹Ø§Ù…'],
      'ÙƒØ§ÙÙŠÙ‡': ['ÙƒØ§ÙÙŠÙ‡','Ù‚Ù‡ÙˆØ©','Ù…Ø´Ø±ÙˆØ¨Ø§Øª','Ø­Ù„ÙˆÙŠØ§Øª','Ø¢ÙŠØ³ ÙƒØ±ÙŠÙ…'],
      'Ø­Ù„ÙˆØ§Ù†ÙŠ': ['Ø­Ù„ÙˆØ§Ù†ÙŠ','ÙƒÙŠÙƒ','ØªÙˆØ±ØªØ§Øª','Ø­Ù„ÙˆÙŠØ§Øª Ø´Ø±Ù‚ÙŠØ©','Ù…Ø¹Ù…ÙˆÙ„'],
      'ØªÙˆØµÙŠÙ„ Ø·Ø¹Ø§Ù…': ['ØªÙˆØµÙŠÙ„ Ø·Ø¹Ø§Ù…','Ø£ÙˆØ±Ø¯Ø±','Ø·Ù„Ø¨Ø§Øª','Ø¯ÙŠÙ„ÙŠÙØ±ÙŠ'],
      
      // Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
      'Ù…Ø¹Ø±Ø¶ Ø³ÙŠØ§Ø±Ø§Øª': ['Ø³ÙŠØ§Ø±Ø§Øª Ù„Ù„Ø¨ÙŠØ¹','Ù…Ø¹Ø±Ø¶ Ø³ÙŠØ§Ø±Ø§Øª','Ø³ÙŠØ§Ø±Ø§Øª Ù…Ø³ØªØ¹Ù…Ù„Ø©','Ø³ÙŠØ§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©'],
      'ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª': ['ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª','Ø¥ÙŠØ¬Ø§Ø± Ø³ÙŠØ§Ø±Ø©','Ø§Ø³ØªØ¦Ø¬Ø§Ø±','Ø±Ù†Øª ÙƒØ§Ø±'],
      'ØµÙŠØ§Ù†Ø© Ø³ÙŠØ§Ø±Ø§Øª': ['ØµÙŠØ§Ù†Ø© Ø³ÙŠØ§Ø±Ø§Øª','ÙˆØ±Ø´Ø©','Ù‚Ø·Ø¹ ØºÙŠØ§Ø±','Ø²ÙŠÙˆØª','Ø¥Ø·Ø§Ø±Ø§Øª'],
      'ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª': ['ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª','ØªÙ†Ø¸ÙŠÙ Ø³ÙŠØ§Ø±Ø©','Ø¨ÙˆÙ„ÙŠØ´','ØªÙ„Ù…ÙŠØ¹'],
      
      // Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©
      'Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ': ['Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ','ØªØ³ÙˆÙ‚ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†','Ø´Ø±Ø§Ø¡','Ù…Ù†ØªØ¬Ø§Øª'],
      'Ù…Ù„Ø§Ø¨Ø³': ['Ù…Ù„Ø§Ø¨Ø³','Ø£Ø²ÙŠØ§Ø¡','Ù…ÙˆØ¶Ø©','ÙØ³Ø§ØªÙŠÙ†','Ù‚Ù…ØµØ§Ù†'],
      'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª': ['Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª','Ø¬ÙˆØ§Ù„Ø§Øª','Ù„Ø§Ø¨ØªÙˆØ¨','Ø£Ø¬Ù‡Ø²Ø©','ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§'],
      'Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª': ['Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª','Ø°Ù‡Ø¨','ÙØ¶Ø©','Ø®ÙˆØ§ØªÙ…','Ø£Ø³Ø§ÙˆØ±'],
      
      // Ø§Ù„Ø¬Ù…Ø§Ù„ ÙˆØ§Ù„Ø¹Ù†Ø§ÙŠØ©
      'ØµØ§Ù„ÙˆÙ† Ø­Ù„Ø§Ù‚Ø©': ['ØµØ§Ù„ÙˆÙ†','Ø­Ù„Ø§Ù‚Ø©','ØªØ³Ø±ÙŠØ­ Ø´Ø¹Ø±','Ø­Ù„Ø§Ù‚','ÙƒÙˆØ§ÙÙŠØ±'],
      'ØµØ§Ù„ÙˆÙ† Ù†Ø³Ø§Ø¦ÙŠ': ['ØµØ§Ù„ÙˆÙ† Ù†Ø³Ø§Ø¦ÙŠ','ØªØ¬Ù…ÙŠÙ„','Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø´Ø¹Ø±','Ù…ÙƒÙŠØ§Ø¬','Ù…Ø§Ù†ÙŠÙƒÙŠØ±'],
      'Ù…Ø±ÙƒØ² ØªØ¬Ù…ÙŠÙ„': ['Ù…Ø±ÙƒØ² ØªØ¬Ù…ÙŠÙ„','Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¨Ø´Ø±Ø©','Ù„ÙŠØ²Ø±','ØªÙ‚Ø´ÙŠØ±','Ø¨ÙˆØªÙƒØ³'],
      'Ø¹Ø·ÙˆØ±': ['Ø¹Ø·ÙˆØ±','Ø¹ÙˆØ¯','Ø¨Ø®ÙˆØ±','ÙƒÙˆÙ„ÙˆÙ†ÙŠØ§','ÙØ±Ù†Ø³ÙŠ'],
      
      // Ø§Ù„Ø±ÙŠØ§Ø¶Ø© ÙˆØ§Ù„Ù„ÙŠØ§Ù‚Ø©
      'Ù†Ø§Ø¯ÙŠ Ø±ÙŠØ§Ø¶ÙŠ': ['Ù†Ø§Ø¯ÙŠ Ø±ÙŠØ§Ø¶ÙŠ','Ø¬ÙŠÙ…','Ù„ÙŠØ§Ù‚Ø© Ø¨Ø¯Ù†ÙŠØ©','ÙƒÙ…Ø§Ù„ Ø£Ø¬Ø³Ø§Ù…'],
      'Ù…Ø¯Ø±Ø¨ Ø´Ø®ØµÙŠ': ['Ù…Ø¯Ø±Ø¨ Ø´Ø®ØµÙŠ','ØªØ¯Ø±ÙŠØ¨','Ù„ÙŠØ§Ù‚Ø©','ØªØ®Ø³ÙŠØ³','Ø¹Ø¶Ù„Ø§Øª'],
      'Ù…Ø¹Ø¯Ø§Øª Ø±ÙŠØ§Ø¶ÙŠØ©': ['Ù…Ø¹Ø¯Ø§Øª Ø±ÙŠØ§Ø¶ÙŠØ©','Ø£Ø¬Ù‡Ø²Ø© Ø±ÙŠØ§Ø¶Ø©','Ø£ÙˆØ²Ø§Ù†','Ø¬Ø±ÙŠ'],
      
      // Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙˆØ§Ù„Ù…Ø§Ù„ÙŠØ©
      'Ù…Ø­Ø§Ù…ÙŠ': ['Ù…Ø­Ø§Ù…ÙŠ','Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©','Ù‚Ø¶Ø§ÙŠØ§','Ø¹Ù‚ÙˆØ¯','Ù…Ø­ÙƒÙ…Ø©'],
      'Ù…Ø­Ø§Ø³Ø¨': ['Ù…Ø­Ø§Ø³Ø¨','Ù…Ø­Ø§Ø³Ø¨Ø©','Ø¶Ø±Ø§Ø¦Ø¨','Ù…Ø±Ø§Ø¬Ø¹Ø© Ø­Ø³Ø§Ø¨Ø§Øª','Ø²ÙƒØ§Ø©'],
      'Ø®Ø¯Ù…Ø§Øª Ù…ØµØ±ÙÙŠØ©': ['Ø¨Ù†Ùƒ','Ù‚Ø±ÙˆØ¶','ØªÙ…ÙˆÙŠÙ„','Ø§Ø³ØªØ«Ù…Ø§Ø±','Ø­Ø³Ø§Ø¨Ø§Øª'],
      
      // Ø§Ù„Ø³ÙØ± ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø©  
      'ÙˆÙƒØ§Ù„Ø© Ø³ÙØ±': ['Ø³ÙØ±','Ø³ÙŠØ§Ø­Ø©','Ø±Ø­Ù„Ø§Øª','ØªØ°Ø§ÙƒØ± Ø·ÙŠØ±Ø§Ù†','Ø¹Ù…Ø±Ø©','Ø­Ø¬'],
      'ÙÙ†Ø¯Ù‚': ['ÙÙ†Ø¯Ù‚','Ø­Ø¬Ø² ÙÙ†Ø§Ø¯Ù‚','Ø¥Ù‚Ø§Ù…Ø©','ØºØ±Ù','Ù…Ù†ØªØ¬Ø¹'],
      'ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª Ø³ÙŠØ§Ø­ÙŠ': ['ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª Ø³ÙŠØ§Ø­ÙŠ','Ø±Ø­Ù„Ø§Øª','ØªÙ†Ù‚Ù„','Ø³Ø§Ø¦Ù‚'],
      
      // Ø§Ù„Ø£Ù…Ù† ÙˆØ§Ù„Ø­Ø±Ø§Ø³Ø©
      'Ø´Ø±ÙƒØ© Ø£Ù…Ù†': ['Ø´Ø±ÙƒØ© Ø£Ù…Ù†','Ø­Ø±Ø§Ø³Ø©','Ø£Ù…Ù† ÙˆØ­Ø±Ø§Ø³Ø©','Ø­Ø±Ø§Ø³','ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø©'],
      'ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø©': ['ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø©','Ø£Ù†Ø¸Ù…Ø© Ø£Ù…Ù†ÙŠØ©','Ù…Ø±Ø§Ù‚Ø¨Ø©','Ø­Ù…Ø§ÙŠØ©'],
      
      // Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª
      'Ù…Ù‚Ø§ÙˆÙ„Ø§Øª': ['Ù…Ù‚Ø§ÙˆÙ„Ø§Øª','Ø¥Ù†Ø´Ø§Ø¡Ø§Øª','Ø¨Ù†Ø§Ø¡','ØªØ´ÙŠÙŠØ¯','Ù…Ù‚Ø§ÙˆÙ„'],
      'Ù…Ø¹Ù…Ø§Ø±': ['Ù…Ø¹Ù…Ø§Ø±','ØªØµÙ…ÙŠÙ… Ù…Ø¹Ù…Ø§Ø±ÙŠ','Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¹Ù…Ø§Ø±ÙŠ','Ù…Ø®Ø·Ø·Ø§Øª'],
      'Ø¯Ù‡Ø§Ù†': ['Ø¯Ù‡Ø§Ù†','Ø¯Ù‡Ø§Ù†Ø§Øª','Ø¨ÙˆÙŠØ©','Ø¯ÙŠÙƒÙˆØ±','ØªØ´Ø·ÙŠØ¨Ø§Øª'],
      
      // Ø§Ù„Ø²Ø±Ø§Ø¹Ø© ÙˆØ§Ù„Ø­Ø¯Ø§Ø¦Ù‚
      'ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¯Ø§Ø¦Ù‚': ['ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¯Ø§Ø¦Ù‚','Ø²Ø±Ø§Ø¹Ø©','Ù†Ø¨Ø§ØªØ§Øª','Ø£Ø´Ø¬Ø§Ø±','Ø¹Ø´Ø¨ ØµÙ†Ø§Ø¹ÙŠ'],
      'Ù…Ø´Ø§ØªÙ„': ['Ù…Ø´Ø§ØªÙ„','Ù†Ø¨Ø§ØªØ§Øª','Ø¨Ø°ÙˆØ±','Ø£Ø³Ù…Ø¯Ø©','Ø£Ø¯ÙˆØ§Øª Ø²Ø±Ø§Ø¹Ø©']
    };

    const SECTOR_KEYWORDS = {
      'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«': {
        keywords: {
          'Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„ØªÙƒÙ„ÙØ©': ['Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø³Ø¹Ø±','Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø§Ø³Ø¹Ø§Ø±','Ù†Ù‚Ù„ Ø¹ÙØ´ ØªÙƒÙ„ÙØ©','Ø´Ø­Ù† Ø£Ø«Ø§Ø« Ø§Ø±Ø®Øµ','ØªØ±Ø­ÙŠÙ„ Ø£Ø«Ø§Ø« Ø§Ø³Ø¹Ø§Ø±','Ù†Ù‚Ù„ Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§ Ø³Ø¹Ø±'],
          'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ù‚Ø±ÙŠØ¨','Ù†Ù‚Ù„ Ø¹ÙØ´ Ø¨Ø§Ù„Ù‚Ø±Ø¨','Ø´Ø­Ù† Ø£Ø«Ø§Ø« Ù…Ø­Ù„ÙŠ','ØªØ±Ø­ÙŠÙ„ Ø£Ø«Ø§Ø« Ù‚Ø±ÙŠØ¨'],
          'Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø·Ù„Ø¨': ['Ø­Ø¬Ø² Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«','Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø¹ÙØ´','Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø±Ù‚Ù…','Ø´Ø­Ù† Ø£Ø«Ø§Ø« Ù‡Ø§ØªÙ','ØªØ±Ø­ÙŠÙ„ Ø£Ø«Ø§Ø« Ø­Ø¬Ø²'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©': ['ÙÙƒ ÙˆØªØ±ÙƒÙŠØ¨ Ø£Ø«Ø§Ø«','ØªØºÙ„ÙŠÙ Ø£Ø«Ø§Ø«','Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ù…Ù†Ø²Ù„ÙŠ','Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ù…ÙƒØªØ¨ÙŠ','Ø±Ø§ÙØ¹Ø© Ø£Ø«Ø§Ø«','ØªØ®Ø²ÙŠÙ† Ø£Ø«Ø§Ø«'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©': ['Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø§ÙØ¶Ù„','Ù†Ù‚Ù„ Ø¹ÙØ´ Ø¹Ø±ÙˆØ¶','Ø´Ø­Ù† Ø£Ø«Ø§Ø« Ø®ØµÙ…','Ù†Ù‚Ù„ Ø£Ø«Ø§Ø« Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†','ØªØ±Ø­ÙŠÙ„ Ø£Ø«Ø§Ø« Ø¬Ø¯ÙŠØ¯']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ±','ØªØ¹Ù„ÙŠÙ…','Ø¯ÙˆØ±Ø§Øª','Ø§ÙŠÙƒÙŠØ§','Ù…Ø­Ù„Ø§Øª','Ø´Ø±Ø§Ø¡','Ø¨ÙŠØ¹ Ø£Ø«Ø§Ø«','Ø£Ø«Ø§Ø« Ù…Ø³ØªØ¹Ù…Ù„']
      },
      'Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©': {
        keywords: {
          'Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„ØªÙƒÙ„ÙØ©': ['Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø³Ø¹Ø±','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ø§Ø³Ø¹Ø§Ø±','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© ØªÙƒÙ„ÙØ©','ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ù‚ Ø§Ø±Ø®Øµ'],
          'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ù‚Ø±ÙŠØ¨Ø©','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ù‚Ø±ÙŠØ¨','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø¨Ø§Ù„Ù‚Ø±Ø¨'],
          'Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø·Ù„Ø¨': ['Ø­Ø¬Ø² Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','Ø·Ù„Ø¨ ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø±Ù‚Ù…','ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ù‚ Ù‡Ø§ØªÙ'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©': ['ØªÙ†Ø¸ÙŠÙ Ø³Ø¬Ø§Ø¯','ØªÙ†Ø¸ÙŠÙ ÙƒÙ†Ø¨','ØªØ¹Ù‚ÙŠÙ… Ù…Ù†Ø§Ø²Ù„','ØºØ³ÙŠÙ„ Ù…ÙˆÙƒÙŠØª','ØªÙ†Ø¸ÙŠÙ ÙˆØ§Ø¬Ù‡Ø§Øª','ØªÙ†Ø¸ÙŠÙ Ø®Ø²Ø§Ù†Ø§Øª'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©': ['Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø§ÙØ¶Ù„','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ø¹Ø±ÙˆØ¶','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø®ØµÙ…','ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ù‚ Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ±','ØªØ¹Ù„ÙŠÙ…','Ø¯ÙˆØ±Ø§Øª','Ø¹Ø§Ù…Ù„Ø§Øª','Ø®Ø§Ø¯Ù…Ø§Øª','Ù…Ù†Ø¸ÙØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©']
      },
      'Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ': {
        keywords: {
          'Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„ØªÙƒÙ„ÙØ©': ['Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ Ø³Ø¹Ø±','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø§Ø³Ø¹Ø§Ø±','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª ØªÙƒÙ„ÙØ©','ØµØ±Ù ØµØ­ÙŠ Ø§Ø±Ø®Øµ'],
          'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ Ù‚Ø±ÙŠØ¨Ø©','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ù‚Ø±ÙŠØ¨','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª Ø¨Ø§Ù„Ù‚Ø±Ø¨'],
          'Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø·ÙˆØ§Ø±Ø¦': ['Ø­Ø¬Ø² Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ','Ø·ÙˆØ§Ø±Ø¦ ØµØ±Ù ØµØ­ÙŠ','ØµØ±Ù ØµØ­ÙŠ 24 Ø³Ø§Ø¹Ø©','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø·ÙˆØ§Ø±Ø¦'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©': ['ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª','ÙƒØ´Ù ØªØ³Ø±Ø¨Ø§Øª','ØªÙ†Ø¸ÙŠÙ Ø¨ÙŠØ§Ø±Ø§Øª','ØµÙŠØ§Ù†Ø© ØµØ±Ù ØµØ­ÙŠ'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©': ['Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ Ø§ÙØ¶Ù„','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø¹Ø±ÙˆØ¶','ØµØ±Ù ØµØ­ÙŠ Ø®ØµÙ…']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ±','ØªØ¹Ù„ÙŠÙ…','Ø¯ÙˆØ±Ø§Øª','Ø£Ø¯ÙˆØ§Øª','Ù…Ø¹Ø¯Ø§Øª Ù„Ù„Ø¨ÙŠØ¹','Ù…Ù‚Ø§ÙˆÙ„ÙŠÙ†']
      },
      
      // Ø¥Ø¶Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰...
      'Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†': {
        keywords: {
          'Ø§Ù„Ø¹Ù„Ø§Ø¬ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª': ['Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†','Ø·Ø¨ÙŠØ¨ Ø£Ø³Ù†Ø§Ù†','Ø¹Ù„Ø§Ø¬ Ø£Ø³Ù†Ø§Ù†','Ø­Ø´Ùˆ Ø£Ø³Ù†Ø§Ù†','ØªÙ†Ø¸ÙŠÙ Ø£Ø³Ù†Ø§Ù†'],
          'Ø§Ù„ØªØ¬Ù…ÙŠÙ„': ['ØªÙ‚ÙˆÙŠÙ… Ø£Ø³Ù†Ø§Ù†','ØªØ¨ÙŠÙŠØ¶ Ø£Ø³Ù†Ø§Ù†','Ø²Ø±Ø§Ø¹Ø© Ø£Ø³Ù†Ø§Ù†','ØªØ¬Ù…ÙŠÙ„ Ø£Ø³Ù†Ø§Ù†','Ù‚Ø´ÙˆØ± Ø£Ø³Ù†Ø§Ù†'],
          'Ø§Ù„Ø·ÙˆØ§Ø±Ø¦': ['Ø·ÙˆØ§Ø±Ø¦ Ø£Ø³Ù†Ø§Ù†','Ø£Ù„Ù… Ø£Ø³Ù†Ø§Ù†','Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù† Ø·ÙˆØ§Ø±Ø¦'],
          'Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ø­Ø¬Ø²': ['Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù† Ø³Ø¹Ø±','Ø·Ø¨ÙŠØ¨ Ø£Ø³Ù†Ø§Ù† Ø§Ø³Ø¹Ø§Ø±','Ø­Ø¬Ø² Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù','Ù…Ø¬Ø§Ù†ÙŠ','Ù…Ø¹Ù„ÙˆÙ…Ø§Øª','ØµÙˆØ±','ÙØ±Ø´Ø§Ø© Ø£Ø³Ù†Ø§Ù†','Ù…Ù†ØªØ¬Ø§Øª']
      },
      
      'Ù…Ø·Ø¹Ù…': {
        keywords: {
          'Ø§Ù„Ø£ÙƒÙ„ ÙˆØ§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª': ['Ù…Ø·Ø¹Ù…','Ø·Ø¹Ø§Ù…','ÙˆØ¬Ø¨Ø§Øª','Ø£ÙƒÙ„','Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø´Ø¹Ø¨ÙŠØ©'],
          'Ø§Ù„ØªÙˆØµÙŠÙ„': ['ØªÙˆØµÙŠÙ„ Ø·Ø¹Ø§Ù…','Ø¯ÙŠÙ„ÙŠÙØ±ÙŠ','Ø£ÙˆØ±Ø¯Ø±','Ø·Ù„Ø¨ Ø·Ø¹Ø§Ù…','ØªÙˆØµÙŠÙ„ Ù…Ø·Ø§Ø¹Ù…'],
          'Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª': ['Ù…Ø·Ø¹Ù… Ø¹Ø§Ø¦Ù„ÙŠ','Ù‚Ø¹Ø¯Ø§Øª','Ù…Ù†Ø§Ø³Ø¨Ø§Øª','Ø­ÙÙ„Ø§Øª','Ø¨ÙˆÙÙŠÙ‡'],
          'Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹': ['Ù…Ø·Ø¹Ù… Ø±Ø®ÙŠØµ','Ù…Ø·Ø¹Ù… Ù‚Ø±ÙŠØ¨','Ù…Ø·Ø¹Ù… Ø§Ø³Ø¹Ø§Ø±','Ø§Ø­Ø³Ù† Ù…Ø·Ø¹Ù…']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¹Ø¯Ø§Øª','Ø£Ø¯ÙˆØ§Øª Ù…Ø·Ø¨Ø®','ÙˆØµÙØ§Øª','Ø·Ø¨Ø® Ù…Ù†Ø²Ù„ÙŠ']
      },

      'ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª': {
        keywords: {
          'Ø§Ù„ØªØ£Ø¬ÙŠØ± ÙˆØ§Ù„Ø¥ÙŠØ¬Ø§Ø±': ['ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª','Ø¥ÙŠØ¬Ø§Ø± Ø³ÙŠØ§Ø±Ø©','Ø§Ø³ØªØ¦Ø¬Ø§Ø± Ø³ÙŠØ§Ø±Ø©','Ø±Ù†Øª ÙƒØ§Ø±'],
          'Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª': ['ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø¹Ø§Ø¦Ù„ÙŠØ©','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© ÙØ®Ù…Ø©','ØªØ£Ø¬ÙŠØ± Ø¨Ø§ØµØ§Øª','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©'],
          'Ø§Ù„Ù…Ø¯Ø© ÙˆØ§Ù„Ø³Ø¹Ø±': ['ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© ÙŠÙˆÙ…ÙŠ','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø´Ù‡Ø±ÙŠ','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø³Ø¹Ø±','Ø¥ÙŠØ¬Ø§Ø± Ø³ÙŠØ§Ø±Ø© Ø±Ø®ÙŠØµ'],
          'Ø§Ù„Ø­Ø¬Ø²': ['Ø­Ø¬Ø² ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø©','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†','Ø­Ø¬Ø² Ø³ÙŠØ§Ø±Ø©','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø© Ø±Ù‚Ù…']
        },
        negatives: ['Ø¨ÙŠØ¹ Ø³ÙŠØ§Ø±Ø§Øª','Ø´Ø±Ø§Ø¡ Ø³ÙŠØ§Ø±Ø©','Ø³ÙŠØ§Ø±Ø§Øª Ù…Ø³ØªØ¹Ù…Ù„Ø©','Ù‚Ø·Ø¹ ØºÙŠØ§Ø±','ØªØ£Ù…ÙŠÙ†']
      }
    };

    const COMMON_NEGATIVES = ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¬Ø§Ù†ÙŠ','ØªØ¹Ù„ÙŠÙ…','Ø¯ÙˆØ±Ø§Øª','ØµÙˆØ±','ÙÙŠØ¯ÙŠÙˆ','Ù…Ø¹Ù„ÙˆÙ…Ø§Øª','ÙƒÙŠÙÙŠØ©'];
    const PLATFORMS = ['Google Ads','Facebook','Instagram','TikTok','Snapchat','YouTube','LinkedIn'];
    
    function detectSector(text){
      const n = text.toLowerCase();
      for(const [sector, keywords] of Object.entries(ALL_SECTORS)){
        if(keywords.some(k => n.includes(k))) return sector;
      }
      return null;
    }

    function generateSmartKeywords(text, expansionLevel){
      let knownSector = detectSector(text);
      
      if(knownSector && SECTOR_KEYWORDS[knownSector]){
        let groups = {...SECTOR_KEYWORDS[knownSector].keywords};
        
        // ØªÙˆØ³Ø¹ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…Ø¯Ù†
        if(expansionLevel === 'aggressive'){
          const cities = ['Ø§Ù„Ø±ÙŠØ§Ø¶','Ø¬Ø¯Ø©','Ø§Ù„Ø¯Ù…Ø§Ù…','Ø§Ù„Ø®Ø¨Ø±','Ù…ÙƒØ©','Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©','ØªØ¨ÙˆÙƒ','Ø§Ù„Ø·Ø§Ø¦Ù'];
          Object.keys(groups).forEach(groupName => {
            const cityVariants = [];
            groups[groupName].slice(0,3).forEach(kw => {
              cities.slice(0,4).forEach(city => cityVariants.push(`${kw} ${city}`));
            });
            groups[`${groupName} + Ù…Ø¯Ù†`] = cityVariants;
          });
        }
        
        return groups;
      }
      
      // Ù„Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© - ØªÙˆÙ„ÙŠØ¯ Ø°ÙƒÙŠ
      const words = text.trim().split(' ').filter(w => w.length > 2);
      const mainWord = words[words.length-1] || text; // Ø¢Ø®Ø± ÙƒÙ„Ù…Ø© Ø¹Ø§Ø¯Ø© Ø§Ù„Ø£Ù‡Ù…
      
      return {
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø³Ø¹Ø±`]: [`${mainWord} Ø³Ø¹Ø±`,`${mainWord} Ø§Ø³Ø¹Ø§Ø±`,`${mainWord} ØªÙƒÙ„ÙØ©`,`${mainWord} Ø§Ø±Ø®Øµ`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ù…ÙˆÙ‚Ø¹`]: [`${mainWord} Ù‚Ø±ÙŠØ¨`,`${mainWord} Ø¨Ø§Ù„Ù‚Ø±Ø¨`,`Ø§Ø­Ø³Ù† ${mainWord}`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø·Ù„Ø¨`]: [`${mainWord} Ø­Ø¬Ø²`,`${mainWord} Ø·Ù„Ø¨`,`${mainWord} Ø±Ù‚Ù…`,`${mainWord} Ù‡Ø§ØªÙ`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø®Ø¯Ù…Ø©`]: [`Ø®Ø¯Ù…Ø§Øª ${mainWord}`,`${mainWord} Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†`,`${mainWord} Ø¹Ø±ÙˆØ¶`,`${mainWord} Ø¬Ø¯ÙŠØ¯`]
      };
    }

    function getSectorNegatives(sectorText){
      const knownSector = detectSector(sectorText);
      if(knownSector && SECTOR_KEYWORDS[knownSector] && SECTOR_KEYWORDS[knownSector].negatives){
        return [...SECTOR_KEYWORDS[knownSector].negatives, ...COMMON_NEGATIVES];
      }
      return COMMON_NEGATIVES;
    }

    function fmt(n){ return new Intl.NumberFormat('ar-EG').format(Math.round(n||0)); }

    function setupSectorSearch(){
      const input = document.getElementById('sectorFree');
      const suggestions = document.getElementById('sectorSuggestions');
      const allSectorNames = Object.keys(ALL_SECTORS);
      
      input.addEventListener('input', (e) => {
        const value = e.target.value.toLowerCase();
        if(value.length < 2){
          suggestions.style.display = 'none';
          return;
        }
        
        const matches = allSectorNames.filter(sector => 
          sector.toLowerCase().includes(value) ||
          ALL_SECTORS[sector].some(keyword => keyword.includes(value))
        );
        
        if(matches.length > 0){
          suggestions.innerHTML = '';
          matches.slice(0,8).forEach(sector => {
            const item = document.createElement('div');
            item.className = 'sector-item';
            item.textContent = sector;
            item.addEventListener('click', () => {
              input.value = sector;
              suggestions.style.display = 'none';
            });
            suggestions.appendChild(item);
          });
          suggestions.style.display = 'block';
        } else {
          suggestions.style.display = 'none';
        }
      });
      
      document.addEventListener('click', (e) => {
        if(!input.contains(e.target) && !suggestions.contains(e.target)){
          suggestions.style.display = 'none';
        }
      });
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      setupSectorSearch();
      
      const toggles = document.getElementById('platformToggles');
      PLATFORMS.forEach(p=>{
        const id = 'pl_' + p.replace(/\s+/g,'_');
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" id="${id}" checked> ${p}`;
        toggles.appendChild(label);
      });

      document.getElementById('demo').addEventListener('click', ()=>{
        document.getElementById('country').value = 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©';
        document.getElementById('sectorFree').value = 'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«';
        document.getElementById('budget').value = '5000';
        document.getElementById('matchType').value = 'mixed';
        document.getElementById('expansionLevel').value = 'moderate';
        document.getElementById('successMsg').style.display = 'block';
        setTimeout(()=> document.getElementById('successMsg').style.display = 'none', 3000);
      });

      document.getElementById('run').addEventListener('click', ()=>{
        const country = document.getElementById('country').value;
        const sector = document.getElementById('sectorFree').value.trim();
        const budget = parseFloat(document.getElementById('budget').value || '5000');
        const matchType = document.getElementById('matchType').value;
        const includeNegatives = document.getElementById('includeNegatives').checked;
        const expansionLevel = document.getElementById('expansionLevel').value;
        
        if(!country || !sector){
          alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø© ÙˆØ§ÙƒØªØ¨ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„');
          return;
        }
        
        const countryData = COUNTRY_DATA[country] || {currency:'SAR', cpm:{}};
        const keywordGroups = generateSmartKeywords(sector, expansionLevel);
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
        const kwEl = document.getElementById('keywords');
        kwEl.innerHTML = '';
        let allKeywords = [];
        
        Object.entries(keywordGroups).forEach(([groupName, keywords]) => {
          const groupDiv = document.createElement('div');
          groupDiv.className = 'intent-group';
          groupDiv.innerHTML = `<div class="intent-title">${groupName} (${keywords.length} ÙƒÙ„Ù…Ø©)</div>`;
          
          const chipsDiv = document.createElement('div');
          chipsDiv.className = 'chips';
          
          keywords.forEach((k, i) => {
            const span = document.createElement('span');
            
            let displayKeyword, actualKeyword, className;
            if(matchType === 'mixed'){
              if(i % 5 < 3){ displayKeyword = `"${k}"`; actualKeyword = `"${k}"`; className = 'pill pill-phrase'; }
              else if(i % 5 === 3){ displayKeyword = k; actualKeyword = k; className = 'pill pill-broad'; }
              else { displayKeyword = `[${k}]`; actualKeyword = `[${k}]`; className = 'pill pill-exact'; }
            } else {
              actualKeyword = matchType === 'broad' ? k : matchType === 'phrase' ? `"${k}"` : `[${k}]`;
              displayKeyword = actualKeyword;
              className = matchType === 'broad' ? 'pill pill-broad' : 
                         matchType === 'phrase' ? 'pill pill-phrase' : 'pill pill-exact';
            }
            
            span.className = className;
            span.textContent = displayKeyword;
            chipsDiv.appendChild(span);
            allKeywords.push(actualKeyword);
          });
          
          groupDiv.appendChild(chipsDiv);
          kwEl.appendChild(groupDiv);
        });

        // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©
        let negativeKeywords = [];
        if(includeNegatives){
          negativeKeywords = getSectorNegatives(sector);
          const negCard = document.getElementById('negativesCard');
          const negEl = document.getElementById('negativeKeywords');
          negCard.style.display = 'block';
          negEl.innerHTML = '';
          negativeKeywords.forEach(k => {
            const span = document.createElement('span');
            span.className = 'pill';
            span.style.background = '#f8d7da';
            span.style.color = '#721c24';
            span.textContent = `-${k}`;
            negEl.appendChild(span);
          });
        }

        document.getElementById('keywordStats').textContent = 
          `ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${allKeywords.length} ÙƒÙ„Ù…Ø© ÙÙŠ ${Object.keys(keywordGroups).length} Ù…Ø¬Ù…ÙˆØ¹Ø§Øª${includeNegatives ? ` + ${negativeKeywords.length} ÙƒÙ„Ù…Ø© Ø³Ù„Ø¨ÙŠØ©` : ''}`;

        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµØ¯ÙŠØ±
        document.getElementById('copyAll').onclick = ()=>{
          navigator.clipboard.writeText(allKeywords.join('\n')).then(()=> 
            alert(`ØªÙ… Ù†Ø³Ø® ${allKeywords.length} ÙƒÙ„Ù…Ø©`));
        };
        
        document.getElementById('copyNegatives').onclick = ()=>{
          if(negativeKeywords.length){
            navigator.clipboard.writeText(negativeKeywords.map(k => `-${k}`).join('\n')).then(()=> 
              alert(`ØªÙ… Ù†Ø³Ø® ${negativeKeywords.length} ÙƒÙ„Ù…Ø© Ø³Ù„Ø¨ÙŠØ©`));
          }
        };
        
        document.getElementById('exportXlsx').onclick = ()=>{
          if(!window.XLSX) return;
          
          const wb = XLSX.utils.book_new();
          
          // ÙˆØ±Ù‚Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª
          const keywordRows = [['Ø§Ù„ÙƒÙ„Ù…Ø©','Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©','Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù†ÙŠØ©','Ù…Ù„Ø§Ø­Ø¸Ø©']];
          Object.entries(keywordGroups).forEach(([group, keywords]) => {
            keywords.forEach(k => {
              const actualK = matchType === 'broad' ? k : matchType === 'phrase' ? `"${k}"` : `[${k}]`;
              const matchText = actualK.startsWith('[') ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©' :
                               actualK.startsWith('"') ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© Ø¹Ø¨Ø§Ø±Ø©' : 'Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø©';
              keywordRows.push([actualK, matchText, group, '']);
            });
          });
          XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(keywordRows), 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
          
          // ÙˆØ±Ù‚Ø© Ø§Ù„Ø³Ù„Ø¨ÙŠØ§Øª
          if(negativeKeywords.length){
            const negRows = [['Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ù„Ø¨ÙŠØ©','Ø§Ù„Ø³Ø¨Ø¨']];
            negativeKeywords.forEach(k => negRows.push([`-${k}`, 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±']));
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(negRows), 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©');
          }
          
          // ÙˆØ±Ù‚Ø© Ø§Ù„Ø®Ø·Ø©
          const activePlatforms = PLATFORMS.filter(p=> document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked);
          const planRows = [['Ø§Ù„Ù…Ù†ØµØ©','Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©','CPM Ø§Ù„Ù…ØªÙˆÙ‚Ø¹','Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹','Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©']];
          const budgetPerPlatform = activePlatforms.length ? budget / activePlatforms.length : budget;
          
          activePlatforms.forEach(p => {
            const cpm = countryData.cpm[p] || 2;
            const impressions = (budgetPerPlatform/cpm)*1000;
            const clicks = impressions*0.015;
            planRows.push([p, budgetPerPlatform, `$${cmp}`, Math.round(impressions), Math.round(clicks)]);
          });
          XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(planRows), 'Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©');
          
          XLSX.writeFile(wb, `${sector.replace(/\s+/g,'-')}-ads-plan.xlsx`);
        };

        // Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ø¹Ø±Ø¶
        const activePlatforms = PLATFORMS.filter(p=> 
          document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked);
        
        const mixEl = document.getElementById('mix');
        mixEl.innerHTML = '';
        activePlatforms.forEach((p,i)=>{
          const s = document.createElement('span');
          s.className = 'pill';
          s.textContent = `${i+1} - ${p}`;
          mixEl.appendChild(s);
        });
        
        document.getElementById('mixNote').textContent = `ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${activePlatforms.length} Ù…Ù†ØµØ© Ù„Ù„Ø­Ù…Ù„Ø©`;

        const allocEl = document.getElementById('allocation');
        allocEl.innerHTML = '';
        const budgetPerPlatform = activePlatforms.length ? budget / activePlatforms.length : budget;
        
        activePlatforms.forEach(p=>{
          const d = document.createElement('div');
          d.innerHTML = `<b>${p}</b><br>${fmt(budgetPerPlatform)} ${countryData.currency}`;
          allocEl.appendChild(d);
        });

        const fEl = document.getElementById('forecasts');
        fEl.innerHTML = '';
        let totals = {impressions:0,clicks:0,conversions:0,sales:0};
        
        activePlatforms.forEach(p=>{
          const cpm = countryData.cpm[p] || 2;
          const impressions = (budgetPerPlatform/cpm)*1000;
          const clicks = impressions*0.015;
          const conversions = clicks*0.025;
          const sales = conversions*0.75;
          
          totals.impressions += impressions;
          totals.clicks += clicks;
          totals.conversions += conversions;
          totals.sales += sales;
          
          const div = document.createElement('div');
          div.innerHTML = `<b>${p}</b><br>CPM $${cpm.toFixed(2)}<br>Ø¸Ù‡ÙˆØ± ${fmt(impressions)} | Ù†Ù‚Ø±Ø§Øª ${fmt(clicks)} | ØªØ­ÙˆÙŠÙ„Ø§Øª ${fmt(conversions)} | Ù…Ø¨ÙŠØ¹Ø§Øª ${fmt(sales)}`;
          fEl.appendChild(div);
        });
        
        const totalDiv = document.createElement('div');
        totalDiv.innerHTML = `<b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (${fmt(budget)} ${countryData.currency})</b><br>Ø¸Ù‡ÙˆØ± ${fmt(totals.impressions)} | Ù†Ù‚Ø±Ø§Øª ${fmt(totals.clicks)} | ØªØ­ÙˆÙŠÙ„Ø§Øª ${fmt(totals.conversions)} | Ù…Ø¨ÙŠØ¹Ø§Øª ${fmt(totals.sales)}`;
        fEl.appendChild(totalDiv);

        // Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ°
        const playbook = document.getElementById('playbook');
        playbook.innerHTML = '';
        [
          `Ø¥Ù†Ø´Ø§Ø¡ ${Object.keys(keywordGroups).length} Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙŠØ©`,
          `Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©: ${matchType === 'mixed' ? '60% Ø¹Ø¨Ø§Ø±Ø© + 25% ÙˆØ§Ø³Ø¹Ø© + 15% ØªØ§Ù…Ø©' : matchType}`,
          `Ø¥Ø¶Ø§ÙØ© ${negativeKeywords.length} ÙƒÙ„Ù…Ø© Ø³Ù„Ø¨ÙŠØ© Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±`,
          `Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ù€${activePlatforms.length} Ù…Ù†ØµØ§Øª Ù…Ø¹ ØªØ±ÙƒÙŠØ² 70% Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø£ÙØ¶Ù„`,
          `Ù…Ø±Ø§Ù‚Ø¨Ø© CTR ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙˆØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù„Ù„Ù…Ù†ØµØ© Ø§Ù„Ø£Ø¹Ù„Ù‰ ROAS`,
          `Ø§Ø®ØªØ¨Ø§Ø± A/B Ù„Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© ÙƒÙ„ 3-5 Ø£ÙŠØ§Ù…`,
          `Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ ÙˆØ¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ø­Ø³Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`
        ].forEach(s=>{
          const li = document.createElement('li');
          li.textContent = s;
          playbook.appendChild(li);
        });

        document.getElementById('out').style.display = 'block';
        document.getElementById('successMsg').style.display = 'block';
        setTimeout(()=> document.getElementById('successMsg').style.display = 'none', 5000);
      });
    });
  </script>
</body>
</html>