<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ¯ÙˆÙŠ</title>
  <link rel="icon" href="../favicon.svg">
  <link rel="stylesheet" href="../global-styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .container{max-width:1200px;margin:0 auto;padding:20px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:25px;margin:20px 0;box-shadow:0 4px 16px rgba(0,0,0,.08)}
    .ai-card{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;text-align:center;border:none}
    .manual-input{width:100%;padding:13px;border:2px solid #e5e7eb;border-radius:10px;font-family:inherit;font-size:1rem;transition:border 0.2s}
    .manual-input:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,0.1)}
    .manual-select{width:100%;padding:13px;border:2px solid #e5e7eb;border-radius:10px;font-family:inherit;font-size:1rem}
    .manual-label{font-weight:700;margin-bottom:7px;display:block;color:#374151}
    .manual-form{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin:25px 0}
    .platform-buttons{display:flex;flex-wrap:wrap;gap:12px;justify-content:center;margin:15px 0}
    .platform-btn{padding:12px 18px;border:2px solid #e5e7eb;background:#f9fafb;color:#374151;border-radius:25px;cursor:pointer;font-weight:600;font-size:0.9rem;transition:all 0.3s}
    .platform-btn.active{background:#3b82f6;color:white;border-color:#3b82f6;transform:translateY(-2px);box-shadow:0 4px 12px rgba(59,130,246,0.3)}
    .platform-btn:hover{background:#f3f4f6;border-color:#d1d5db;transform:translateY(-1px)}
    .btn-ai{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:30px;padding:16px 32px;cursor:pointer;font-weight:800;font-size:1.3rem;transition:all 0.4s;box-shadow:0 8px 25px rgba(102,126,234,0.3)}
    .btn-ai:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 12px 35px rgba(102,126,234,0.5)}
    .pill{display:inline-block;padding:8px 14px;border-radius:20px;margin:4px;font-size:0.9rem;font-weight:600;border:2px solid;transition:all 0.2s}
    .pill-ai{background:#dbeafe;color:#1e40af;border-color:#93c5fd}
    .pill-expert{background:#dcfce7;color:#166534;border-color:#86efac}
    .pill-premium{background:#fef3c7;color:#92400e;border-color:#fcd34d}
    .pill-negative{background:#fee2e2;color:#991b1b;border-color:#fca5a5}
    .auto-stats{background:#f8fafc;border:1px solid #cbd5e1;border-radius:10px;padding:15px;margin:15px 0;text-align:center;color:#475569;font-weight:600}
    .download-zone{display:flex;gap:15px;flex-wrap:wrap;justify-content:center;margin:20px 0}
    .btn-download{background:#059669;color:white;border:none;border-radius:25px;padding:12px 24px;font-weight:700;cursor:pointer;transition:all 0.3s}
    .btn-download:hover{background:#047857;transform:translateY(-2px)}
    .btn-copy{background:#64748b;color:white;border:none;border-radius:25px;padding:12px 24px;font-weight:700;cursor:pointer;transition:all 0.3s}
    .btn-copy:hover{background:#475569;transform:translateY(-2px)}
    @media(max-width:768px){.container{padding:15px}.card{padding:18px;margin:15px 0}.manual-form{grid-template-columns:1fr}.platform-buttons{justify-content:center}}
  </style>
</head>
<body>
  <nav class="unified-nav" style="display:flex;gap:15px;flex-wrap:wrap;align-items:center;justify-content:center;padding:15px 10px;background:var(--gradient);border-radius:0 0 20px 20px;margin-bottom:20px">
    <a href="../" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="../tools-directory.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-list"></i> Ø§Ù„Ø¯Ù„ÙŠÙ„</a>
  </nav>

  <div class="container">
    <div class="card ai-card">
      <h1>ğŸ¤– Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ¯ÙˆÙŠ</h1>
      <p style="font-size:1.1rem;opacity:0.95;margin:15px 0">Ø­Ø¯Ø¯ Ø§Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ Ø¨Ù†ÙØ³ÙƒØŒ ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠÙˆÙ„Ø¯ Ù„Ùƒ ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©</p>
    </div>

    <div class="card">
      <h2>ğŸ› ï¸ Ø§Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ (ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„)</h2>
      <form id="manualForm">
        <div class="manual-form">
          <div>
            <label class="manual-label">Ø§Ù„Ù…Ø¬Ø§Ù„ / Ø§Ù„Ø®Ø¯Ù…Ø©</label>
            <input id="field" class="manual-input" placeholder="Ù…Ø«Ø§Ù„: Ù…ÙŠØ¯ÙŠØ§ Ø¨Ø§ÙŠØ±ØŒ Ø¯ÙƒØªÙˆØ± Ù†Ø³Ø§ØŒ Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«..." required>
          </div>
          <div>
            <label class="manual-label">Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
            <select id="country" class="manual-select">
              <option>Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option><option>Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option><option>Ù…ØµØ±</option><option>Ø§Ù„ÙƒÙˆÙŠØª</option><option>Ù‚Ø·Ø±</option><option>Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option><option>Ø¹ÙÙ…Ø§Ù†</option><option>Ø§Ù„Ø£Ø±Ø¯Ù†</option><option>Ù„Ø¨Ù†Ø§Ù†</option><option>Ø§Ù„Ù…ØºØ±Ø¨</option><option>ØªÙˆÙ†Ø³</option><option>Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
            </select>
          </div>
          <div>
            <label class="manual-label">Ø§Ù„Ù„Ù‡Ø¬Ø©</label>
            <select id="dialect" class="manual-select">
              <option value="classical">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰</option>
              <option value="local">Ù„Ù‡Ø¬Ø© Ø§Ù„Ø¯ÙˆÙ„Ø©</option>
            </select>
          </div>
          <div>
            <label class="manual-label">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</label>
            <input type="number" id="budget" class="manual-input" min="1" max="10000000" placeholder="Ø§ÙƒØªØ¨ Ø£ÙŠ Ø±Ù‚Ù… (1 Ø¥Ù„Ù‰ 10 Ù…Ù„ÙŠÙˆÙ†)" required>
          </div>
          <div>
            <label class="manual-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</label>
            <select id="matchType" class="manual-select">
              <option value="mixed">Ù…Ø²ÙŠØ¬ (Ù…ÙˆØµÙ‰)</option>
              <option value="phrase">Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø¨Ø§Ø±Ø©</option>
              <option value="broad">Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø©</option>
              <option value="exact">Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©</option>
            </select>
          </div>
          <div>
            <label class="manual-label">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹</label>
            <select id="expansion" class="manual-select">
              <option value="moderate">Ù…ØªÙˆØ³Ø· (50-80 ÙƒÙ„Ù…Ø©)</option>
              <option value="conservative">Ù…Ø­Ø§ÙØ¸ (30-40 ÙƒÙ„Ù…Ø©)</option>
              <option value="aggressive">ØªÙˆØ³Ø¹ÙŠ (100+ ÙƒÙ„Ù…Ø©)</option>
            </select>
          </div>
        </div>
        
        <div>
          <label class="manual-label">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ§Øª (ÙŠÙ…ÙƒÙ† Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¹Ø¯Ø¯Ø©)</label>
          <div class="platform-buttons">
            <button type="button" class="platform-btn" data-platform="Google Ads">ğŸ“ Google Ads</button>
            <button type="button" class="platform-btn" data-platform="Facebook">ğŸ“˜ Facebook</button>
            <button type="button" class="platform-btn active" data-platform="Instagram">ğŸ“¸ Instagram</button>
            <button type="button" class="platform-btn" data-platform="TikTok">ğŸµ TikTok</button>
            <button type="button" class="platform-btn" data-platform="YouTube">ğŸ“º YouTube</button>
            <button type="button" class="platform-btn" data-platform="Snapchat">ğŸ‘» Snapchat</button>
            <button type="button" class="platform-btn" data-platform="LinkedIn">ğŸ’¼ LinkedIn</button>
          </div>
          <p style="text-align:center;color:#6b7280;font-size:0.9rem;margin-top:10px">
            Ù…Ù†ØµØ§Øª Ù…Ø®ØªØ§Ø±Ø©: <span id="selectedPlatforms">Instagram</span>
          </p>
        </div>

        <div style="text-align:center;margin-top:25px">
          <button type="submit" class="btn-ai">ğŸš€ ØªÙˆÙ„ÙŠØ¯ Ø°ÙƒÙŠ Ø¨Ø§Ù„Ø§Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</button>
        </div>
      </form>
    </div>

    <div id="results" style="display:none">
      <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© -->
      <div class="card" style="background:#f0f9ff;border-color:#3b82f6">
        <h2>ğŸ¯ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ù…ÙˆÙ„Ø¯Ø©</h2>
        <div id="strategyContent"></div>
      </div>

      <!-- Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© -->
      <div class="card">
        <h2>ğŸ”‘ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</h2>
        <div id="keywordsContent"></div>
        <div class="auto-stats" id="keywordStats"></div>
      </div>

      <!-- Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ© -->
      <div class="card" id="negativeSection" style="display:none">
        <h2>ğŸš« Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</h2>
        <div id="negativesContent"></div>
      </div>

      <!-- Ø§Ù„ØªÙˆØ²ÙŠØ¹ ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª -->
      <div class="card">
        <h2>ğŸ’° Ø§Ù„ØªÙˆØ²ÙŠØ¹ ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª</h2>
        <div id="forecastsContent"></div>
      </div>

      <!-- Ø§Ù„ØªØµØ¯ÙŠØ± -->
      <div class="card">
        <h2>ğŸ“¥ Ø§Ù„ØªØµØ¯ÙŠØ±</h2>
        <div class="download-zone">
          <button id="copyKeywords" class="btn-copy">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙ„Ù…Ø§Øª</button>
          <button id="copyNegatives" class="btn-copy">ğŸš« Ù†Ø³Ø® Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</button>
          <button id="exportXLSX" class="btn-download">ğŸ“Š ØªÙ†Ø²ÙŠÙ„ XLSX</button>
          <button id="exportProfile" class="btn-download">ğŸ¯ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„</button>
        </div>
      </div>
    </div>
  </div>

  <footer style="background:var(--gradient);color:white;margin-top:40px;padding:25px 15px;text-align:center;border-radius:20px 20px 0 0">
    <div style="display:flex;gap:15px;flex-wrap:wrap;justify-content:center;margin-bottom:15px">
      <a href="../about.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Øª</a>
      <a href="../tools-directory.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª</a>
      <a href="https://arabsad.com" target="_blank" rel="noopener noreferrer" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</a>
    </div>
    <small style="opacity:0.9">Â© 2025 Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠ - ÙŠØ¯ÙˆÙŠ + ØªÙ„Ù‚Ø§Ø¦ÙŠ</small>
  </footer>

  <script src="../assets/js/xlsx.full.min.js"></script>
  <script>
    // Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
    const BENCHMARKS = {
      'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': {currency:'SAR', cpm:{'Google Ads':2.2,Facebook:1.8,Instagram:2.0,Snapchat:3.1,TikTok:2.5,YouTube:1.6,LinkedIn:4.8}},
      'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': {currency:'AED', cpm:{'Google Ads':2.8,Facebook:2.1,Instagram:2.3,LinkedIn:4.2,YouTube:1.9,TikTok:2.7,Snapchat:3.3}},
      'Ù…ØµØ±': {currency:'EGP', cpm:{Facebook:0.4,'Google Ads':0.6,Instagram:0.5,TikTok:0.7,YouTube:0.3,Snapchat:0.8,LinkedIn:1.2}},
      'Ø§Ù„ÙƒÙˆÙŠØª': {currency:'KWD', cpm:{'Google Ads':1.9,Facebook:1.5,Instagram:1.7,Snapchat:2.8,TikTok:2.1,YouTube:1.4,LinkedIn:3.8}},
      'Ù‚Ø·Ø±': {currency:'QAR', cpm:{'Google Ads':3.1,Facebook:2.3,Instagram:2.6,YouTube:2.0,TikTok:2.8,Snapchat:3.5,LinkedIn:5.1}},
      'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†': {currency:'BHD', cpm:{'Google Ads':1.8,Facebook:1.4,Instagram:1.6,TikTok:1.9,YouTube:1.2,Snapchat:2.3,LinkedIn:3.2}},
      'Ø¹ÙÙ…Ø§Ù†': {currency:'OMR', cpm:{'Google Ads':2.0,Facebook:1.6,Instagram:1.8,TikTok:2.2,YouTube:1.5,Snapchat:2.6,LinkedIn:3.6}},
      'Ø§Ù„Ø£Ø±Ø¯Ù†': {currency:'JOD', cpm:{Facebook:1.2,'Google Ads':1.6,Instagram:1.4,TikTok:1.5,YouTube:1.0,Snapchat:1.8,LinkedIn:2.4}},
      'Ù„Ø¨Ù†Ø§Ù†': {currency:'LBP', cpm:{Facebook:0.8,'Google Ads':1.1,Instagram:0.9,TikTok:1.0,YouTube:0.7,Snapchat:1.2,LinkedIn:1.8}},
      'Ø§Ù„Ù…ØºØ±Ø¨': {currency:'MAD', cpm:{Facebook:0.6,'Google Ads':0.9,Instagram:0.7,TikTok:0.8,YouTube:0.5,Snapchat:1.0,LinkedIn:1.5}},
      'ØªÙˆÙ†Ø³': {currency:'TND', cpm:{Facebook:0.5,'Google Ads':0.8,Instagram:0.6,TikTok:0.7,YouTube:0.4,Snapchat:0.9,LinkedIn:1.3}},
      'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±': {currency:'DZD', cpm:{Facebook:0.3,'Google Ads':0.5,Instagram:0.4,TikTok:0.5,YouTube:0.2,Snapchat:0.6,LinkedIn:0.9}}
    };

    // Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„Ù…Ø¬Ø§Ù„Ø§Øª
    const SMART_FIELDS = {
      'Ù…ÙŠØ¯ÙŠØ§ Ø¨Ø§ÙŠØ±': {
        synonyms: ['Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù…ÙˆÙ„Ø©', 'Ù…Ø¯ÙŠØ± Ø­Ù…Ù„Ø§Øª', 'Ø§Ø¯Ø³ Ø¨Ø§ÙŠØ±', 'Ù…Ø´ØªØ±ÙŠ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª'],
        smart_keywords: [
          'Ø§Ø¯Ø§Ø±Ø© Ø­Ù…Ù„Ø§Øª Ø§Ø¹Ù„Ø§Ù†ÙŠØ© Ù…Ù…ÙˆÙ„Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©',
          'Ø®Ø¯Ù…Ø§Øª Google Ads Ù„Ø²ÙŠØ§Ø¯Ø© ROAS',
          'Ø§Ø¯Ø§Ø±Ø© Facebook ÙˆInstagram Ads',
          'ØªØ­Ø³ÙŠÙ† Ø­Ù…Ù„Ø§Øª TikTok Ù„Ù„Ø´Ø±ÙƒØ§Øª', 
          'Ø®Ø¯Ù…Ø§Øª YouTube Ads',
          'ØªØ­Ø³ÙŠÙ† ROAS ÙˆØ§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±',
          'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¬Ù…Ù‡ÙˆØ± Ø¯Ù‚ÙŠÙ‚ ÙˆÙ…ØªÙ‚Ø¯Ù…',
          'ØªØµÙ…ÙŠÙ… Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©',
          'ØªØªØ¨Ø¹ ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ù…Ù„Ø§Øª',
          'Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø§Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø¯ÙÙˆØ¹'
        ],
        negatives: ['ÙˆØ¸Ø§Ø¦Ù Ù…ÙŠØ¯ÙŠØ§', 'ØªØ¹Ù„ÙŠÙ… Ø§Ø¹Ù„Ø§Ù†Ø§Øª', 'Ø¯ÙˆØ±Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ©', 'Ø§Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø¬Ø§Ù†ÙŠØ©', 'ØµÙˆØ± Ø§Ø¹Ù„Ø§Ù†Ø§Øª', 'Ø¨Ø±Ø§Ù…Ø¬ Ø§Ø¹Ù„Ø§Ù†Ø§Øª']
      },
      'Ø¯ÙƒØªÙˆØ± Ù†Ø³Ø§Ø¡': {
        synonyms: ['Ø·Ø¨ÙŠØ¨ Ù†Ø³Ø§', 'Ø¯ÙƒØªÙˆØ± ÙˆÙ„Ø§Ø¯Ø©', 'Ø·Ø¨ÙŠØ¨ Ù†Ø³Ø§Ø¡', 'Ù†Ø³Ø§Ø¡ ÙˆØªÙˆÙ„ÙŠØ¯'],
        smart_keywords: [
          'Ø§ÙØ¶Ù„ Ø¯ÙƒØªÙˆØ± Ù†Ø³Ø§Ø¡ ÙˆØªÙˆÙ„ÙŠØ¯ Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ',
          'Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø¯ÙƒØªÙˆØ± Ù†Ø³Ø§',
          'Ø§Ø³Ø¹Ø§Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ù…Ù„ Ø§Ù„ÙƒØ§Ù…Ù„Ø©',
          'Ø¯ÙƒØªÙˆØ± ÙˆÙ„Ø§Ø¯Ø© 24 Ø³Ø§Ø¹Ø© Ù„Ù„Ø·ÙˆØ§Ø±Ø¦',
          'Ø¹ÙŠØ§Ø¯Ø© Ù†Ø³Ø§Ø¡ ÙˆØªÙˆÙ„ÙŠØ¯ Ø¨Ø§Ù„ØªØ£Ù…ÙŠÙ†',
          'ÙØ­Øµ Ø§Ù„Ù…ÙˆØ¬Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© 4D',
          'Ø¹Ù„Ø§Ø¬ ØªØ£Ø®Ø± Ø§Ù„Ø­Ù…Ù„ ÙˆØ§Ù„Ø§Ù†Ø¬Ø§Ø¨',
          'Ù…Ù†Ø¸Ø§Ø± Ø±Ø­Ù…ÙŠ ØªØ´Ø®ÙŠØµÙŠ',
          'Ù…ØªØ§Ø¨Ø¹Ø© ØµØ­Ø© Ø§Ù„Ù…Ø±Ø£Ø© Ø§Ù„Ø§Ù†Ø¬Ø§Ø¨ÙŠØ©',
          'Ø±Ø¹Ø§ÙŠØ© Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„ÙˆÙ„Ø§Ø¯Ø©'
        ],
        negatives: ['ÙˆØ¸Ø§Ø¦Ù Ø·Ø¨', 'Ø¯Ø±Ø§Ø³Ø© Ø·Ø¨', 'ÙƒØªØ¨ Ø·Ø¨', 'ØµÙˆØ± Ø·Ø¨ÙŠØ©', 'Ø¬Ø§Ù…Ø¹Ø© Ø·Ø¨', 'ØªØ®ØµØµ Ø·Ø¨']
      },
      'Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«': {
        synonyms: ['Ù†Ù‚Ù„ Ø¹ÙØ´', 'ØªØ±Ø­ÙŠÙ„ Ø§Ø«Ø§Ø«', 'Ø´Ø­Ù† Ø§Ø«Ø§Ø«', 'Ù†Ù‚Ù„ Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§'],
        smart_keywords: [
          'Ø§Ø³Ø¹Ø§Ø± Ù†Ù‚Ù„ Ø¹ÙØ´ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶',
          'Ø§ÙØ¶Ù„ Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¹ Ø§Ù„ØªØ£Ù…ÙŠÙ†',
          'Ø±Ø§ÙØ¹Ø© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù„Ù„Ø·ÙˆØ§Ø¨Ù‚ Ø§Ù„Ø¹Ø§Ù„ÙŠØ©',
          'Ù†Ù‚Ù„ Ø¹ÙØ´ ÙÙˆØ±ÙŠ Ù†ÙØ³ Ø§Ù„ÙŠÙˆÙ…',
          'ØªØºÙ„ÙŠÙ Ø§Ø«Ø§Ø« Ø§Ø­ØªØ±Ø§ÙÙŠ',
          'Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¶Ù…ÙˆÙ†Ø©',
          'ØªØ®Ø²ÙŠÙ† Ø§Ø«Ø§Ø« Ù…Ø¤Ù‚Øª ÙˆØ¢Ù…Ù†',
          'ÙÙƒ ÙˆØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø§Ø«Ø§Ø« Ø§Ù„Ù…Ø¹Ù‚Ø¯'
        ],
        negatives: ['ÙˆØ¸Ø§Ø¦Ù Ù†Ù‚Ù„', 'ØªÙˆØ¸ÙŠÙ Ø³Ø§Ø¦Ù‚ÙŠÙ†', 'Ù†Ù‚Ù„ Ù…Ø¬Ø§Ù†ÙŠ', 'ØµÙˆØ± Ø§Ø«Ø§Ø«', 'Ø§Ø«Ø§Ø« Ù„Ù„Ø¨ÙŠØ¹', 'Ø¨ÙŠØ¹ Ø¹ÙØ´ Ù…Ø³ØªØ¹Ù…Ù„']
      }
    };

    let selectedPlatforms = ['Instagram'];
    let currentKeywords = [];
    let currentNegatives = [];
    let currentData = {};

    // ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù†ØµØ§Øª
    document.addEventListener('DOMContentLoaded', () => {
      const platformBtns = document.querySelectorAll('.platform-btn');
      const selectedSpan = document.getElementById('selectedPlatforms');

      platformBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const platform = btn.dataset.platform;
          
          if (btn.classList.contains('active')) {
            btn.classList.remove('active');
            selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
          } else {
            btn.classList.add('active');
            if (!selectedPlatforms.includes(platform)) {
              selectedPlatforms.push(platform);
            }
          }
          
          selectedSpan.textContent = selectedPlatforms.length > 0 ? selectedPlatforms.join(' â€¢ ') : 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù†ØµØ©';
        });
      });

      // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('manualForm').addEventListener('submit', (e) => {
        e.preventDefault();
        generateResults();
      });

      // ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµØ¯ÙŠØ±
      document.getElementById('copyKeywords').addEventListener('click', copyKeywords);
      document.getElementById('copyNegatives').addEventListener('click', copyNegatives);
      document.getElementById('exportXLSX').addEventListener('click', exportXLSX);
      document.getElementById('exportProfile').addEventListener('click', exportProfile);
    });

    function generateResults() {
      const field = document.getElementById('field').value.trim();
      const country = document.getElementById('country').value;
      const dialect = document.getElementById('dialect').value;
      const budget = parseInt(document.getElementById('budget').value);
      const matchType = document.getElementById('matchType').value;
      const expansion = document.getElementById('expansion').value;

      if (!field || !budget || selectedPlatforms.length === 0) {
        alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ù…Ù„Ø§ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ÙˆØ§Ø®ØªØ± Ù…Ù†ØµØ© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
        return;
      }

      currentData = { field, country, dialect, budget, matchType, expansion, platforms: [...selectedPlatforms] };

      // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
      currentKeywords = generateSmartKeywords(field, country, dialect, expansion);
      currentNegatives = generateSmartNegatives(field);

      // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©
      displayStrategy(currentData);
      
      // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
      displayKeywords(currentKeywords, matchType);
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø¨ÙŠØ©
      displayNegatives(currentNegatives);
      
      // Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
      displayForecasts(currentData);

      document.getElementById('results').style.display = 'block';
      document.getElementById('results').scrollIntoView({behavior: 'smooth'});
    }

    function generateSmartKeywords(field, country, dialect, expansion) {
      const fieldLower = field.toLowerCase();
      let keywords = [];

      // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
      Object.entries(SMART_FIELDS).forEach(([key, data]) => {
        const match = data.synonyms.some(syn => fieldLower.includes(syn.toLowerCase())) || fieldLower.includes(key.toLowerCase());
        if (match) {
          keywords.push(...data.smart_keywords);
        }
      });

      // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©
      if (keywords.length === 0) {
        keywords = [
          `Ø§ÙØ¶Ù„ ${field} Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ`,
          `Ø§Ø³Ø¹Ø§Ø± ${field}`,
          `Ø­Ø¬Ø² ${field}`,
          `Ø±Ù‚Ù… ${field}`,
          `Ø®Ø¯Ù…Ø§Øª ${field} Ø§Ø­ØªØ±Ø§ÙÙŠØ©`,
          `${field} Ù…Ø¶Ù…ÙˆÙ†`,
          `Ø¹Ø±ÙˆØ¶ ${field}`,
          `${field} 24 Ø³Ø§Ø¹Ø©`
        ];
      }

      // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø§Øª Ø¬ØºØ±Ø§ÙÙŠØ©
      const cities = {
        'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': ['Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ø¬Ø¯Ø©', 'Ø§Ù„Ø¯Ù…Ø§Ù…'],
        'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': ['Ø¯Ø¨ÙŠ', 'Ø£Ø¨ÙˆØ¸Ø¨ÙŠ', 'Ø§Ù„Ø´Ø§Ø±Ù‚Ø©'],
        'Ù…ØµØ±': ['Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©', 'Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©', 'Ø§Ù„Ø¬ÙŠØ²Ø©'],
        'Ø§Ù„ÙƒÙˆÙŠØª': ['Ø§Ù„ÙƒÙˆÙŠØª', 'Ø­ÙˆÙ„ÙŠ', 'Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ']
      };

      if (cities[country]) {
        cities[country].forEach(city => {
          keywords.push(`${field} ÙÙŠ ${city}`);
          keywords.push(`Ø§ÙØ¶Ù„ ${field} ${city}`);
        });
      }

      // ØªØ·Ø¨ÙŠÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹
      if (expansion === 'conservative') {
        keywords = keywords.slice(0, 30);
      } else if (expansion === 'aggressive') {
        // Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
        keywords.push(`${field} Ø±Ø®ÙŠØµ`, `${field} Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©`, `${field} Ø³Ø±ÙŠØ¹`, `${field} Ù…Ø¬Ø§Ù†ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±`);
      }

      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙƒØ±Ø§Ø± ÙˆØªØ±ØªÙŠØ¨
      return [...new Set(keywords)].slice(0, expansion === 'aggressive' ? 100 : expansion === 'moderate' ? 60 : 30);
    }

    function generateSmartNegatives(field) {
      const fieldLower = field.toLowerCase();
      let negatives = ['ÙˆØ¸Ø§Ø¦Ù', 'Ù…Ø¬Ø§Ù†ÙŠ', 'ØªØ¹Ù„ÙŠÙ…', 'Ø¯ÙˆØ±Ø§Øª', 'ØµÙˆØ±', 'ÙÙŠØ¯ÙŠÙˆ'];

      // Ø¥Ø¶Ø§ÙØ© Ø³Ù„Ø¨ÙŠØ© Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø¬Ø§Ù„
      Object.entries(SMART_FIELDS).forEach(([key, data]) => {
        const match = data.synonyms.some(syn => fieldLower.includes(syn.toLowerCase())) || fieldLower.includes(key.toLowerCase());
        if (match && data.negatives) {
          negatives.push(...data.negatives);
        }
      });

      return [...new Set(negatives)];
    }

    function displayStrategy(data) {
      const strategyDiv = document.getElementById('strategyContent');
      const countryData = BENCHMARKS[data.country] || BENCHMARKS['Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©'];
      
      strategyDiv.innerHTML = `
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;margin:20px 0">
          <div style="background:#f0f9ff;padding:15px;border-radius:10px;border-left:4px solid #3b82f6">
            <strong>ğŸ¯ Ø§Ù„Ù…Ø¬Ø§Ù„</strong><br>${data.field}
          </div>
          <div style="background:#f0fdf4;padding:15px;border-radius:10px;border-left:4px solid #22c55e">
            <strong>ğŸŒ Ø§Ù„Ø¯ÙˆÙ„Ø©</strong><br>${data.country} (${countryData.currency})
          </div>
          <div style="background:#fef3c7;padding:15px;border-radius:10px;border-left:4px solid #f59e0b">
            <strong>ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</strong><br>${data.budget.toLocaleString()} ${countryData.currency}
          </div>
          <div style="background:#fdf2f8;padding:15px;border-radius:10px;border-left:4px solid #ec4899">
            <strong>ğŸ“± Ø§Ù„Ù…Ù†ØµØ§Øª</strong><br>${data.platforms.join(' â€¢ ')}
          </div>
        </div>
        <div style="background:#f8fafc;padding:15px;border-radius:10px;margin-top:15px">
          <strong>ğŸ§  Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©:</strong> ØªÙ… ØªØ­Ù„ÙŠÙ„ "${data.field}" ÙˆØªØ­Ø¯ÙŠØ¯ Ø£ÙØ¶Ù„ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø­Ø³Ø¨ Ø§Ø®ØªÙŠØ§Ø±Ø§ØªÙƒ Ù…Ø¹ ${data.platforms.length} Ù…Ù†ØµØ© ÙÙŠ ${data.country}
        </div>
      `;
    }

    function displayKeywords(keywords, matchType) {
      const keywordsDiv = document.getElementById('keywordsContent');
      keywordsDiv.innerHTML = '<div style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center"></div>';
      const container = keywordsDiv.firstElementChild;

      keywords.forEach((keyword, i) => {
        const pill = document.createElement('span');
        pill.textContent = keyword;
        pill.className = i < 20 ? 'pill pill-ai' : i < 40 ? 'pill pill-expert' : 'pill pill-premium';
        container.appendChild(pill);
      });

      document.getElementById('keywordStats').innerHTML = `
        ğŸ”‘ <strong>${keywords.length}</strong> ÙƒÙ„Ù…Ø© Ø°ÙƒÙŠØ© â€¢ 
        ğŸ¯ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©: <strong>${matchType === 'mixed' ? 'Ù…Ø²ÙŠØ¬' : matchType === 'phrase' ? 'Ø¹Ø¨Ø§Ø±Ø©' : matchType === 'broad' ? 'ÙˆØ§Ø³Ø¹Ø©' : 'ØªØ§Ù…Ø©'}</strong> â€¢ 
        âš¡ Ù…ÙˆÙ„Ø¯Ø© Ø­Ø³Ø¨ Ø§Ø®ØªÙŠØ§Ø±Ø§ØªÙƒ
      `;
    }

    function displayNegatives(negatives) {
      const negativesDiv = document.getElementById('negativesContent');
      negativesDiv.innerHTML = '<div style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center"></div>';
      const container = negativesDiv.firstElementChild;

      negatives.forEach(negative => {
        const pill = document.createElement('span');
        pill.textContent = `-${negative}`;
        pill.className = 'pill pill-negative';
        container.appendChild(pill);
      });

      document.getElementById('negativeSection').style.display = 'block';
    }

    function displayForecasts(data) {
      const forecastsDiv = document.getElementById('forecastsContent');
      const countryData = BENCHMARKS[data.country] || BENCHMARKS['Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©'];
      const budgetPerPlatform = data.budget / data.platforms.length;

      let totalImpressions = 0, totalClicks = 0, totalConversions = 0;

      let content = '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;text-align:center">';

      data.platforms.forEach(platform => {
        const cpm = countryData.cpm[platform] || 2;
        const impressions = Math.round((budgetPerPlatform / cpm) * 1000);
        const clicks = Math.round(impressions * 0.015);
        const conversions = Math.round(clicks * 0.025);

        totalImpressions += impressions;
        totalClicks += clicks;
        totalConversions += conversions;

        content += `
          <div style="background:#f9fafb;padding:15px;border-radius:10px;border:1px solid #e5e7eb">
            <div style="font-weight:800;color:#1e40af;margin-bottom:5px">${platform}</div>
            <div style="font-size:0.85rem;color:#64748b">
              CPM: $${cpm.toFixed(2)}<br>
              Ù…ÙŠØ²Ø§Ù†ÙŠØ©: ${Math.round(budgetPerPlatform).toLocaleString()} ${countryData.currency}<br>
              Ø¸Ù‡ÙˆØ±: ${impressions.toLocaleString()}<br>
              Ù†Ù‚Ø±Ø§Øª: ${clicks.toLocaleString()}<br>
              ØªØ­ÙˆÙŠÙ„Ø§Øª: ${conversions.toLocaleString()}
            </div>
          </div>
        `;
      });

      content += `
        <div style="background:#eff6ff;padding:15px;border-radius:10px;border:2px solid #3b82f6;grid-column:1/-1">
          <div style="font-weight:800;color:#1e40af;font-size:1.1rem">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</div>
          <div style="margin-top:10px;display:flex;gap:20px;justify-content:center;flex-wrap:wrap">
            <div><strong>Ø¸Ù‡ÙˆØ±:</strong> ${totalImpressions.toLocaleString()}</div>
            <div><strong>Ù†Ù‚Ø±Ø§Øª:</strong> ${totalClicks.toLocaleString()}</div>
            <div><strong>ØªØ­ÙˆÙŠÙ„Ø§Øª:</strong> ${totalConversions.toLocaleString()}</div>
            <div><strong>ROAS Ù…ØªÙˆÙ‚Ø¹:</strong> 3.2x - 5.8x</div>
          </div>
        </div>
      </div>`;

      forecastsDiv.innerHTML = content;
    }

    function copyKeywords() {
      if (currentKeywords.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª Ù„Ù†Ø³Ø®Ù‡Ø§');
        return;
      }
      
      navigator.clipboard.writeText(currentKeywords.join('\\n')).then(() => {
        alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentKeywords.length} ÙƒÙ„Ù…Ø©`);
      }).catch(() => {
        alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø® - Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
      });
    }

    function copyNegatives() {
      if (currentNegatives.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒÙ„Ù…Ø§Øª Ø³Ù„Ø¨ÙŠØ© Ù„Ù†Ø³Ø®Ù‡Ø§');
        return;
      }
      
      const negativesList = currentNegatives.map(n => `-${n}`);
      navigator.clipboard.writeText(negativesList.join('\\n')).then(() => {
        alert(`âœ… ØªÙ… Ù†Ø³Ø® ${currentNegatives.length} ÙƒÙ„Ù…Ø© Ø³Ù„Ø¨ÙŠØ©`);
      }).catch(() => {
        alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø® - Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
      });
    }

    function exportXLSX() {
      if (!window.XLSX || typeof XLSX.writeFile !== 'function') {
        exportCSV();
        return;
      }

      try {
        const wb = XLSX.utils.book_new();
        const now = new Date();
        const countryData = BENCHMARKS[currentData.country] || BENCHMARKS['Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©'];

        // ÙˆØ±Ù‚Ø© Ø§Ù„Ù…Ù„Ø®Øµ
        const summaryData = [
          ['ğŸ¯ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø© (ÙŠØ¯ÙˆÙŠ)', ''],
          ['', ''],
          ['Ø§Ù„Ù…Ø¬Ø§Ù„', currentData.field],
          ['Ø§Ù„Ø¯ÙˆÙ„Ø©', currentData.country],
          ['Ø§Ù„Ø¹Ù…Ù„Ø©', countryData.currency],
          ['Ø§Ù„Ù„Ù‡Ø¬Ø©', currentData.dialect === 'classical' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰' : `Ù„Ù‡Ø¬Ø© ${currentData.country}`],
          ['Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©', `${currentData.budget} ${countryData.currency}`],
          ['Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©', currentData.matchType],
          ['Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹', currentData.expansion],
          ['Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©', currentData.platforms.join(' â€¢ ')],
          ['ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙˆÙ„ÙŠØ¯', now.toLocaleDateString('ar-SA')],
          ['ÙˆÙ‚Øª Ø§Ù„ØªÙˆÙ„ÙŠØ¯', now.toLocaleTimeString('ar-SA')],
          ['', ''],
          ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª', currentKeywords.length],
          ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ø¨ÙŠØ©', currentNegatives.length],
          ['Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆÙ„ÙŠØ¯', 'ØªØ­ÙƒÙ… ÙŠØ¯ÙˆÙŠ + Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ']
        ];

        const wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
        XLSX.utils.book_append_sheet(wb, wsSummary, 'Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø©');

        // ÙˆØ±Ù‚Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª
        const keywordRows = [['Ø§Ù„ÙƒÙ„Ù…Ø©', 'Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©', 'Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©', 'Ø§Ù„Ù…ØµØ¯Ø±']];
        currentKeywords.forEach((kw, i) => {
          const priority = i < 20 ? 'Ø¹Ø§Ù„ÙŠØ©' : i < 40 ? 'Ù…ØªÙˆØ³Ø·Ø©' : 'Ù…Ù†Ø®ÙØ¶Ø©';
          keywordRows.push([kw, currentData.matchType, priority, 'Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ']);
        });

        const wsKeywords = XLSX.utils.aoa_to_sheet(keywordRows);
        XLSX.utils.book_append_sheet(wb, wsKeywords, 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©');

        // ÙˆØ±Ù‚Ø© Ø§Ù„Ø³Ù„Ø¨ÙŠØ©
        const negativeRows = [['Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ù„Ø¨ÙŠØ©', 'Ø§Ù„Ø³Ø¨Ø¨', 'Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©']];
        currentNegatives.forEach(neg => {
          negativeRows.push([neg, 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±', 'Ø¹Ø§Ù„ÙŠØ©']);
        });

        const wsNegatives = XLSX.utils.aoa_to_sheet(negativeRows);
        XLSX.utils.book_append_sheet(wb, wsNegatives, 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©');

        // ÙˆØ±Ù‚Ø© Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©
        const strategyRows = [['Ø§Ù„Ù…Ù†ØµØ©', 'Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ù‚ØªØ±Ø­', 'Ø§Ù„Ù‡Ø¯Ù', 'Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©', 'CPM Ø§Ù„Ù…ØªÙˆÙ‚Ø¹']];
        const budgetPerPlatform = currentData.budget / currentData.platforms.length;

        currentData.platforms.forEach(platform => {
          const cpm = countryData.cpm[platform] || 2;
          let adType = 'Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø§Ù…', goal = 'Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆØ¹ÙŠ';
          
          if (platform === 'Google Ads') {
            adType = 'Ø¨Ø­Ø« Ù…Ø­Ù„ÙŠ + Ø®Ø±Ø§Ø¦Ø·';
            goal = 'ØªØ­ÙˆÙŠÙ„Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©';
          } else if (platform === 'Facebook') {
            adType = 'Lead Generation';
            goal = 'ØªÙˆÙ„ÙŠØ¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø­ØªÙ…Ù„ÙŠÙ†';
          } else if (platform === 'Instagram') {
            adType = 'Reels + Stories';
            goal = 'Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆØ¹ÙŠ ÙˆØ§Ù„ØªÙØ§Ø¹Ù„';
          } else if (platform === 'TikTok') {
            adType = 'Video Ads';
            goal = 'Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯';
          } else if (platform === 'YouTube') {
            adType = 'In-Stream';
            goal = 'Ø´Ø±Ø­ ÙˆØªÙˆØ¹ÙŠØ©';
          }

          strategyRows.push([platform, adType, goal, `${Math.round(budgetPerPlatform)} ${countryData.currency}`, `$${cmp.toFixed(2)}`]);
        });

        const wsStrategy = XLSX.utils.aoa_to_sheet(strategyRows);
        XLSX.utils.book_append_sheet(wb, wsStrategy, 'Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª');

        const fileName = `Manual-${currentData.field.replace(/\\s+/g,'-')}-${Date.now()}.xlsx`;
        XLSX.writeFile(wb, fileName);

        alert('âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù XLSX Ø¨Ù†Ø¬Ø§Ø­!');

      } catch (error) {
        console.error('Ø®Ø·Ø£ XLSX:', error);
        exportCSV();
      }
    }

    function exportCSV() {
      const csvRows = ['Ø§Ù„ÙƒÙ„Ù…Ø©,Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©,Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©,Ø§Ù„Ù…ØµØ¯Ø±'];
      currentKeywords.forEach((kw, i) => {
        const priority = i < 20 ? 'Ø¹Ø§Ù„ÙŠØ©' : 'Ù…ØªÙˆØ³Ø·Ø©';
        csvRows.push(`${kw},${currentData.matchType},${priority},Ø°ÙƒÙŠ`);
      });

      const csvContent = '\\ufeff' + csvRows.join('\\n');
      const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `Manual-${currentData.field.replace(/\\s+/g,'-')}-${Date.now()}.csv`;
      link.click();
      URL.revokeObjectURL(link.href);

      alert('âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù CSV!');
    }

    function exportProfile() {
      const profileData = {
        field: currentData.field,
        country: currentData.country,
        dialect: currentData.dialect,
        platforms: currentData.platforms,
        budget: currentData.budget,
        keywords: currentKeywords,
        negatives: currentNegatives,
        generated_at: new Date().toISOString(),
        mode: 'manual'
      };

      const blob = new Blob([JSON.stringify(profileData, null, 2)], {type: 'application/json'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `Profile-${currentData.field.replace(/\\s+/g,'-')}.json`;
      link.click();
      URL.revokeObjectURL(link.href);

      alert('âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„!');
    }

    // ØªØ£Ù…ÙŠÙ† ØªØ­Ù…ÙŠÙ„ XLSX
    (function ensureXLSX(){
      if (!window.XLSX) {
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
        script.async = true;
        document.head.appendChild(script);
      }
    })();
  </script>
</body>
</html>