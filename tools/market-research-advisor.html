<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…ÙØ±Ø´ÙÙ‘Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©</title>
  <link rel="icon" href="../favicon.svg">
  <link rel="stylesheet" href="../global-styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .container{max-width:1200px;margin:0 auto;padding:20px}
    .nav-tabs{display:flex;gap:8px;background:#f8f9fa;border-radius:12px;padding:8px;margin-bottom:20px;overflow-x:auto;flex-wrap:wrap}
    .nav-tab{padding:10px 16px;border-radius:8px;background:transparent;border:none;cursor:pointer;white-space:nowrap;transition:all 0.3s;font-weight:600;color:#333}
    .nav-tab:hover,.nav-tab.active{background:var(--gradient);color:white;transform:translateY(-1px)}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:25px;margin:20px 0;box-shadow:0 4px 16px rgba(0,0,0,.08)}
    .row{display:flex;gap:15px;flex-wrap:wrap;align-items:end}
    .col{flex:1 1 280px;min-width:0}
    .kpi{display:flex;gap:15px;flex-wrap:wrap}
    .kpi div{background:#f9fafb;border:2px solid #e5e7eb;border-radius:12px;padding:15px;flex:1 1 180px;text-align:center;font-weight:600}
    .pill{display:inline-block;padding:8px 14px;border-radius:20px;margin:4px;font-size:0.9rem;font-weight:600;border:2px solid;transition:all 0.2s}
    .pill-phrase{background:#dbeafe;color:#1e40af;border-color:#93c5fd}
    .pill-exact{background:#d1fae5;color:#166534;border-color:#86efac}
    .pill-broad{background:#fef3c7;color:#92400e;border-color:#fcd34d}
    .pill-negative{background:#fee2e2;color:#991b1b;border-color:#fca5a5}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .btn{background:var(--gradient);color:#fff;border:none;border-radius:25px;padding:12px 20px;cursor:pointer;font-weight:700;margin:5px;transition:all 0.3s;font-size:0.95rem}
    .btn:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(102,126,234,0.4)}
    .btn-secondary{background:#64748b}
    .btn-success{background:#059669}
    .btn-warning{background:#d97706;color:white}
    .platforms{margin:20px 0}
    .platforms .platform-row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:center}
    .platforms label{display:flex;align-items:center;gap:8px;background:#f9fafb;border:2px solid #e5e7eb;border-radius:25px;padding:10px 16px;cursor:pointer;margin:4px;transition:all 0.3s;font-weight:600}
    .platforms label:hover{background:#f3f4f6;border-color:#d1d5db;transform:translateY(-1px)}
    .platforms input:checked + label{background:#dbeafe;border-color:#3b82f6;color:#1e40af}
    .platform-suggestions{background:#eff6ff;border:2px solid #93c5fd;border-radius:14px;padding:18px;margin:15px 0}
    .platform-strategy{background:#f0fdf4;border:1px solid #86efac;border-radius:8px;padding:8px 12px;margin:5px 0;font-size:0.8rem}
    .intent-group{margin:15px 0;padding:18px;background:#fafbfc;border-radius:12px;border-left:5px solid #3b82f6}
    .intent-title{font-weight:800;color:#1e40af;margin-bottom:10px;font-size:1.1rem}
    .success{background:#f0fdf4;color:#166534;border:2px solid #86efac;padding:18px;border-radius:14px;margin:20px 0;display:none;text-align:center;font-weight:700;font-size:1.05rem}
    .muted{color:#6b7280;font-size:0.9rem;font-weight:500}
    .small{font-size:0.85rem}
    .search-box{position:relative}
    .sector-suggestions{position:absolute;top:100%;left:0;right:0;background:#fff;border:2px solid #e5e7eb;border-radius:10px;max-height:220px;overflow-y:auto;z-index:1000;display:none;box-shadow:0 8px 25px rgba(0,0,0,0.12)}
    .sector-item{padding:12px 18px;cursor:pointer;border-bottom:1px solid #f3f4f6;transition:all 0.2s;font-weight:500}
    .sector-item:hover{background:#f9fafb;color:#1e40af;font-weight:600}
    .sector-item:last-child{border-bottom:none}
    input,select{width:100%;padding:14px 16px;border:2px solid #e5e7eb;border-radius:10px;font-family:inherit;font-size:1rem;font-weight:500;transition:border-color 0.2s}
    input:focus,select:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,0.1)}
    label{display:block;margin-bottom:8px;font-weight:700;color:#374151;font-size:0.95rem}
    .quick-actions{display:flex;gap:10px;flex-wrap:wrap;margin:15px 0;justify-content:center}
    .dialect-info{background:#fef7ff;border:1px solid #e879f9;color:#a21caf;padding:8px 12px;border-radius:8px;font-size:0.8rem;margin-top:5px;text-align:center}
    .last-update{background:#f1f5f9;border:1px solid #cbd5e1;padding:8px 12px;border-radius:8px;font-size:0.8rem;text-align:center;margin:10px 0;color:#475569}
    @media(max-width:768px){
      .row{flex-direction:column}
      .nav-tabs{justify-content:center}
      .kpi{flex-direction:column}
      .platforms .platform-row{justify-content:center}
      .container{padding:15px}
      .card{padding:18px;margin:15px 0}
    }
  </style>
</head>
<body>
  <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆØ­Ø¯ -->
  <nav class="unified-nav" style="display:flex;gap:15px;flex-wrap:wrap;align-items:center;justify-content:center;padding:15px 10px;background:var(--gradient);border-radius:0 0 20px 20px;margin-bottom:20px">
    <a href="../" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="../alerts.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-bell"></i> Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</a>
    <a href="../keyword-generator.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-key"></i> Ø§Ù„ÙƒÙ„Ù…Ø§Øª</a>
    <a href="../cpc-calculator.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-calculator"></i> CPC</a>
    <a href="../roi-calculator.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-chart-line"></i> ROI</a>
    <a href="../roas-calculator.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-money-bill-trend-up"></i> ROAS</a>
    <a href="../budget-planner.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-chart-pie"></i> Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</a>
    <a href="../tools-directory.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:15px;transition:all 0.3s;font-weight:600"><i class="fas fa-list"></i> Ø§Ù„Ø¯Ù„ÙŠÙ„</a>
  </nav>

  <div class="container">
    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© -->
    <div class="nav-tabs">
      <button class="nav-tab active" onclick="scrollToSection('top');">ğŸ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
      <button class="nav-tab" onclick="scrollToSection('keywords');">ğŸ”‘ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</button>
      <button class="nav-tab" onclick="scrollToSection('negatives');">ğŸš« Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</button>
      <button class="nav-tab" onclick="scrollToSection('platforms');">ğŸ“± Ø§Ù„Ù…Ù†ØµØ§Øª</button>
      <button class="nav-tab" onclick="scrollToSection('budget');">ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</button>
      <button class="nav-tab" onclick="scrollToSection('forecasts');">ğŸ“ˆ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª</button>
      <button class="nav-tab" onclick="scrollToSection('export');">ğŸ“¥ Ø§Ù„ØªØµØ¯ÙŠØ±</button>
    </div>

    <!-- Ø¹Ø±Ø¶ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <div class="last-update" id="lastUpdateInfo">
      ğŸ“… Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª: <span id="lastUpdateDate">ÙŠØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚...</span>
      <button id="refreshData" style="background:#0ea5e9;color:white;border:none;padding:4px 8px;border-radius:5px;margin:0 5px;font-size:0.75rem;cursor:pointer">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†</button>
    </div>

    <div id="top">
      <h1>ğŸ¯ Ù…ÙØ±Ø´ÙÙ‘Ø¯ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø°ÙƒÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚Ø©</h1>
      <p class="muted">Ø£Ø¯Ø§Ø© Ø´Ø§Ù…Ù„Ø© Ù„ØªÙˆÙ„ÙŠØ¯ ÙƒÙ„Ù…Ø§Øª Ø¨Ø­Ø« Ø¹Ø±Ø¨ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø¹ 50+ Ù…Ø¬Ø§Ù„ØŒ Ø¨Ø­Ø« Ø°ÙƒÙŠØŒ Ù„Ù‡Ø¬Ø§Øª Ù…Ø­Ù„ÙŠØ©ØŒ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©ØŒ ÙƒÙ„Ù…Ø§Øª Ø³Ù„Ø¨ÙŠØ©ØŒ ÙˆÙ…Ù†ØµØ§Øª Ù…Ù‚ØªØ±Ø­Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆÙ„Ø©. ØªØµØ¯ÙŠØ± XLSX/CSV Ù…Ø¹ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø© ÙˆØ§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. Ù…Ø¬Ø§Ù†ÙŠ 100% ÙˆØ¨Ø¯ÙˆÙ† Ø·Ø±Ù Ø«Ø§Ù„Ø«.</p>

      <div class="success" id="successMsg">âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø®Ø·Ø© Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ù†Ø³Ø® Ø£Ùˆ Ø§Ù„ØªØµØ¯ÙŠØ±.</div>

      <div class="card">
        <div class="row">
          <div class="col">
            <label>Ø§Ù„Ø¯ÙˆÙ„Ø©</label>
            <select id="country">
              <option value="">Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø©</option>
              <option value="Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©">Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</option>
              <option value="Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª</option>
              <option value="Ø§Ù„ÙƒÙˆÙŠØª">Ø§Ù„ÙƒÙˆÙŠØª</option>
              <option value="Ù‚Ø·Ø±">Ù‚Ø·Ø±</option>
              <option value="Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†">Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
              <option value="Ø¹ÙÙ…Ø§Ù†">Ø¹ÙÙ…Ø§Ù†</option>
              <option value="Ù…ØµØ±">Ù…ØµØ±</option>
              <option value="Ø§Ù„Ø£Ø±Ø¯Ù†">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
              <option value="Ù„Ø¨Ù†Ø§Ù†">Ù„Ø¨Ù†Ø§Ù†</option>
              <option value="Ø§Ù„Ù…ØºØ±Ø¨">Ø§Ù„Ù…ØºØ±Ø¨</option>
              <option value="ØªÙˆÙ†Ø³">ØªÙˆÙ†Ø³</option>
              <option value="Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
            </select>
          </div>
          <div class="col">
            <label>Ø§Ù„Ù„Ù‡Ø¬Ø©</label>
            <select id="dialect" disabled>
              <option value="classical">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰</option>
            </select>
            <div class="dialect-info" id="dialectInfo" style="display:none">ğŸ’¡ Ø§Ù„ØªØµØ¯ÙŠØ± ÙŠØªÙ… Ø¨Ø§Ù„ÙØµØ­Ù‰ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ† ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµØ¯ÙŠØ± Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ù…Ù† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©.</div>
          </div>
          <div class="col">
            <div class="search-box">
              <label>Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„</label>
              <input id="sectorFree" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ 50+ Ù…Ø¬Ø§Ù„ Ø£Ùˆ Ø§ÙƒØªØ¨ Ù…Ø¬Ø§Ù„ Ø¬Ø¯ÙŠØ¯..." autocomplete="off" />
              <div id="sectorSuggestions" class="sector-suggestions"></div>
            </div>
          </div>
          <div class="col">
            <label>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</label>
            <input id="budget" type="number" min="0" step="1" placeholder="Ø§ÙƒØªØ¨ Ø£ÙŠ Ø±Ù‚Ù… (Ù…Ø«Ø§Ù„: 1 Ø£Ùˆ 1000000)" />
            <small class="muted">Ø¨Ø¯ÙˆÙ† Ø­Ø¯ Ø£Ø¯Ù†Ù‰ Ø£Ùˆ Ø£Ù‚ØµÙ‰ â€” Ø§Ù„Ø±Ù‚Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø±Ùƒ</small>
          </div>
        </div>

        <div class="row">
          <div class="col">
            <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</label>
            <select id="matchType">
              <option value="mixed">Ù…Ø²ÙŠØ¬ (Ù…ÙˆØµÙ‰)</option>
              <option value="phrase">Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø¨Ø§Ø±Ø©</option>
              <option value="broad">Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø©</option>
              <option value="exact">Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©</option>
            </select>
          </div>
          <div class="col">
            <label>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹</label>
            <select id="expansionLevel">
              <option value="moderate">Ù…ØªÙˆØ³Ø· (50-80 ÙƒÙ„Ù…Ø©)</option>
              <option value="conservative">Ù…Ø­Ø§ÙØ¸ (30-40 ÙƒÙ„Ù…Ø©)</option>
              <option value="aggressive">ØªÙˆØ³Ø¹ÙŠ (100+ ÙƒÙ„Ù…Ø©)</option>
            </select>
          </div>
          <div class="col">
            <label>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</label>
            <div style="display:flex;align-items:center;gap:8px;margin-top:10px">
              <input type="checkbox" id="includeNegatives" checked style="width:auto" /> 
              <span>ØªØ¶Ù…ÙŠÙ† ÙƒÙ„Ù…Ø§Øª Ø³Ù„Ø¨ÙŠØ©</span>
            </div>
          </div>
        </div>

        <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·ÙŠ) -->
        <div style="margin-top:20px">
          <button id="advancedToggle" type="button" style="background:#f3f4f6;border:1px solid #d1d5db;color:#374151;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600">
            âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© <span id="advancedIcon">â–¼</span>
          </button>
          <div id="advancedSettings" style="display:none;background:#fafbfc;border:1px solid #e5e7eb;border-radius:10px;padding:15px;margin-top:10px">
            <label style="display:flex;align-items:center;gap:8px;font-weight:500">
              <input type="checkbox" id="exportInDialect" style="width:auto" /> 
              ØªØµØ¯ÙŠØ± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„ÙØµØ­Ù‰)
            </label>
          </div>
        </div>

        <div id="platforms" class="platforms">
          <label>Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ§Øª ÙŠØ¯ÙˆÙŠØ§Ù‹</label>
          <div id="platformSuggestions" class="platform-suggestions" style="display:none">
            <strong>ğŸ¯ Ù…Ù†ØµØ§Øª Ù…Ù‚ØªØ±Ø­Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆÙ„Ø©:</strong>
            <div class="quick-actions">
              <button id="selectRecommended" class="btn btn-success">âœ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­</button>
              <button id="selectTop2" class="btn btn-warning">ğŸ¥‡ Ø£ÙØ¶Ù„ Ù…Ù†ØµØªÙŠÙ†</button>
              <button id="selectAll" class="btn btn-secondary">ğŸ“ˆ Ø£Ù‚ØµÙ‰ ÙˆØµÙˆÙ„</button>
              <button id="clearAll" class="btn btn-secondary">âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„</button>
            </div>
          </div>
          <div id="platformToggles" class="platform-row"></div>
          <div id="adStrategies" style="margin-top:15px"></div>
        </div>

        <button id="run" class="btn" style="font-size:1.3rem;padding:18px 35px;width:100%;margin-top:15px;font-weight:800">ğŸš€ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© + Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© + Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
      </div>
    </div>

    <div id="out" style="display:none">
      <div id="keywords" class="card">
        <h2>ğŸ”‘ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©</h2>
        <div id="keywordsContent"></div>
        <p class="muted small" id="keywordStats"></p>
      </div>

      <div id="negatives" class="card" style="display:none">
        <h2>ğŸš« Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</h2>
        <div id="negativeKeywords" class="chips"></div>
        <p class="muted small">ÙƒÙ„Ù…Ø§Øª Ù„Ø§Ø³ØªØ¨Ø¹Ø§Ø¯Ù‡Ø§ Ù…Ù† Ø­Ù…Ù„Ø§ØªÙƒ Ù„ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø± ÙˆØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬ÙˆØ¯Ø©</p>
      </div>

      <div id="budget" class="card">
        <h2>ğŸ’° ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</h2>
        <div id="allocation" class="kpi"></div>
      </div>

      <div id="forecasts" class="card">
        <h2>ğŸ“ˆ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…ÙØµÙ„Ø©</h2>
        <div id="forecastsContent" class="kpi"></div>
      </div>

      <div id="export" class="card">
        <h2>ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„ÙØ§Øª</h2>
        <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center">
          <button id="copyAll" class="btn">ğŸ“‹ Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª</button>
          <button id="copyNegatives" class="btn btn-secondary">ğŸš« Ù†Ø³Ø® Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©</button>
          <button id="exportXlsx" class="btn">ğŸ“Š ØªÙ†Ø²ÙŠÙ„ XLSX Ù…ØªÙ‚Ø¯Ù…</button>
          <button id="exportGoogleAds" class="btn btn-secondary">ğŸ“„ ØªØµØ¯ÙŠØ± Google Ads CSV</button>
        </div>
        <p class="muted small" style="text-align:center;margin-top:12px">Ø§Ù„Ù…Ù„ÙØ§Øª ØªÙØ­ÙØ¸ Ø¨ØµÙŠØºØ© .xlsx Ùˆ .csv Ø£ØµÙ„ÙŠØ©ØŒ Ø¨Ø¯ÙˆÙ† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù‚ØªØ¨Ø§Ø³ØŒ Ù…Ø¹ Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø© ÙˆØ§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</p>
      </div>
    </div>
  </div>

  <!-- Ø§Ù„ÙÙˆØªØ± Ø§Ù„Ù…ÙˆØ­Ø¯ -->
  <footer style="background:var(--gradient);color:white;margin-top:40px;padding:25px 15px;text-align:center;border-radius:20px 20px 0 0">
    <div style="display:flex;gap:15px;flex-wrap:wrap;justify-content:center;margin-bottom:15px">
      <a href="../about.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø¹Ù† Ø§Ù„Ø£Ø¯ÙˆØ§Øª</a>
      <a href="../tools-directory.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª</a>
      <a href="../complete-tools-showcase.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø§Ù…Ù„</a>
      <a href="../alerts.html" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</a>
      <a href="https://arabsad.com" target="_blank" rel="noopener noreferrer" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø±Ø³Ù…ÙŠ</a>
      <a href="https://wa.me/201110760081" target="_blank" rel="noopener noreferrer" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">ÙˆØ§ØªØ³Ø§Ø¨</a>
      <a href="https://facebook.com/arabads.me" target="_blank" rel="noopener noreferrer" style="color:white;text-decoration:none;padding:8px 12px;border-radius:10px;transition:all 0.3s">ÙÙŠØ³Ø¨ÙˆÙƒ</a>
    </div>
    <small style="opacity:0.9">Â© 2025 Ù…Ø¤Ø³Ø³Ø© Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ - 27 Ø£Ø¯Ø§Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù„Ù…Ø³ÙˆÙ‚ÙŠÙ† Ø§Ù„Ø¹Ø±Ø¨</small>
  </footer>

  <!-- Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ© Ù…Ù† XLSX Ù…Ø¹ Ø¨Ø¯ÙŠÙ„ CDN -->
  <script src="../assets/js/xlsx.full.min.js"></script>
  <script>
    // ØªØ£Ù…ÙŠÙ† ØªØ­Ù…ÙŠÙ„ XLSX Ù…Ø¹ Ø¨Ø¯ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ
    (function ensureXLSX(){
      if (!window.XLSX || !XLSX.utils || typeof XLSX.writeFile !== 'function') {
        console.warn('Ø§Ø³ØªØ®Ø¯Ø§Ù… CDN ÙƒØ¨Ø¯ÙŠÙ„ Ù„Ù€ XLSX...');
        var s = document.createElement('script');
        s.src = 'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js';
        s.async = true;
        s.onload = () => console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ XLSX Ù…Ù† CDN Ø¨Ù†Ø¬Ø§Ø­');
        s.onerror = () => console.warn('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ XLSX Ù…Ù† CDN Ø£ÙŠØ¶Ù‹Ø§');
        document.head.appendChild(s);
      }
    })();

    const BENCHMARKS = {
      'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': {currency:'SAR', recommended:['Google Ads','Facebook','Instagram'], cpm:{'Google Ads':2.2,Facebook:1.8,Instagram:2.0,Snapchat:3.1,TikTok:2.5}},
      'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': {currency:'AED', recommended:['Google Ads','YouTube','Instagram'], cpm:{'Google Ads':2.8,Facebook:2.1,Instagram:2.3,LinkedIn:4.2,YouTube:1.9}},
      'Ø§Ù„ÙƒÙˆÙŠØª': {currency:'KWD', recommended:['Google Ads','Facebook','Instagram'], cpm:{'Google Ads':1.9,Facebook:1.5,Instagram:1.7,Snapchat:2.8}},
      'Ù‚Ø·Ø±': {currency:'QAR', recommended:['Google Ads','Facebook','Instagram'], cpm:{'Google Ads':3.1,Facebook:2.3,Instagram:2.6,YouTube:2.0}},
      'Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†': {currency:'BHD', recommended:['Google Ads','Facebook','Instagram'], cpm:{'Google Ads':1.8,Facebook:1.4,Instagram:1.6}},
      'Ø¹ÙÙ…Ø§Ù†': {currency:'OMR', recommended:['Google Ads','Facebook','Instagram'], cpm:{'Google Ads':2.0,Facebook:1.6,Instagram:1.8}},
      'Ù…ØµØ±': {currency:'EGP', recommended:['Facebook','Instagram','TikTok'], cpm:{Facebook:0.4,'Google Ads':0.6,Instagram:0.5,TikTok:0.7,YouTube:0.3}},
      'Ø§Ù„Ø£Ø±Ø¯Ù†': {currency:'JOD', recommended:['Facebook','Instagram','Google Ads'], cpm:{Facebook:1.2,'Google Ads':1.6,Instagram:1.4}},
      'Ù„Ø¨Ù†Ø§Ù†': {currency:'LBP', recommended:['Facebook','Instagram','Google Ads'], cpm:{Facebook:0.8,'Google Ads':1.1,Instagram:0.9}},
      'Ø§Ù„Ù…ØºØ±Ø¨': {currency:'MAD', recommended:['Facebook','Instagram','Google Ads'], cpm:{Facebook:0.6,'Google Ads':0.9,Instagram:0.7}},
      'ØªÙˆÙ†Ø³': {currency:'TND', recommended:['Facebook','Instagram','Google Ads'], cpm:{Facebook:0.5,'Google Ads':0.8,Instagram:0.6}},
      'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±': {currency:'DZD', recommended:['Facebook','Instagram','Google Ads'], cpm:{Facebook:0.3,'Google Ads':0.5,Instagram:0.4}}
    };

    // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ù‡Ø¬Ø§Øª
    const DIALECTS = {
      'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©': {
        transforms: {
          'Ø£Ø«Ø§Ø«': 'Ø¹ÙØ´', 'ØªØ±Ø­ÙŠÙ„': 'Ù†Ù‚Ù„', 'Ø´Ø­Ù†': 'Ù†Ù‚Ù„', 'Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§': 'Ø¹ÙØ´',
          'ØªÙ†Ø¸ÙŠÙ': 'ØªÙ†Ø¸ÙŠÙ', 'ØªØ¹Ù‚ÙŠÙ…': 'ØªØ¹Ù‚ÙŠÙ…', 'ØºØ³ÙŠÙ„': 'ØºØ³ÙŠÙ„',
          'ØªØ³Ù„ÙŠÙƒ': 'ØªØ³Ù„ÙŠÙƒ', 'Ø´ÙØ·': 'Ø´ÙØ·', 'Ù…Ø¬Ø§Ø±ÙŠ': 'Ù…Ø¬Ø§Ø±ÙŠ', 'Ø¨ÙŠØ§Ø±Ø§Øª': 'Ø¨ÙŠØ§Ø±Ø§Øª'
        }
      },
      'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': {
        transforms: {
          'Ø£Ø«Ø§Ø«': 'Ø£Ø«Ø§Ø«', 'Ø¹ÙØ´': 'Ø£Ø«Ø§Ø«', 'ØªØ±Ø­ÙŠÙ„': 'Ù†Ù‚Ù„', 'Ø´Ø­Ù†': 'Ø´Ø­Ù†',
          'ØªÙ†Ø¸ÙŠÙ': 'ØªÙ†Ø¸ÙŠÙ', 'ØºØ³ÙŠÙ„': 'ØºØ³ÙŠÙ„',
          'ØªØ³Ù„ÙŠÙƒ': 'ØªØ³Ù„ÙŠÙƒ', 'Ø´ÙØ·': 'Ø´ÙØ·', 'Ù…Ø¬Ø§Ø±ÙŠ': 'Ù…Ø¬Ø§Ø±ÙŠ'
        }
      },
      'Ù…ØµØ±': {
        transforms: {
          'Ø£Ø«Ø§Ø«': 'Ø¹ÙØ´', 'ØªØ±Ø­ÙŠÙ„': 'Ù†Ù‚Ù„', 'Ø´Ø­Ù†': 'Ø´Ø­Ù†', 'Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§': 'Ø£Ø«Ø§Ø«',
          'ØªÙ†Ø¸ÙŠÙ': 'ØªÙ†Ø¶ÙŠÙ', 'ØªØ¹Ù‚ÙŠÙ…': 'ØªØ·Ù‡ÙŠØ±', 'ØºØ³ÙŠÙ„': 'ØºØ³ÙŠÙ„',
          'ØªØ³Ù„ÙŠÙƒ': 'Ø´ÙØ·', 'Ø´ÙØ·': 'Ø´ÙØ·', 'Ù…Ø¬Ø§Ø±ÙŠ': 'Ù…Ø¬Ø§Ø±ÙŠ', 'Ø¨ÙŠØ§Ø±Ø§Øª': 'Ø¨ÙŠØ§Ø±Ø§Øª'
        }
      },
      'Ø§Ù„Ù…ØºØ±Ø¨': {
        transforms: {
          'Ø£Ø«Ø§Ø«': 'Ø£Ø«Ø§Ø«', 'Ø¹ÙØ´': 'Ø£Ø«Ø§Ø«', 'Ù†Ù‚Ù„': 'Ù†Ù‚Ù„', 'ØªØ±Ø­ÙŠÙ„': 'ØªØ±Ø­ÙŠÙ„',
          'ØªÙ†Ø¸ÙŠÙ': 'ØªÙ†Ø¸ÙŠÙ', 'ØºØ³ÙŠÙ„': 'ØºØ³ÙŠÙ„',
          'ØªØ³Ù„ÙŠÙƒ': 'ØªØ³Ù„ÙŠÙƒ', 'Ù…Ø¬Ø§Ø±ÙŠ': 'Ù…Ø¬Ø§Ø±ÙŠ'
        }
      }
    };

    // Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù‚Ø·Ø§Ø¹Ø§Øª
    const SECTORS = {
      'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«': {
        keywords: {
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±': ['Ø§Ø³Ø¹Ø§Ø± Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','ØªÙƒÙ„ÙØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ù†Ø²Ù„ÙŠ','Ø§ÙØ¶Ù„ Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','Ù†Ù‚Ù„ Ø¹ÙØ´ Ø§Ø±Ø®Øµ Ø§Ø³Ø¹Ø§Ø±','Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¶Ù…ÙˆÙ†Ø©','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ø¨Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ø³Ø¹Ø§Ø±'],
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ù„ÙŠ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ','Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø¹ÙØ´ Ù‚Ø±ÙŠØ¨Ø©','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙŠ','Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø­Ù„ÙŠØ©','Ù†Ù‚Ù„ Ø¹ÙØ´ Ø¨Ø§Ù„Ø­ÙŠ','Ø§ÙØ¶Ù„ Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ø¨Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©'],
          'Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±': ['Ø±Ù‚Ù… Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','Ø­Ø¬Ø² Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ø§Ù„ÙŠÙˆÙ…','Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø¹ÙØ´ ÙÙˆØ±ÙŠ','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ø¨Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯','Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« 24 Ø³Ø§Ø¹Ø©','Ø­Ø¬Ø² Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ© ÙˆØ§Ù„Ø¥Ø¶Ø§ÙÙŠØ©': ['ÙÙƒ ÙˆØªØ±ÙƒÙŠØ¨ Ø§Ø«Ø§Ø«','ØªØºÙ„ÙŠÙ Ø§Ø«Ø§Ø« Ø§Ø­ØªØ±Ø§ÙÙŠ','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¹ Ø§Ù„ØªØ£Ù…ÙŠÙ†','Ø±Ø§ÙØ¹Ø© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','ØªØ®Ø²ÙŠÙ† Ø§Ø«Ø§Ø« Ù…Ø¤Ù‚Øª','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…ÙƒØ§ØªØ¨'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©': ['Ø¹Ø±ÙˆØ¶ Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','Ø®ØµÙˆÙ…Ø§Øª Ù†Ù‚Ù„ Ø¹ÙØ´','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¬Ø§Ù†ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±','Ø§ÙƒØ¨Ø± Ø´Ø±ÙƒØ© Ù†Ù‚Ù„ Ø§Ø«Ø§Ø«','Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ø¶Ù…ÙˆÙ† 100%','ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù†Ù‚Ù„ Ø§Ø«Ø§Ø« Ù…Ù…ØªØ§Ø²Ø©']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù Ù†Ù‚Ù„','ØªÙˆØ¸ÙŠÙ Ø³Ø§Ø¦Ù‚ÙŠÙ†','Ù†Ù‚Ù„ Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ± Ø§Ø«Ø§Ø«','ØªØ¹Ù„ÙŠÙ… Ù†Ù‚Ù„','Ø¯ÙˆØ±Ø§Øª Ù†Ù‚Ù„','Ø§ÙŠÙƒÙŠØ§','Ù…Ø­Ù„Ø§Øª Ø§Ø«Ø§Ø«','Ø´Ø±Ø§Ø¡ Ø§Ø«Ø§Ø«','Ø¨ÙŠØ¹ Ø§Ø«Ø§Ø« Ù…Ø³ØªØ¹Ù…Ù„','Ø§Ø«Ø§Ø« Ù„Ù„Ø¨ÙŠØ¹']
      },
      'Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©': {
        keywords: {
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±': ['Ø§Ø³Ø¹Ø§Ø± Ø´Ø±ÙƒØ© ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„','ØªÙƒÙ„ÙØ© ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ø©','Ø§ÙØ¶Ù„ Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','Ø´Ø±ÙƒØ© ØªÙ†Ø¸ÙŠÙ Ø±Ø®ÙŠØµØ©','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ø¨Ø§Ù„Ø³Ø§Ø¹Ø©','Ø§Ø³Ø¹Ø§Ø± ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ù‚'],
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ù„ÙŠ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ù‚Ø±ÙŠØ¨','Ø´Ø±ÙƒØ© ØªÙ†Ø¸ÙŠÙ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙŠ','ØªÙ†Ø¸ÙŠÙ Ø´Ù‚Ù‚ Ù…Ø­Ù„ÙŠ','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© Ø¨Ø§Ù„Ø­ÙŠ','Ø§ÙØ¶Ù„ ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ø¨Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©'],
          'Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±': ['Ø±Ù‚Ù… Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','Ø­Ø¬Ø² ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø²Ù„ Ø§Ù„ÙŠÙˆÙ…','Ø·Ù„Ø¨ ØªÙ†Ø¸ÙŠÙ ÙÙˆØ±ÙŠ','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ© 24 Ø³Ø§Ø¹Ø©','Ø­Ø¬Ø² ØªÙ†Ø¸ÙŠÙ Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†','ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ Ø¨Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©': ['ØªÙ†Ø¸ÙŠÙ Ø³Ø¬Ø§Ø¯ ÙˆÙ…ÙˆÙƒÙŠØª','ØªÙ†Ø¸ÙŠÙ ÙƒÙ†Ø¨ ÙˆØ§Ù†ØªØ±ÙŠÙ‡Ø§Øª','ØªØ¹Ù‚ÙŠÙ… Ù…Ù†Ø§Ø²Ù„ ÙƒÙˆØ±ÙˆÙ†Ø§','ØºØ³ÙŠÙ„ Ø®Ø²Ø§Ù†Ø§Øª Ù…ÙŠØ§Ù‡','ØªÙ†Ø¸ÙŠÙ ÙˆØ§Ø¬Ù‡Ø§Øª Ø²Ø¬Ø§Ø¬','ØªÙ†Ø¸ÙŠÙ Ù…ÙƒÙŠÙØ§Øª'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©': ['Ø¹Ø±ÙˆØ¶ ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„','Ø®ØµÙˆÙ…Ø§Øª Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','ØªÙ†Ø¸ÙŠÙ Ù…Ø¬Ø§Ù†ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±','Ø§ÙƒØ¨Ø± Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','ØªÙ†Ø¸ÙŠÙ Ù…Ø¶Ù…ÙˆÙ† 100%','ØªÙ‚ÙŠÙŠÙ…Ø§Øª ØªÙ†Ø¸ÙŠÙ Ù…Ù…ØªØ§Ø²Ø©']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù ØªÙ†Ø¸ÙŠÙ','ØªÙˆØ¸ÙŠÙ Ø¹Ø§Ù…Ù„Ø§Øª','ØªÙ†Ø¸ÙŠÙ Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ± ØªÙ†Ø¸ÙŠÙ','ØªØ¹Ù„ÙŠÙ… ØªÙ†Ø¸ÙŠÙ','Ø¯ÙˆØ±Ø§Øª ØªÙ†Ø¸ÙŠÙ','Ø¹Ø§Ù…Ù„Ø§Øª Ù…Ù†Ø²Ù„ÙŠØ©','Ø®Ø§Ø¯Ù…Ø§Øª','Ù…Ù†Ø¸ÙØ§Øª Ù…Ù†Ø²Ù„ÙŠØ© Ù„Ù„Ø¨ÙŠØ¹','Ø§Ø¯ÙˆØ§Øª ØªÙ†Ø¸ÙŠÙ']
      },
      'Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ': {
        keywords: {
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±': ['Ø§Ø³Ø¹Ø§Ø± ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ','ØªÙƒÙ„ÙØ© Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª','Ø§ÙØ¶Ù„ Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø±Ø®ÙŠØµ','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª Ø¨Ø§Ù„Ø³Ø§Ø¹Ø©','Ø§Ø³Ø¹Ø§Ø± ØµØ±Ù ØµØ­ÙŠ'],
          'Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ù„ÙŠ ÙˆØ§Ù„Ù‚Ø±Ø¨': ['ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª Ù‚Ø±ÙŠØ¨','Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙŠ','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ù…Ø­Ù„ÙŠ','ØµØ±Ù ØµØ­ÙŠ Ø¨Ø§Ù„Ø­ÙŠ','Ø§ÙØ¶Ù„ ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø¨Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©'],
          'Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ ÙˆØ§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±': ['Ø±Ù‚Ù… ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø·ÙˆØ§Ø±Ø¦','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª 24 Ø³Ø§Ø¹Ø©','Ø·ÙˆØ§Ø±Ø¦ ØµØ±Ù ØµØ­ÙŠ','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ ÙÙˆØ±ÙŠ','ØµØ±Ù ØµØ­ÙŠ Ø¨Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯','Ø­Ø¬Ø² ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†'],
          'Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ®ØµØµØ©': ['ÙƒØ´Ù ØªØ³Ø±Ø¨Ø§Øª Ù…ÙŠØ§Ù‡','ØªÙ†Ø¸ÙŠÙ Ø¨ÙŠØ§Ø±Ø§Øª ÙˆØ®Ø²Ø§Ù†Ø§Øª','ØµÙŠØ§Ù†Ø© Ø´Ø¨ÙƒØ© ØµØ±Ù','ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ Ø¨Ø§Ù„Ø¶ØºØ·','Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª ØµØ­ÙŠØ©','ØªØ·Ù‡ÙŠØ± Ø®Ø²Ø§Ù†Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡'],
          'Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ù„ÙŠØ©': ['Ø¹Ø±ÙˆØ¶ ØªØ³Ù„ÙŠÙƒ Ù…Ø¬Ø§Ø±ÙŠ','Ø®ØµÙˆÙ…Ø§Øª Ø´ÙØ· Ø¨ÙŠØ§Ø±Ø§Øª','ØµØ±Ù ØµØ­ÙŠ Ù…Ø¬Ø§Ù†ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±','Ø§ÙƒØ¨Ø± Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ','ØªØ³Ù„ÙŠÙƒ Ù…Ø¶Ù…ÙˆÙ† 100%','ØªÙ‚ÙŠÙŠÙ…Ø§Øª ØµØ±Ù ØµØ­ÙŠ Ù…Ù…ØªØ§Ø²Ø©']
        },
        negatives: ['ÙˆØ¸Ø§Ø¦Ù ØµØ±Ù','ØªÙˆØ¸ÙŠÙ Ø¹Ù…Ø§Ù„','ØµØ±Ù Ù…Ø¬Ø§Ù†ÙŠ','ØµÙˆØ± ØµØ±Ù','ØªØ¹Ù„ÙŠÙ… Ø³Ø¨Ø§ÙƒØ©','Ø¯ÙˆØ±Ø§Øª ØµØ±Ù','Ø§Ø¯ÙˆØ§Øª Ø³Ø¨Ø§ÙƒØ©','Ù…Ø¹Ø¯Ø§Øª Ù„Ù„Ø¨ÙŠØ¹','Ù…Ù‚Ø§ÙˆÙ„ÙŠÙ† ÙÙ‚Ø·','Ø¹Ù…Ø§Ù„ Ø³Ø¨Ø§ÙƒØ©']
      }
    };

    const ALL_SECTORS_LIST = ['Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«','Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©','Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ','Ø¹ÙŠØ§Ø¯Ø© Ø£Ø³Ù†Ø§Ù†','Ù…Ø·Ø¹Ù…','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª','Ø¹Ù‚Ø§Ø±Ø§Øª','ØµØ§Ù„ÙˆÙ† Ø­Ù„Ø§Ù‚Ø©','ØµØ§Ù„ÙˆÙ† Ù†Ø³Ø§Ø¡','Ù…Ø±ÙƒØ² ØªØ¬Ù…ÙŠÙ„','Ù†Ø§Ø¯ÙŠ Ø±ÙŠØ§Ø¶ÙŠ','Ù…Ø¯Ø±Ø¨ Ø´Ø®ØµÙŠ','ÙˆÙƒØ§Ù„Ø© Ø³ÙØ±','ÙÙ†Ø¯Ù‚','Ø´Ø±ÙƒØ© Ø£Ù…Ù†','Ù…Ù‚Ø§ÙˆÙ„Ø§Øª','Ù…Ø¹Ù…Ø§Ø±','Ø¯Ù‡Ø§Ù†','ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¯Ø§Ø¦Ù‚','Ù…Ø´Ø§ØªÙ„','Ù…Ø¯Ø±Ø³Ø© Ø®Ø§ØµØ©','Ø¯ÙˆØ±Ø§Øª ØªØ¯Ø±ÙŠØ¨ÙŠØ©','ØªØ¹Ù„ÙŠÙ… Ù„ØºØ§Øª','Ø¬Ø§Ù…Ø¹Ø©','Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ','Ù…Ù„Ø§Ø¨Ø³','Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª','Ù…Ø¬ÙˆÙ‡Ø±Ø§Øª','Ø¹Ø·ÙˆØ±','ØµÙŠØ¯Ù„ÙŠØ©','Ù…Ø®ØªØ¨Ø± Ø·Ø¨ÙŠ','ÙƒØ§ÙÙŠÙ‡','Ø­Ù„ÙˆØ§Ù†ÙŠ','ØªÙˆØµÙŠÙ„ Ø·Ø¹Ø§Ù…','Ù…Ø¹Ø±Ø¶ Ø³ÙŠØ§Ø±Ø§Øª','ØµÙŠØ§Ù†Ø© Ø³ÙŠØ§Ø±Ø§Øª','ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±Ø§Øª','ÙƒØ§Ù…ÙŠØ±Ø§Øª Ù…Ø±Ø§Ù‚Ø¨Ø©','Ù…Ø­Ø§Ù…ÙŠ','Ù…Ø­Ø§Ø³Ø¨','Ø®Ø¯Ù…Ø§Øª Ù…ØµØ±ÙÙŠØ©','ØªØ£Ø¬ÙŠØ± Ø³ÙŠØ§Ø±Ø§Øª Ø³ÙŠØ§Ø­ÙŠ','Ù…Ø¹Ø¯Ø§Øª Ø±ÙŠØ§Ø¶ÙŠØ©'];
    const PLATFORMS = ['Google Ads','Facebook','Instagram','TikTok','Snapchat','YouTube','LinkedIn'];
    
    // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ù…ÙˆÙ…ÙŠØ©
    let AD_STRATEGIES = {};
    let currentCountry = '';
    let currentSector = '';
    
    // Ù‚Ø§Ø¹Ø¯Ø© Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    const DEFAULT_AD_STRATEGIES = {
      'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«': {
        'Google Ads': {type: 'Ø¨Ø­Ø« Ù…Ø­Ù„ÙŠ + Ø®Ø±Ø§Ø¦Ø·', reason: 'Ù†ÙŠØ© Ø¹Ø§Ù„ÙŠØ© + Ù…ÙƒØ§Ù„Ù…Ø§Øª Ù…Ø¨Ø§Ø´Ø±Ø©'},
        'Facebook': {type: 'Local Awareness + ØµÙˆØ± Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯', reason: 'Ø§Ù†ØªØ´Ø§Ø± Ù…Ø­Ù„ÙŠ + Ø¨Ù†Ø§Ø¡ Ø«Ù‚Ø©'},
        'Instagram': {type: 'Reels + Ù‚ØµØµ', reason: 'Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø¨ØµØ±ÙŠ Ù„Ù„Ø®Ø¯Ù…Ø©'},
        'YouTube': {type: 'In-Stream Ù‚ØµÙŠØ±', reason: 'Ø´Ø±Ø­ Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ù…ØµØ¯Ø§Ù‚ÙŠØ©'},
        'TikTok': {type: 'Short Video Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯', reason: 'ØªÙØ§Ø¹Ù„ Ø¹Ø§Ù„ÙŠ Ù…Ø¹ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨ØµØ±ÙŠ'},
        'Snapchat': {type: 'Geo Filters Ù…Ø­Ù„ÙŠ', reason: 'Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø¬ØºØ±Ø§ÙÙŠ Ø¯Ù‚ÙŠÙ‚'},
        'LinkedIn': {type: 'ØºÙŠØ± Ù…Ù‚ØªØ±Ø­ Ù„Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…Ø­Ù„ÙŠ', reason: 'Ù„Ø§ ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©'}
      },
      'Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©': {
        'Google Ads': {type: 'Ø¨Ø­Ø« Ù…Ø­Ù„ÙŠ + Ø®Ø±Ø§Ø¦Ø·', reason: 'Ø·Ù„Ø¨ ÙÙˆØ±ÙŠ + Ø§Ø­ØªÙŠØ§Ø¬ Ù…Ø­Ù„ÙŠ'},
        'Facebook': {type: 'Local Awareness + Carousel', reason: 'Ø¹Ø±Ø¶ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª'},
        'Instagram': {type: 'Reels + Ù‚ØµØµ Ù‚Ø¨Ù„ ÙˆØ¨Ø¹Ø¯', reason: 'ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù‚ÙˆÙŠ'},
        'YouTube': {type: 'In-Stream ØªÙˆØ¹ÙˆÙŠ', reason: 'Ø´Ø±Ø­ Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ù†Ø¸Ø§ÙØ©'},
        'TikTok': {type: 'Transformation Videos', reason: 'Ù…Ø­ØªÙˆÙ‰ ÙÙŠØ±Ø§Ù„ÙŠ Ù…Ø­ØªÙ…Ù„'},
        'Snapchat': {type: 'AR Filters + Geo', reason: 'ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø´Ø§Ø¨Ø©'},
        'LinkedIn': {type: 'Ù„Ù„Ø´Ø±ÙƒØ§Øª ÙÙ‚Ø· - Sponsored Content', reason: 'ØªÙ†Ø¸ÙŠÙ Ù…ÙƒØ§ØªØ¨ ÙˆØ´Ø±ÙƒØ§Øª'}
      },
      'Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ': {
        'Google Ads': {type: 'Ø¨Ø­Ø« Ø·ÙˆØ§Ø±Ø¦ + Ø®Ø±Ø§Ø¦Ø·', reason: 'Ø·Ù„Ø¨ Ø¹Ø§Ø¬Ù„ 24/7'},
        'Facebook': {type: 'Local Awareness', reason: 'Ø¨Ù†Ø§Ø¡ ÙˆØ¹ÙŠ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©'},
        'Instagram': {type: 'Ù‚ØµØµ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©', reason: 'ØªÙˆØ¹ÙŠØ© ÙˆØªØ«Ù‚ÙŠÙ'},
        'YouTube': {type: 'ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ù„ÙŠÙ…ÙŠ Ù‚ØµÙŠØ±', reason: 'Ø´Ø±Ø­ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ§Ù„Ø­Ù„ÙˆÙ„'},
        'TikTok': {type: 'Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ Ø®ÙÙŠÙ', reason: 'ØªÙˆØ¹ÙŠØ© Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ø´Ø§Ø¨'},
        'Snapchat': {type: 'Geo Filters Ø·ÙˆØ§Ø±Ø¦', reason: 'ÙˆØµÙˆÙ„ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©'},
        'LinkedIn': {type: 'ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨', reason: 'Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø®Ø¯Ù…Ø© Ù„Ø§ ØªÙ†Ø§Ø³Ø¨ Ø§Ù„Ù…Ù†ØµØ©'}
      }
    };
    
    function scrollToSection(id) {
      document.getElementById(id).scrollIntoView({behavior: 'smooth'});
      document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
      event.target.classList.add('active');
    }

    function applyDialect(text, country, dialectEnabled) {
      if(!dialectEnabled || !DIALECTS[country]) return text;
      let result = text;
      Object.entries(DIALECTS[country].transforms).forEach(([classical, dialect]) => {
        result = result.replace(new RegExp(classical, 'g'), dialect);
      });
      return result;
    }

    function setupSectorSearch(){
      const input = document.getElementById('sectorFree');
      const suggestions = document.getElementById('sectorSuggestions');
      
      input.addEventListener('input', (e) => {
        const value = e.target.value.toLowerCase();
        if(value.length < 2){
          suggestions.style.display = 'none';
          return;
        }
        
        const matches = ALL_SECTORS_LIST.filter(sector => 
          sector.toLowerCase().includes(value)
        );
        
        if(matches.length > 0){
          suggestions.innerHTML = '';
          matches.slice(0,8).forEach(sector => {
            const item = document.createElement('div');
            item.className = 'sector-item';
            item.textContent = sector;
            item.addEventListener('click', () => {
              input.value = sector;
              suggestions.style.display = 'none';
              updateAdStrategies(); // ØªØ­Ø¯ÙŠØ« Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
            });
            suggestions.appendChild(item);
          });
          suggestions.style.display = 'block';
        } else {
          suggestions.style.display = 'none';
        }
      });
      
      input.addEventListener('blur', updateAdStrategies);
      
      document.addEventListener('click', (e) => {
        if(!input.contains(e.target) && !suggestions.contains(e.target)){
          suggestions.style.display = 'none';
        }
      });
    }

    function detectSector(text){
      const normalized = text.toLowerCase();
      if(/Ù†Ù‚Ù„|Ø¹ÙØ´|Ø§Ø«Ø§Ø«|Ø´Ø­Ù†|ØªØ±Ø­ÙŠÙ„|Ù…ÙˆØ¨ÙŠÙ„ÙŠØ§/.test(normalized)) return 'Ù†Ù‚Ù„ Ø£Ø«Ø§Ø«';
      if(/Ù†Ø¸Ø§ÙØ©|ØªÙ†Ø¸ÙŠÙ|ØªØ¹Ù‚ÙŠÙ…|ØºØ³ÙŠÙ„/.test(normalized)) return 'Ø´Ø±ÙƒØ© Ù†Ø¸Ø§ÙØ©';
      if(/ØµØ±Ù|Ù…Ø¬Ø§Ø±ÙŠ|ØªØ³Ù„ÙŠÙƒ|Ø´ÙØ·|Ø¨ÙŠØ§Ø±/.test(normalized)) return 'Ø´Ø±ÙƒØ© ØµØ±Ù ØµØ­ÙŠ';
      return null;
    }

    function getAdStrategy(sector, platform) {
      const detectedSector = detectSector(sector) || sector;
      if(AD_STRATEGIES[detectedSector] && AD_STRATEGIES[detectedSector][platform]) {
        return AD_STRATEGIES[detectedSector][platform];
      }
      if(DEFAULT_AD_STRATEGIES[detectedSector] && DEFAULT_AD_STRATEGIES[detectedSector][platform]) {
        return DEFAULT_AD_STRATEGIES[detectedSector][platform];
      }
      // Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø¹Ø§Ù…Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØµØ©
      const generalStrategies = {
        'Google Ads': {type: 'Ø¨Ø­Ø« + Ø®Ø±Ø§Ø¦Ø·', reason: 'Ù†ÙŠØ© Ø¨Ø­Ø« Ø¹Ø§Ù„ÙŠØ©'},
        'Facebook': {type: 'Local Awareness', reason: 'Ø§Ù†ØªØ´Ø§Ø± Ù…Ø­Ù„ÙŠ'},
        'Instagram': {type: 'ØµÙˆØ± + Ù‚ØµØµ', reason: 'Ø¹Ø±Ø¶ Ø¨ØµØ±ÙŠ'},
        'YouTube': {type: 'ÙÙŠØ¯ÙŠÙˆ Ù‚ØµÙŠØ±', reason: 'Ø´Ø±Ø­ ÙˆØªÙˆØ¶ÙŠØ­'},
        'TikTok': {type: 'Ù…Ø­ØªÙˆÙ‰ Ù‚ØµÙŠØ±', reason: 'ØªÙØ§Ø¹Ù„ Ø³Ø±ÙŠØ¹'},
        'Snapchat': {type: 'Ù…Ø­ØªÙˆÙ‰ ØªÙØ§Ø¹Ù„ÙŠ', reason: 'Ø¬Ù…Ù‡ÙˆØ± Ø´Ø§Ø¨'},
        'LinkedIn': {type: 'Ù…Ø­ØªÙˆÙ‰ Ù…Ù‡Ù†ÙŠ', reason: 'Ù„Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©'}
      };
      return generalStrategies[platform] || {type: 'Ø¥Ø¹Ù„Ø§Ù† Ø¹Ø§Ù…', reason: 'Ø­Ø³Ø¨ Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ù…Ù†ØµØ©'};
    }

    function updateAdStrategies() {
      const sector = document.getElementById('sectorFree').value.trim();
      const strategiesDiv = document.getElementById('adStrategies');
      
      if(!sector) {
        strategiesDiv.innerHTML = '';
        return;
      }
      
      strategiesDiv.innerHTML = '<h3 style="color:#1e40af;margin:10px 0">ğŸ“‹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†ØµØ©:</h3>';
      
      PLATFORMS.forEach(platform => {
        const strategy = getAdStrategy(sector, platform);
        const div = document.createElement('div');
        div.className = 'platform-strategy';
        div.innerHTML = `<strong>${platform}:</strong> ${strategy.type} <em>(${strategy.reason})</em>`;
        strategiesDiv.appendChild(div);
      });
    }

    function generateKeywords(sectorText, expansionLevel, country, dialectEnabled) {
      const sector = detectSector(sectorText);
      if(sector && SECTORS[sector]) {
        let groups = {...SECTORS[sector].keywords};
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„Ù‡Ø¬Ø© Ø¥Ù† ÙƒØ§Ù†Øª Ù…ÙØ¹Ù„Ø©
        if(dialectEnabled && DIALECTS[country]) {
          Object.keys(groups).forEach(groupName => {
            groups[groupName] = groups[groupName].map(kw => 
              applyDialect(kw, country, true)
            );
          });
        }
        
        if(expansionLevel === 'aggressive') {
          const cities = ['Ø§Ù„Ø±ÙŠØ§Ø¶','Ø¬Ø¯Ø©','Ø§Ù„Ø¯Ù…Ø§Ù…','Ø§Ù„Ø®Ø¨Ø±','Ø¯Ø¨ÙŠ','Ø£Ø¨ÙˆØ¸Ø¨ÙŠ','Ø§Ù„ÙƒÙˆÙŠØª','Ø§Ù„Ø¯ÙˆØ­Ø©','Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©','Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©'];
          Object.keys(groups).forEach(groupName => {
            const cityVariants = [];
            groups[groupName].slice(0,2).forEach(kw => {
              cities.slice(0,4).forEach(city => cityVariants.push(`${kw} ÙÙŠ ${city}`));
            });
            if(cityVariants.length) groups[`${groupName} + Ù…Ø¯Ù† Ø±Ø¦ÙŠØ³ÙŠØ©`] = cityVariants;
          });
        }
        
        return groups;
      }
      
      const mainWord = sectorText.trim().split(' ').pop();
      const baseKeywords = {
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø¨Ø§Ø´Ø±`]: [`Ø§Ø³Ø¹Ø§Ø± ${mainWord}`,`ØªÙƒÙ„ÙØ© ${mainWord}`,`Ø§ÙØ¶Ù„ ${mainWord}`,`${mainWord} Ø±Ø®ÙŠØµ`,`${mainWord} Ù…Ø¶Ù…ÙˆÙ†`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…Ø­Ù„ÙŠ`]: [`${mainWord} Ù‚Ø±ÙŠØ¨ Ù…Ù†ÙŠ`,`${mainWord} ÙÙŠ Ù…Ù†Ø·Ù‚ØªÙŠ`,`${mainWord} Ù…Ø­Ù„ÙŠ`,`Ø§ÙØ¶Ù„ ${mainWord} Ø¨Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø§ØªØµØ§Ù„`]: [`Ø±Ù‚Ù… ${mainWord}`,`Ø­Ø¬Ø² ${mainWord}`,`Ø·Ù„Ø¨ ${mainWord}`,`${mainWord} Ø¨Ø±Ù‚Ù… ÙˆØ§Ø­Ø¯`,`${mainWord} Ø§ÙˆÙ†Ù„Ø§ÙŠÙ†`],
        [`ÙƒÙ„Ù…Ø§Øª ${mainWord} - Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶`]: [`Ø®Ø¯Ù…Ø§Øª ${mainWord}`,`Ø¹Ø±ÙˆØ¶ ${mainWord}`,`${mainWord} 24 Ø³Ø§Ø¹Ø©`,`${mainWord} Ù…Ø¬Ø§Ù†ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±`]
      };
      
      // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„Ù‡Ø¬Ø© Ù„Ù„Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©
      if(dialectEnabled && DIALECTS[country]) {
        Object.keys(baseKeywords).forEach(groupName => {
          baseKeywords[groupName] = baseKeywords[groupName].map(kw => 
            applyDialect(kw, country, true)
          );
        });
      }
      
      return baseKeywords;
    }

    function getSectorNegatives(sectorText){
      const sector = detectSector(sectorText);
      if(sector && SECTORS[sector] && SECTORS[sector].negatives){
        return SECTORS[sector].negatives;
      }
      return ['ÙˆØ¸Ø§Ø¦Ù','ØªÙˆØ¸ÙŠÙ','Ù…Ø¬Ø§Ù†ÙŠ','ØªØ¹Ù„ÙŠÙ…','Ø¯ÙˆØ±Ø§Øª','ØµÙˆØ±','ÙÙŠØ¯ÙŠÙˆ','Ù…Ø¹Ù„ÙˆÙ…Ø§Øª'];
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ù† Ù…Ù„Ù JSON
    async function loadAdStrategies() {
      try {
        const response = await fetch('../data/ad-strategy.json?t=' + Date.now());
        if(response.ok) {
          AD_STRATEGIES = await response.json();
          console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
        }
      } catch(error) {
        console.warn('Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©:', error);
        AD_STRATEGIES = DEFAULT_AD_STRATEGIES;
      }
    }

    // Ø¹Ø±Ø¶ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
    async function updateLastUpdateInfo() {
      try {
        const response = await fetch('https://api.github.com/repos/sherow1982/arabic-ads-calculator-tools/commits/main');
        if(response.ok) {
          const data = await response.json();
          const date = new Date(data.commit.author.date);
          document.getElementById('lastUpdateDate').textContent = 
            date.toLocaleDateString('ar-SA') + ' - ' + date.toLocaleTimeString('ar-SA', {hour: '2-digit', minute: '2-digit'});
        }
      } catch(error) {
        document.getElementById('lastUpdateDate').textContent = 'ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹';
      }
    }

    function fmt(n) { return new Intl.NumberFormat('ar-EG').format(Math.round(n||0)); }
    function timestamp() { return new Date().toISOString().slice(0,16).replace('T','-').replace(/:/g,''); }

    document.addEventListener('DOMContentLoaded', async ()=>{
      await loadAdStrategies();
      updateLastUpdateInfo();
      setupSectorSearch();
      
      const toggles = document.getElementById('platformToggles');
      PLATFORMS.forEach(p=>{
        const id = 'pl_' + p.replace(/\s+/g,'_');
        const wrapper = document.createElement('div');
        wrapper.style.position = 'relative';
        
        const input = document.createElement('input');
        input.type = 'checkbox';
        input.id = id;
        input.style.display = 'none';
        
        const label = document.createElement('label');
        label.setAttribute('for', id);
        label.innerHTML = `${p}`;
        
        wrapper.appendChild(input);
        wrapper.appendChild(label);
        toggles.appendChild(wrapper);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù†ØµØ§Øª
        input.addEventListener('change', updateAdStrategies);
      });

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ù‡Ø¬Ø§Øª
      document.getElementById('country').addEventListener('change', (e) => {
        const country = e.target.value;
        currentCountry = country;
        const dialectSelect = document.getElementById('dialect');
        const dialectInfo = document.getElementById('dialectInfo');
        const suggestions = document.getElementById('platformSuggestions');
        
        if(country) {
          dialectSelect.disabled = false;
          dialectSelect.innerHTML = `
            <option value="classical">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰</option>
            <option value="local">Ù„Ù‡Ø¬Ø© ${country}</option>
          `;
          dialectInfo.style.display = 'block';
          
          if(BENCHMARKS[country]) {
            suggestions.style.display = 'block';
            
            document.getElementById('selectRecommended').onclick = () => {
              PLATFORMS.forEach(p => document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked = false);
              BENCHMARKS[country].recommended.forEach(p => {
                const checkbox = document.getElementById('pl_'+p.replace(/\s+/g,'_'));
                if(checkbox) checkbox.checked = true;
              });
              updateAdStrategies();
            };
            
            document.getElementById('selectTop2').onclick = () => {
              PLATFORMS.forEach(p => document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked = false);
              BENCHMARKS[country].recommended.slice(0,2).forEach(p => {
                const checkbox = document.getElementById('pl_'+p.replace(/\s+/g,'_'));
                if(checkbox) checkbox.checked = true;
              });
              updateAdStrategies();
            };
            
            document.getElementById('selectAll').onclick = () => {
              BENCHMARKS[country].recommended.forEach(p => {
                const checkbox = document.getElementById('pl_'+p.replace(/\s+/g,'_'));
                if(checkbox) checkbox.checked = true;
              });
              updateAdStrategies();
            };
            
            document.getElementById('clearAll').onclick = () => {
              PLATFORMS.forEach(p => document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked = false);
              updateAdStrategies();
            };
          }
        } else {
          dialectSelect.disabled = true;
          dialectSelect.innerHTML = '<option value="classical">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰</option>';
          dialectInfo.style.display = 'none';
          suggestions.style.display = 'none';
        }
        updateAdStrategies();
      });

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¬Ø§Ù„
      document.getElementById('sectorFree').addEventListener('input', () => {
        currentSector = document.getElementById('sectorFree').value.trim();
        updateAdStrategies();
      });

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
      document.getElementById('advancedToggle').addEventListener('click', () => {
        const settings = document.getElementById('advancedSettings');
        const icon = document.getElementById('advancedIcon');
        if(settings.style.display === 'none') {
          settings.style.display = 'block';
          icon.textContent = 'â–²';
        } else {
          settings.style.display = 'none';
          icon.textContent = 'â–¼';
        }
      });

      // Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      document.getElementById('refreshData').addEventListener('click', async () => {
        document.getElementById('refreshData').textContent = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...';
        await loadAdStrategies();
        await updateLastUpdateInfo();
        updateAdStrategies();
        document.getElementById('refreshData').textContent = 'ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†';
        alert('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
      });

      document.getElementById('run').addEventListener('click', ()=>{
        const country = document.getElementById('country').value;
        const dialect = document.getElementById('dialect').value;
        const sector = document.getElementById('sectorFree').value.trim();
        const budget = parseFloat(document.getElementById('budget').value) || 0;
        const matchType = document.getElementById('matchType').value;
        const includeNegatives = document.getElementById('includeNegatives').checked;
        const expansionLevel = document.getElementById('expansionLevel').value;
        const exportInDialect = document.getElementById('exportInDialect').checked;
        
        if(!country || !sector) {
          alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø© ÙˆØ§ÙƒØªØ¨ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„');
          return;
        }
        
        if(!budget || budget <= 0) {
          alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø¯Ø®Ù„ Ù…ÙŠØ²Ø§Ù†ÙŠØ© ØµØ§Ù„Ø­Ø© Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±');
          return;
        }
        
        const activePlatforms = PLATFORMS.filter(p => 
          document.getElementById('pl_'+p.replace(/\s+/g,'_')).checked);
        
        if(activePlatforms.length === 0) {
          alert('Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ù…Ù†ØµØ© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
          return;
        }
        
        const countryData = BENCHMARKS[country] || {currency:'SAR', cpm:{}};
        const dialectEnabled = dialect === 'local';
        const keywordGroups = generateKeywords(sector, expansionLevel, country, dialectEnabled);
        
        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„Ù…Ø§Øª
        const kwEl = document.getElementById('keywordsContent');
        kwEl.innerHTML = '';
        let allKeywords = [];
        let exportKeywords = []; // Ù„Ù„ØªØµØ¯ÙŠØ± (Ù‚Ø¯ ØªÙƒÙˆÙ† Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù„Ù‡Ø¬Ø©)
        
        Object.entries(keywordGroups).forEach(([groupName, keywords]) => {
          const groupDiv = document.createElement('div');
          groupDiv.className = 'intent-group';
          groupDiv.innerHTML = `<div class="intent-title">${groupName} (${keywords.length} ÙƒÙ„Ù…Ø©)</div>`;
          
          const chipsDiv = document.createElement('div');
          chipsDiv.className = 'chips';
          
          keywords.forEach((k, i) => {
            const span = document.createElement('span');
            span.textContent = k;
            
            if(matchType === 'mixed') {
              if(i % 5 < 3) span.className = 'pill pill-phrase';
              else if(i % 5 === 3) span.className = 'pill pill-broad';
              else span.className = 'pill pill-exact';
            } else {
              span.className = matchType === 'broad' ? 'pill pill-broad' : 
                             matchType === 'phrase' ? 'pill pill-phrase' : 'pill pill-exact';
            }
            
            chipsDiv.appendChild(span);
            allKeywords.push(k);
            
            // Ù„Ù„ØªØµØ¯ÙŠØ±: Ø¥Ù…Ø§ Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø£Ùˆ Ø¨Ø§Ù„ÙØµØ­Ù‰
            if(exportInDialect) {
              exportKeywords.push(k);
            } else {
              // Ø¥Ø±Ø¬Ø§Ø¹ Ù„Ù„ÙØµØ­Ù‰ Ù„Ù„ØªØµØ¯ÙŠØ±
              const classicalKeyword = dialectEnabled && DIALECTS[country] ? 
                Object.entries(DIALECTS[country].transforms).reduce((acc, [classical, dialectWord]) => 
                  acc.replace(new RegExp(dialectWord, 'g'), classical), k) : k;
              exportKeywords.push(classicalKeyword);
            }
          });
          
          groupDiv.appendChild(chipsDiv);
          kwEl.appendChild(groupDiv);
        });

        document.getElementById('keywordStats').textContent = 
          `ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${allKeywords.length} ÙƒÙ„Ù…Ø© ÙÙŠ ${Object.keys(keywordGroups).length} Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù†ÙŠØ© ${dialectEnabled ? '(Ù„Ù‡Ø¬Ø© '+country+')' : '(ÙØµØ­Ù‰)'}`;

        // Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©
        let negativeKeywords = [];
        if(includeNegatives) {
          negativeKeywords = getSectorNegatives(sector);
          document.getElementById('negatives').style.display = 'block';
          const negEl = document.getElementById('negativeKeywords');
          negEl.innerHTML = '';
          negativeKeywords.forEach(k => {
            const span = document.createElement('span');
            span.className = 'pill pill-negative';
            span.textContent = `-${k}`;
            negEl.appendChild(span);
          });
        }

        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„ØªØµØ¯ÙŠØ±
        document.getElementById('copyAll').onclick = () => {
          const keywordsToCopy = exportInDialect ? allKeywords : exportKeywords;
          navigator.clipboard.writeText(keywordsToCopy.join('\n')).then(() => 
            alert(`ØªÙ… Ù†Ø³Ø® ${keywordsToCopy.length} ÙƒÙ„Ù…Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù‚ØªØ¨Ø§Ø³ ${exportInDialect && dialectEnabled ? '(Ù„Ù‡Ø¬Ø© '+country+')' : '(ÙØµØ­Ù‰)'}`));
        };
        
        document.getElementById('copyNegatives').onclick = () => {
          if(negativeKeywords.length) {
            navigator.clipboard.writeText(negativeKeywords.map(k => `-${k}`).join('\n')).then(() => 
              alert(`ØªÙ… Ù†Ø³Ø® ${negativeKeywords.length} ÙƒÙ„Ù…Ø© Ø³Ù„Ø¨ÙŠØ©`));
          }
        };
        
        document.getElementById('exportXlsx').onclick = () => {
          if(!window.XLSX || typeof XLSX.writeFile !== 'function') { 
            alert('Ù…ÙƒØªØ¨Ø© XLSX ØºÙŠØ± Ù…Ø­Ù…Ù„Ø© - Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ CSV Ø¨Ø¯ÙŠÙ„...');
            document.getElementById('exportGoogleAds').click();
            return; 
          }
          
          try {
            const wb = XLSX.utils.book_new();
            const now = new Date();
            
            // Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø©
            const summaryData = [
              ['Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©', ''],
              ['', ''],
              ['Ø§Ù„Ø¯ÙˆÙ„Ø©', country],
              ['Ø§Ù„Ù„Ù‡Ø¬Ø©', dialect === 'local' ? `Ù„Ù‡Ø¬Ø© ${country}` : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰'],
              ['Ø§Ù„Ø¹Ù…Ù„Ø©', countryData.currency],
              ['Ø§Ù„Ù…Ø¬Ø§Ù„', sector],
              ['Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©', `${budget} ${countryData.currency}`],
              ['Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©', matchType === 'mixed' ? 'Ù…Ø²ÙŠØ¬' : matchType === 'phrase' ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø¨Ø§Ø±Ø©' : matchType === 'broad' ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø©' : 'Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©'],
              ['Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³Ø¹', expansionLevel === 'moderate' ? 'Ù…ØªÙˆØ³Ø·' : expansionLevel === 'conservative' ? 'Ù…Ø­Ø§ÙØ¸' : 'ØªÙˆØ³Ø¹ÙŠ'],
              ['Ø§Ù„Ù…Ù†ØµØ§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©', activePlatforms.join(', ')],
              ['ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡', now.toLocaleDateString('ar-SA')],
              ['ÙˆÙ‚Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡', now.toLocaleTimeString('ar-SA')],
              ['', ''],
              ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª', allKeywords.length],
              ['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ø¨ÙŠØ©', negativeKeywords.length],
              ['Ù„ØºØ© Ø§Ù„ØªØµØ¯ÙŠØ±', exportInDialect && dialectEnabled ? `Ù„Ù‡Ø¬Ø© ${country}` : 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙØµØ­Ù‰'],
              ['', '']
            ];
            
            const wsSummary = XLSX.utils.aoa_to_sheet(summaryData);
            XLSX.utils.book_append_sheet(wb, wsSummary, 'Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø©');
            
            // Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            const keywordsForExport = exportInDialect ? allKeywords : exportKeywords;
            const keywordRows = [['Ø§Ù„ÙƒÙ„Ù…Ø©','Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©','Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù†ÙŠØ©','Ù…Ù„Ø§Ø­Ø¸Ø©']];
            let keywordIndex = 0;
            Object.entries(keywordGroups).forEach(([group, keywords]) => {
              keywords.forEach(() => {
                const k = keywordsForExport[keywordIndex];
                const matchText = matchType === 'mixed' ? 'Ù…Ø²ÙŠØ¬' :
                                 matchType === 'phrase' ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¹Ø¨Ø§Ø±Ø©' :
                                 matchType === 'broad' ? 'Ù…Ø·Ø§Ø¨Ù‚Ø© ÙˆØ§Ø³Ø¹Ø©' : 'Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©';
                keywordRows.push([k, matchText, group, '']);
                keywordIndex++;
              });
            });
            const wsKeywords = XLSX.utils.aoa_to_sheet(keywordRows);
            XLSX.utils.book_append_sheet(wb, wsKeywords, 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
            
            // Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©
            if(negativeKeywords.length) {
              const negRows = [['Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ù„Ø¨ÙŠØ©','Ø§Ù„Ø³Ø¨Ø¨']];
              negativeKeywords.forEach(k => negRows.push([k, 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø¯Ø±']));
              const wsNegatives = XLSX.utils.aoa_to_sheet(negRows);
              XLSX.utils.book_append_sheet(wb, wsNegatives, 'Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø³Ù„Ø¨ÙŠØ©');
            }
            
            // Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©: Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©
            const budgetPerPlatform = budget / activePlatforms.length;
            const planRows = [['Ø§Ù„Ù…Ù†ØµØ©','Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©','CPM Ø§Ù„Ù…ØªÙˆÙ‚Ø¹','Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹','Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©']];
            
            activePlatforms.forEach(p => {
              const cpm = countryData.cpm[p] || 2;
              const impressions = (budgetPerPlatform/cpm)*1000; // ØªÙ… Ø¥ØµÙ„Ø§Ø­ cmp Ø¥Ù„Ù‰ cpm
              const clicks = impressions*0.015;
              planRows.push([p, `${Math.round(budgetPerPlatform)} ${countryData.currency}`, `$${cpm.toFixed(2)}`, Math.round(impressions), Math.round(clicks)]);
            });
            
            const wsPlan = XLSX.utils.aoa_to_sheet(planRows);
            XLSX.utils.book_append_sheet(wb, wsPlan, 'Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©');
            
            // Ø§Ù„ÙˆØ±Ù‚Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø©: Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
            const strategyRows = [['Ø§Ù„Ù…Ù†ØµØ©','Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ù‚ØªØ±Ø­','Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±','Ù…Ù„Ø§Ø­Ø¸Ø©']];
            activePlatforms.forEach(p => {
              const strategy = getAdStrategy(sector, p);
              strategyRows.push([p, strategy.type, strategy.reason, '']);
            });
            const wsStrategy = XLSX.utils.aoa_to_sheet(strategyRows);
            XLSX.utils.book_append_sheet(wb, wsStrategy, 'Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª');
            
            const fileName = `${sector.replace(/\s+/g,'-')}-${country}-${timestamp()}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            alert('âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù XLSX Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ 5 Ø£ÙˆØ±Ø§Ù‚: Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ù…Ù„Ø© + Ø§Ù„ÙƒÙ„Ù…Ø§Øª + Ø§Ù„Ø³Ù„Ø¨ÙŠØ© + Ø§Ù„Ø®Ø·Ø© + Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©!');
          } catch(error) {
            console.error('Ø®Ø·Ø£ XLSX:', error);
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± XLSX - Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ CSV Ø¨Ø¯ÙŠÙ„...');
            document.getElementById('exportGoogleAds').click();
          }
        };
        
        document.getElementById('exportGoogleAds').onclick = () => {
          const keywordsForExport = exportInDialect ? allKeywords : exportKeywords;
          const csvRows = ['Campaign,Ad Group,Keyword,Match Type'];
          let keywordIndex = 0;
          Object.entries(keywordGroups).forEach(([group, keywords]) => {
            keywords.forEach(() => {
              const k = keywordsForExport[keywordIndex];
              const matchText = matchType === 'mixed' ? 'Phrase' :
                               matchType === 'phrase' ? 'Phrase' :
                               matchType === 'broad' ? 'Broad' : 'Exact';
              csvRows.push(`${sector} Campaign,${group},${k},${matchText}`);
              keywordIndex++;
            });
          });
          
          const csvContent = '\ufeff' + csvRows.join('\n');
          const blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'});
          const link = document.createElement('a');
          link.href = URL.createObjectURL(blob);
          link.download = `${sector.replace(/\s+/g,'-')}-${country}-${timestamp()}.csv`;
          link.click();
          URL.revokeObjectURL(link.href);
          
          alert('âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù CSV Ø¨Ù†Ø¬Ø§Ø­!');
        };

        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØ²ÙŠØ¹ ÙˆØ§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
        const allocEl = document.getElementById('allocation');
        allocEl.innerHTML = '';
        const budgetPerPlatform = budget / activePlatforms.length;
        activePlatforms.forEach(p=>{
          const d = document.createElement('div');
          d.innerHTML = `<b>${p}</b><br>${fmt(budgetPerPlatform)} ${countryData.currency}`;
          allocEl.appendChild(d);
        });

        const fEl = document.getElementById('forecastsContent');
        fEl.innerHTML = '';
        let totals = {impressions:0,clicks:0,conversions:0,sales:0};
        
        activePlatforms.forEach(p=>{
          const cpm = countryData.cpm[p] || 2;
          const impressions = (budgetPerPlatform/cpm)*1000; // ØªÙ… Ø¥ØµÙ„Ø§Ø­ cmp Ø¥Ù„Ù‰ cpm
          const clicks = impressions*0.015;
          const conversions = clicks*0.025;
          const sales = conversions*0.75;
          
          totals.impressions += impressions;
          totals.clicks += clicks;
          totals.conversions += conversions;
          totals.sales += sales;
          
          const div = document.createElement('div');
          div.innerHTML = `<b>${p}</b><br>CPM $${cpm.toFixed(2)}<br>Ø¸Ù‡ÙˆØ± ${fmt(impressions)} | Ù†Ù‚Ø±Ø§Øª ${fmt(clicks)} | ØªØ­ÙˆÙŠÙ„Ø§Øª ${fmt(conversions)}`;
          fEl.appendChild(div);
        });

        const totalDiv = document.createElement('div');
        totalDiv.innerHTML = `<b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</b><br>Ø¸Ù‡ÙˆØ± ${fmt(totals.impressions)} | Ù†Ù‚Ø±Ø§Øª ${fmt(totals.clicks)} | ØªØ­ÙˆÙŠÙ„Ø§Øª ${fmt(totals.conversions)} | Ù…Ø¨ÙŠØ¹Ø§Øª ${fmt(totals.sales)}`;
        totalDiv.style.background = '#eff6ff';
        totalDiv.style.borderColor = '#3b82f6';
        totalDiv.style.fontWeight = '700';
        fEl.appendChild(totalDiv);

        document.getElementById('out').style.display = 'block';
        document.getElementById('successMsg').style.display = 'block';
        setTimeout(() => document.getElementById('successMsg').style.display = 'none', 8000);
        
        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù‚Ø³Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª
        setTimeout(() => scrollToSection('keywords'), 1200);
      });
    });
  </script>
</body>
</html>