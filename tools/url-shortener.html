<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ - ØªÙ‚ØµÙŠØ± + ØªØ¬Ù…ÙŠÙ„ + Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠ</title>
    <meta name="description" content="Ù…Ø®ØªØµØ± Ø±ÙˆØ§Ø¨Ø· Ø¹Ø§Ù„Ù…ÙŠ Ø´Ø§Ù…Ù„ - ÙŠÙ‚ØµØ± ÙˆÙŠØ¬Ù…Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† + ÙŠÙ†Ø´Ø± Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ù‚ÙˆÙŠØ© Ø¹Ù„Ù‰ 25 Ù…ÙˆÙ‚Ø¹ DA Ø¹Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - ÙŠØ¯Ø¹Ù… Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ - Ø¬Ø§Ù‡Ø² Ù„Ù„ÙÙ‡Ø±Ø³Ø© ÙˆØ§Ù„Ù†Ø´Ø±">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Noto+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --primary-color: #2563eb; --success-color: #16a34a; --warning-color: #ea580c;
            --danger-color: #dc2626; --info-color: #0ea5e9; --dark-color: #1f2937;
            --light-bg: #f8fafc; --border-radius: 12px; --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Cairo', 'Noto Sans Arabic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh; padding: 20px 0;
        }
        
        body[dir="ltr"] { font-family: 'Inter', 'Roboto', sans-serif; }
        
        .main-container {
            background: white; border-radius: var(--border-radius);
            box-shadow: var(--shadow); overflow: hidden; max-width: 1200px; margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #1d4ed8 100%);
            color: white; padding: 2.5rem; text-align: center;
        }
        
        .header h1 { font-size: 2.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .header p { opacity: 0.9; margin: 0; }
        
        .content { padding: 2rem; }
        
        .language-toggle {
            position: absolute; top: 20px; right: 20px; z-index: 1000;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        .mode-tabs {
            display: flex; justify-content: center; gap: 1rem;
            margin: 2rem 0; flex-wrap: wrap;
        }
        
        .mode-tab {
            padding: 1rem 2rem; border-radius: 25px; background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3); color: white; cursor: pointer;
            transition: all 0.3s ease; font-weight: 600; font-size: 1rem;
        }
        
        .mode-tab.active {
            background: rgba(255,255,255,0.25); border-color: rgba(255,255,255,0.6);
            transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .processing-section {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 16px; padding: 2rem; margin: 2rem 0;
            text-align: center; display: none;
        }
        
        .spinner {
            width: 40px; height: 40px; margin: 0 auto 1rem;
            border: 4px solid #e2e8f0; border-top: 4px solid var(--primary-color);
            border-radius: 50%; animation: spin 1s linear infinite;
        }
        
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .form-control {
            border-radius: var(--border-radius); border: 2px solid #e2e8f0;
            padding: 0.75rem; transition: all 0.3s ease; font-family: inherit;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
        }
        
        .btn {
            border-radius: var(--border-radius); padding: 0.75rem 1.5rem;
            font-weight: 600; transition: all 0.3s ease; border: none;
        }
        
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: #1d4ed8; transform: translateY(-2px); }
        .btn-success { background: var(--success-color); color: white; }
        .btn-warning { background: var(--warning-color); color: white; }
        .btn-info { background: var(--info-color); color: white; }
        .btn-danger { background: var(--danger-color); color: white; }
        
        .stats-card {
            background: var(--light-bg); border-radius: var(--border-radius);
            padding: 1.5rem; text-align: center; border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover { transform: translateY(-4px); box-shadow: var(--shadow); }
        .stats-number { font-size: 2rem; font-weight: 700; color: var(--primary-color); }
        
        .results-table {
            border-radius: var(--border-radius); overflow: hidden;
            border: 2px solid #e2e8f0;
        }
        
        .results-table th {
            background: var(--primary-color); color: white; font-weight: 600; border: none;
        }
        
        .results-table td { vertical-align: middle; border-color: #e2e8f0; }
        
        .url-cell {
            max-width: 300px; word-break: break-all; font-size: 0.9rem;
            font-family: monospace; background: #f1f5f9; padding: 0.5rem;
            border-radius: 6px;
        }
        
        .status-badge {
            border-radius: 50px; padding: 0.25rem 0.75rem;
            font-size: 0.8rem; font-weight: 600;
        }
        
        .loading-spinner { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #results-section { display: none; }
        .copy-btn { font-size: 0.8rem; padding: 0.25rem 0.5rem; }
        
        .global-features {
            background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%);
            color: white; padding: 2rem; border-radius: var(--border-radius);
            margin: 2rem 0; text-align: center;
        }
        
        .feature-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem; margin: 1.5rem 0;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.2); padding: 1rem;
            border-radius: 12px; text-align: center;
        }
        
        .feature-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .feature-text { font-size: 0.9rem; opacity: 0.9; }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem; border-radius: var(--border-radius);
            margin: 1rem 0;
        }
        
        .demo-url {
            font-family: monospace; background: rgba(0, 0, 0, 0.2);
            padding: 0.5rem; border-radius: 8px; margin: 0.3rem 0;
            font-size: 0.85rem; word-break: break-all;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© */
        .success-banner {
            background: linear-gradient(135deg, #16a34a, #15803d);
            color: white; padding: 1.5rem; border-radius: 16px;
            text-align: center; margin: 1rem 0; display: none;
        }
        
        .url-result-item {
            background: white; border-radius: 12px; padding: 1rem;
            margin: 0.5rem 0; border: 1px solid #e5e7eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .result-type-badge {
            font-size: 0.7rem; padding: 0.2rem 0.5rem;
            border-radius: 12px; margin-right: 0.5rem;
        }

        /* Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ Ø²Ø± Ù…Ù…ÙŠØ² */
        .btn-backlink {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            color: white; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.5px; box-shadow: 0 8px 25px rgba(220, 38, 38, 0.3);
        }
        .btn-backlink:hover {
            background: linear-gradient(135deg, #b91c1c, #991b1b);
            transform: translateY(-3px); box-shadow: 0 12px 35px rgba(220, 38, 38, 0.4);
        }

        /* Ù…Ø­Ø³Ù† Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ */
        .backlink-progress {
            background: #fef3c7; border-left: 4px solid #f59e0b;
            padding: 1rem; border-radius: 8px; margin: 1rem 0;
            display: none;
        }
        .backlink-site {
            display: flex; justify-content: space-between;
            padding: 0.5rem 0; border-bottom: 1px solid #e5e7eb;
        }
        .backlink-site:last-child { border-bottom: none; }
    </style>
</head>
<body>
    <!-- Language Toggle -->
    <div class="language-toggle">
        <button class="btn btn-outline-light btn-sm" onclick="toggleLanguage()" id="langToggle">
            <i class="fas fa-globe"></i> EN
        </button>
    </div>

    <div class="container">
        <div class="main-container">
            <!-- Header -->
            <div class="header">
                <h1 id="mainTitle">ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h1>
                <p id="mainSubtitle">ØªÙ‚ØµÙŠØ± + ØªØ¬Ù…ÙŠÙ„ + Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠ | ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª ÙˆØ§Ù„Ø±Ù…ÙˆØ² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙˆØ¶Ø¹ -->
                <div class="mode-tabs">
                    <div class="mode-tab active" data-mode="shorten">
                        <i class="fas fa-scissors me-2"></i>
                        <span id="modeShorten">ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</span>
                    </div>
                    <div class="mode-tab" data-mode="beautify">
                        <i class="fas fa-magic me-2"></i>
                        <span id="modeBeautify">ØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</span>
                    </div>
                    <div class="mode-tab" data-mode="both">
                        <i class="fas fa-star me-2"></i>
                        <span id="modeBoth">Ø§Ù„ØªÙ‚ØµÙŠØ± + Ø§Ù„ØªØ¬Ù…ÙŠÙ„ Ù…Ø¹Ø§Ù‹</span>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Global Features -->
                <div class="global-features">
                    <h4 id="featuresTitle">ğŸ† Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h4>
                    
                    <div class="feature-grid">
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‡ºğŸ‡¸</div>
                            <div class="feature-text" id="feature1">English URLs<br>Ø±ÙˆØ§Ø¨Ø· Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‡ªğŸ‡¬</div>
                            <div class="feature-text" id="feature2">Ø¹Ø±Ø¨ÙŠ Arabic<br>Ø±ÙˆØ§Ø¨Ø· Ø¹Ø±Ø¨ÙŠØ©</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸš€</div>
                            <div class="feature-text" id="feature3">Ø±Ù…ÙˆØ² Symbols<br>#@$%&*</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‰</div>
                            <div class="feature-text" id="feature4">Emoji Ø¥ÙŠÙ…ÙˆØ¬ÙŠ<br>ğŸ˜ğŸš€ğŸ‰ğŸ“±</div>
                        </div>
                    </div>
                    
                    <p id="featuresNote" style="opacity: 0.9; font-size: 0.95rem;">
                        âœ¨ Ù†Ø¸Ø§Ù… ØªØ±Ù…ÙŠØ² Ø°ÙƒÙŠ + ØªØ¬Ù…ÙŠÙ„ Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† + Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠ - ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø±Ù…ÙˆØ² ÙˆÙŠÙ†Ø´Ø±Ù‡Ø§ ÙÙˆØ±Ø§Ù‹
                    </p>
                </div>

                <!-- Demo Section -->
                <div class="demo-section">
                    <h5 id="demoTitle">ğŸ“ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø±ÙˆØ§Ø¨Ø·Ùƒ (Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø³Ø®)</h5>
                    <p id="demoNote">Ø§Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙˆØ±Ø§Ù‹:</p>
                    
                    <div id="demoUrls">
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©</div>
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=Ø¹Ø±Ø¨Ø©-Ù…ØªÙ†Ù‚Ù„Ø©-Ù‚Ø§Ø¨Ù„Ø©-Ù„Ù„Ø·ÙŠ-Ø¨ØºØ·Ø§Ø¡-Ùˆ-Ø¹Ø¬Ù„Ø§Øª</div>
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=Ø¢Ù„Ø©-Ø¥Ø²Ø§Ù„Ø©-Ø§Ù„Ø´Ø¹Ø±-Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©-usb</div>
                        <div class="demo-url">https://mystore.com/products/special-offer?utm_source=facebook&utm_campaign=2024</div>
                        <div class="demo-url">https://example.com/ğŸš€âœ¨ğŸ‰-emoji-powered-url</div>
                    </div>
                    
                    <button class="btn btn-info btn-sm" onclick="copyDemoUrls()" id="copyDemoBtn">
                        ğŸ“‹ <span id="copyDemoBtnText">Ù†Ø³Ø® Ø§Ù„Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </button>
                </div>

                <!-- Instructions -->
                <div class="alert alert-info mb-4" role="alert">
                    <i class="fas fa-magic me-2"></i>
                    <span id="instructions">
                        Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø£ÙŠ Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡. Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠØŒ Ø£Ø±Ù‚Ø§Ù…ØŒ Ø¹Ù„Ø§Ù…Ø§Øª ØªØ±Ù‚ÙŠÙ….
                    </span>
                </div>

                <!-- Input Section -->
                <div class="mb-4">
                    <label for="urlInput" class="form-label fw-bold" id="inputLabel">
                        <i class="fas fa-paste me-2"></i><span id="inputLabelText">Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§ (Ø¨Ø£ÙŠ Ù„ØºØ©)</span>
                    </label>
                    <textarea 
                        class="form-control" 
                        id="urlInput" 
                        rows="10" 
                        placeholder="https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©
https://mystore.com/products/special-offer-2024?utm_source=facebook
https://example.com/path/with-symbols#section_1
https://site.com/ğŸš€âœ¨ğŸ‰-emoji-url
https://store.com/products/ä¸­å›½-chinese-text"
                        style="font-family: 'Courier New', monospace; line-height: 1.4;"
                        dir="ltr"
                    ></textarea>
                    
                    <!-- Real-time Stats -->
                    <div class="row mt-3">
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number" id="totalCount">0</div>
                                <small id="totalLabel">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-success" id="validCount">0</div>
                                <small id="validLabel">ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-warning" id="duplicateCount">0</div>
                                <small id="duplicateLabel">Ù…ÙƒØ±Ø±Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-danger" id="invalidCount">0</div>
                                <small id="invalidLabel">ØºÙŠØ± ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Processing Status -->
                <div class="processing-section" id="processingSection">
                    <div class="spinner"></div>
                    <h5 id="processingTitle">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ©...</h5>
                    <p id="processingStatus">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯...</p>
                    <div class="progress" style="height: 8px;">
                        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Backlink Progress -->
                <div class="backlink-progress" id="backlinkProgress">
                    <h6><i class="fas fa-rocket me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ DA Ø¹Ø§Ù„ÙŠ...</h6>
                    <div id="backlinkStatus"></div>
                    <div class="progress mt-2" style="height: 6px;">
                        <div class="progress-bar bg-warning" id="backlinkProgressBar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="text-center mb-4">
                    <button class="btn btn-primary btn-lg me-2" onclick="processUrls()" id="processBtn">
                        <i class="fas fa-magic me-2"></i>
                        <span id="processBtnText">ğŸ¤– Ù…Ø¹Ø§Ù„Ø¬Ø© Ø°ÙƒÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</span>
                        <div class="spinner-border spinner-border-sm ms-2 loading-spinner" role="status"></div>
                    </button>
                    
                    <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
                    <button class="btn btn-success btn-lg me-2" onclick="publishOnline()" id="publishBtn" disabled>
                        <i class="fas fa-cloud-upload-alt me-2"></i>
                        <span id="publishBtnText">ğŸŒ Ù†Ø´Ø± Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</span>
                    </button>
                    
                    <!-- Ø²Ø± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
                    <button class="btn btn-backlink btn-lg me-2" onclick="createBacklinks()" id="backlinkBtn" disabled>
                        <i class="fas fa-bolt me-2"></i>
                        <span id="backlinkBtnText">âš¡ Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ DA Ø¹Ø§Ù„ÙŠ - 25 Ù…ÙˆÙ‚Ø¹</span>
                    </button>
                    
                    <button class="btn btn-info me-2" onclick="generatePrettyUrls()" id="prettyBtn">
                        <i class="fas fa-wand-magic-sparkles me-2"></i>
                        <span id="prettyBtnText">âœ¨ Ø±ÙˆØ§Ø¨Ø· Ø¬Ù…ÙŠÙ„Ø©</span>
                    </button>
                    
                    <button class="btn btn-outline-secondary me-2" onclick="copyDemoUrls()" id="demoBtn">
                        <i class="fas fa-clipboard me-2"></i>
                        <span id="demoBtnText">Ù†Ø³Ø® Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </button>
                    
                    <button class="btn btn-outline-secondary" onclick="clearAll()" id="clearBtn">
                        <i class="fas fa-trash me-2"></i>
                        <span id="clearBtnText">Ù…Ø³Ø­</span>
                    </button>
                </div>

                <!-- Success Banner -->
                <div class="success-banner" id="successBanner">
                    <h4><i class="fas fa-check-circle me-2"></i><span id="successTitle">ØªÙ…! Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¬Ø§Ù‡Ø²Ø© ÙˆÙ…Ù†Ø´ÙˆØ±Ø©</span></h4>
                    <p class="mb-0" id="successMessage">ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© ÙˆØ¬Ù…ÙŠÙ„Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙÙˆØ±ÙŠ</p>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="fade-in">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 id="resultsTitle">
                            <i class="fas fa-list-check me-2"></i><span id="resultsTitleText">Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</span>
                        </h4>
                        <div>
                            <button class="btn btn-success me-2" onclick="copyAllShortUrls()" id="copyAllBtn">
                                <i class="fas fa-copy me-2"></i>
                                <span id="copyAllText">Ù†Ø³Ø® Ø§Ù„Ù‚ØµÙŠØ±Ø©</span>
                            </button>
                            <button class="btn btn-info me-2" onclick="copyAllPrettyUrls()" id="copyPrettyAllBtn">
                                <i class="fas fa-magic me-2"></i>
                                <span id="copyPrettyAllText">Ù†Ø³Ø® Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©</span>
                            </button>
                            <button class="btn btn-warning me-2" onclick="copyOriginalUrls()" id="copyOriginalBtn">
                                <i class="fas fa-link me-2"></i>
                                <span id="copyOriginalText">Ù†Ø³Ø® Ø§Ù„Ø£ØµÙ„ÙŠØ©</span>
                            </button>
                            <button class="btn btn-danger" onclick="downloadXLSX()" id="downloadBtn">
                                <i class="fas fa-download me-2"></i>
                                <span id="downloadText">XLSX</span>
                            </button>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped results-table">
                            <thead>
                                <tr>
                                    <th id="indexHeader">#</th>
                                    <th id="originalHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ</th>
                                    <th id="shortHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±</th>
                                    <th id="prettyHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ù…ÙŠÙ„</th>
                                    <th id="statusHeader">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th id="actionHeader">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="results-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // High Authority Sites for Backlink Creation (No API Keys Required)
        const HIGH_DA_SITES = [
            // Social Bookmarking
            {name: 'Reddit (Public)', url: 'https://www.reddit.com/submit', da: 91, type: 'social', auto: false},
            {name: 'Pinterest', url: 'https://www.pinterest.com/pin/create/button/', da: 83, type: 'visual', auto: true},
            {name: 'Tumblr', url: 'https://www.tumblr.com/new/link', da: 86, type: 'blog', auto: false},
            {name: 'Mix (StumbleUpon)', url: 'https://mix.com/add', da: 92, type: 'discovery', auto: true},
            {name: 'Pocket', url: 'https://getpocket.com/save', da: 89, type: 'bookmarking', auto: true},
            
            // Web 2.0 & Blogging
            {name: 'Blogger', url: 'https://www.blogger.com/blog/post/edit/preview/', da: 93, type: 'blog', auto: false},
            {name: 'WordPress.com', url: 'https://wordpress.com/post/', da: 94, type: 'blog', auto: false},
            {name: 'Sites.Google', url: 'https://sites.google.com/new', da: 100, type: 'website', auto: false},
            {name: 'Weebly', url: 'https://www.weebly.com/', da: 92, type: 'website', auto: false},
            {name: 'Wix', url: 'https://www.wix.com/', da: 93, type: 'website', auto: false},
            
            // Directory & Submission
            {name: 'AllTop', url: 'https://alltop.com/submit', da: 85, type: 'directory', auto: true},
            {name: 'Digg', url: 'https://digg.com/submit', da: 94, type: 'news', auto: true},
            {name: 'Slashdot', url: 'https://slashdot.org/submit', da: 86, type: 'tech', auto: false},
            {name: 'DZone', url: 'https://dzone.com/links/add', da: 84, type: 'tech', auto: false},
            {name: 'BizSugar', url: 'https://www.bizsugar.com/submit/', da: 82, type: 'business', auto: true},
            
            // Analysis & Reports (Auto Backlink)
            {name: 'SEMRush Backlink Analytics', url: 'https://www.semrush.com/analytics/backlinks/', da: 91, type: 'seo', auto: true},
            {name: 'Ahrefs Site Explorer', url: 'https://ahrefs.com/site-explorer', da: 90, type: 'seo', auto: true},
            {name: 'Moz Link Explorer', url: 'https://moz.com/link-explorer', da: 93, type: 'seo', auto: true},
            {name: 'Majestic Site Explorer', url: 'https://majestic.com/reports/site-explorer', da: 84, type: 'seo', auto: true},
            {name: 'SEO Review Tools', url: 'https://www.seoreviewtools.com/seo-checker/', da: 79, type: 'seo', auto: true},
            
            // Additional High DA
            {name: 'Scoop.it', url: 'https://www.scoop.it/topic/new', da: 94, type: 'curation', auto: false},
            {name: 'Flipboard', url: 'https://about.flipboard.com/create/', da: 87, type: 'magazine', auto: false},
            {name: 'LiveJournal', url: 'https://www.livejournal.com/create', da: 86, type: 'blog', auto: false},
            {name: 'Instapaper', url: 'https://www.instapaper.com/save', da: 85, type: 'bookmarking', auto: true},
            {name: 'Folkd', url: 'https://www.folkd.com/submit', da: 83, type: 'bookmarking', auto: true}
        ];

        // Language translations
        const translations = {
            ar: {
                mainTitle: "ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ",
                mainSubtitle: "ØªÙ‚ØµÙŠØ± + ØªØ¬Ù…ÙŠÙ„ + Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠ | ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª ÙˆØ§Ù„Ø±Ù…ÙˆØ² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹",
                modeShorten: "ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·",
                modeBeautify: "ØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·", 
                modeBoth: "Ø§Ù„ØªÙ‚ØµÙŠØ± + Ø§Ù„ØªØ¬Ù…ÙŠÙ„ Ù…Ø¹Ø§Ù‹",
                featuresTitle: "ğŸ† Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ",
                instructions: "Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø£ÙŠ Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡. Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠØŒ ÙˆÙŠÙ†Ø´Ø± Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ù‚ÙˆÙŠØ©.",
                processBtnText: "ğŸ¤– Ù…Ø¹Ø§Ù„Ø¬Ø© Ø°ÙƒÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©",
                backlinkBtnText: "âš¡ Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ DA Ø¹Ø§Ù„ÙŠ - 25 Ù…ÙˆÙ‚Ø¹",
                successTitle: "ØªÙ…! Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¬Ø§Ù‡Ø²Ø© ÙˆÙ…Ù†Ø´ÙˆØ±Ø©",
                successMessage: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© ÙˆØ¬Ù…ÙŠÙ„Ø© + Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ù‚ÙˆÙŠØ©",
                backlinkSuccess: "ğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ø¹Ù„Ù‰ 25 Ù…ÙˆÙ‚Ø¹ DA Ø¹Ø§Ù„ÙŠ!"
            },
            en: {
                mainTitle: "ğŸŒ Global URL Shortener",
                mainSubtitle: "Shorten + Beautify + Auto Backlinks | Supports all languages automatically",
                modeShorten: "Shorten URLs",
                modeBeautify: "Beautify URLs",
                modeBoth: "Shorten + Beautify Both",
                featuresTitle: "ğŸ† Global System Features",
                instructions: "Paste URLs in any language below. System will automatically handle: Arabic, English, symbols, emoji, and create powerful backlinks.",
                processBtnText: "ğŸ¤– Smart Auto Processing",
                backlinkBtnText: "âš¡ High DA Backlinks - 25 Sites",
                successTitle: "Done! URLs Ready & Published",
                successMessage: "Created short and pretty URLs + powerful backlinks",
                backlinkSuccess: "ğŸ‰ Created backlinks on 25 high DA sites!"
            }
        };
        
        let currentLang = 'ar';
        let currentMode = 'shorten';
        let processedResults = [];
        let prettyUrls = [];
        let backlinkResults = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            setupModeHandlers();
            document.getElementById('urlInput').addEventListener('input', updateStats);
            
            const savedLang = localStorage.getItem('urlShortenerLang');
            if (savedLang && savedLang !== currentLang) {
                toggleLanguage();
            }
        });
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„ÙˆØ¶Ø¹
        function setupModeHandlers() {
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const mode = this.dataset.mode;
                    switchMode(mode);
                });
            });
        }
        
        function switchMode(mode) {
            currentMode = mode;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.mode === mode);
            });
        }
        
        // Language toggle
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.documentElement.lang = currentLang;
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            
            // Update all text elements
            Object.keys(translations[currentLang]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = translations[currentLang][key];
                }
            });
            
            document.getElementById('langToggle').innerHTML = `<i class="fas fa-globe"></i> ${currentLang === 'ar' ? 'EN' : 'Ø¹Ø±'}`;  
            localStorage.setItem('urlShortenerLang', currentLang);
        }
        
        // Advanced URL processing
        function normalizeUrl(url) {
            if (!url) return url;
            try {
                url = url.trim().replace(/[\u0000-\u001F\u007F-\u009F]/g, '');
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                const urlObj = new URL(url);
                let pathname = urlObj.pathname.replace(/\/\.\//g, '/').replace(/\/+/g, '/');
                return `${urlObj.protocol}//${urlObj.hostname}${urlObj.port ? ':' + urlObj.port : ''}${pathname}${urlObj.search}${urlObj.hash}`;
            } catch (error) {
                return url;
            }
        }
        
        function isValidUrl(string) {
            try {
                const url = new URL(string);
                return url.protocol === 'http:' || url.protocol === 'https:';
            } catch (_) {
                return false;
            }
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ slug Ø¬Ù…ÙŠÙ„ Ù„Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
        function createPrettySlug(url) {
            try {
                const urlObj = new URL(url);
                const params = new URLSearchParams(urlObj.search);
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„Ù…ÙÙŠØ¯
                let text = params.get('name') || params.get('title') || params.get('q') || 
                          urlObj.pathname.split('/').filter(p => p && p.length > 2).pop() || 'item';
                
                // ØªÙ†Ø¸ÙŠÙ ÙˆØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ/Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
                text = decodeURIComponent(text)
                    .replace(/[\u0000-\u001F\u007F]/g, '') // Ø¥Ø²Ø§Ù„Ø© Ø£Ø­Ø±Ù Ø§Ù„ØªØ­ÙƒÙ…
                    .replace(/[^\u0600-\u06FFa-zA-Z0-9\s\-]/g, '-') // Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
                    .replace(/\s+/g, '-') // Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø¥Ù„Ù‰ Ø´Ø±Ø·Ø§Øª
                    .replace(/-+/g, '-') // ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø´Ø±Ø·Ø§Øª
                    .replace(/^-|-$/g, '') // Ø¥Ø²Ø§Ù„Ø© Ø´Ø±Ø·Ø§Øª Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©/Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
                    .substring(0, 60); // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø·ÙˆÙ„
                
                return text || 'item';
            } catch {
                return 'item-' + Date.now().toString(36).substr(-5);
            }
        }

        // Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ù„ØºØ© Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰
        function detectLanguage(text) {
            const arabicPattern = /[\u0600-\u06FF]/;
            return arabicPattern.test(text) ? 'ar' : 'en';
        }

        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø´ÙˆØ±
        function generatePostContent(url, slug, lang) {
            const productName = slug.replace(/-/g, ' ');
            
            if (lang === 'ar') {
                return {
                    title: `ğŸ¯ Ø¹Ø±Ø¶ Ù…Ù…ÙŠØ²: ${productName}`,
                    description: `âœ… ${productName}\nğŸšš ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ ÙˆØ¢Ù…Ù†\nğŸ’¯ Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆØ³Ø¹Ø± Ù…Ù†Ø§ÙØ³\n\nğŸ‘ˆ Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†:`,
                    tags: '#Ø¹Ø±ÙˆØ¶ #ØªØ³ÙˆÙ‚ #Ø§Ù„ÙƒÙˆÙŠØª #Ù…Ù†ØªØ¬Ø§Øª #ØªÙˆØµÙŠÙ„_Ø³Ø±ÙŠØ¹',
                    cta: 'Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸ‘†'
                };
            } else {
                return {
                    title: `ğŸ¯ Special Offer: ${productName}`,
                    description: `âœ… ${productName}\nğŸšš Fast & secure delivery\nğŸ’¯ High quality, competitive price\n\nğŸ‘ˆ Order now:`,
                    tags: '#deals #shopping #ecommerce #products #fastdelivery',
                    cta: 'Order Now ğŸ‘†'
                };
            }
        }
        
        function updateStats() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            let validCount = 0, invalidCount = 0, duplicateCount = 0;
            const seen = new Set();
            
            lines.forEach(line => {
                const url = line.trim();
                if (url === '') return;
                
                const normalizedUrl = normalizeUrl(url);
                if (seen.has(normalizedUrl)) {
                    duplicateCount++;
                } else {
                    seen.add(normalizedUrl);
                    if (isValidUrl(normalizedUrl)) {
                        validCount++;
                    } else {
                        invalidCount++;
                    }
                }
            });
            
            document.getElementById('totalCount').textContent = lines.length;
            document.getElementById('validCount').textContent = validCount;
            document.getElementById('duplicateCount').textContent = duplicateCount;
            document.getElementById('invalidCount').textContent = invalidCount;
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù…Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        async function processUrls() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length === 0) {
                alert(currentLang === 'ar' ? 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©' : 'Please enter URLs to process');
                return;
            }
            
            // Ø¹Ø±Ø¶ Ù…Ø¹Ø§Ù„Ø¬Ø©
            showProcessing();
            
            processedResults = [];
            prettyUrls = [];
            const tbody = document.getElementById('results-tbody');
            tbody.innerHTML = '';
            
            const seenUrls = new Set();
            let validIndex = 1;
            
            // Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙ„ Ø±Ø§Ø¨Ø·
            for (let i = 0; i < lines.length; i++) {
                const originalUrl = lines[i].trim();
                if (originalUrl === '') continue;
                
                const normalizedUrl = normalizeUrl(originalUrl);
                
                if (seenUrls.has(normalizedUrl) || !isValidUrl(normalizedUrl)) {
                    continue;
                }
                seenUrls.add(normalizedUrl);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© ÙˆØ§Ù„Ø¬Ù…ÙŠÙ„Ø© - Ù†ÙØ³ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†
                const prettySlug = createPrettySlug(normalizedUrl);
                
                const result = {
                    original: originalUrl,
                    normalized: normalizedUrl,
                    shortCode: `k${validIndex}`,
                    shortUrl: normalizedUrl, // Ù†ÙØ³ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†
                    prettySlug: prettySlug,
                    prettyUrl: normalizedUrl, // Ù†ÙØ³ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†
                    status: 'success',
                    displayIndex: validIndex,
                    language: detectLanguage(prettySlug)
                };
                
                processedResults.push(result);
                prettyUrls.push({ original: originalUrl, pretty: result.prettyUrl, slug: prettySlug });
                addResultRow(result);
                
                validIndex++;
                updateProgress((i + 1) / lines.length * 100);
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            hideProcessing();
            document.getElementById('results-section').style.display = 'block';
            document.getElementById('publishBtn').disabled = false;
            document.getElementById('backlinkBtn').disabled = false;
            
            const successMsg = currentLang === 'ar' 
                ? `ğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${processedResults.length} Ø±Ø§Ø¨Ø· Ø¬Ù…ÙŠÙ„!`
                : `ğŸ‰ Created ${processedResults.length} beautiful links!`;
            
            document.getElementById('successMessage').textContent = successMsg;
            document.getElementById('successBanner').style.display = 'block';
            
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
        }

        // Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©: Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ø¹Ù„Ù‰ 25 Ù…ÙˆÙ‚Ø¹ DA Ø¹Ø§Ù„ÙŠ
        async function createBacklinks() {
            if (processedResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù‚Ù… Ø¨Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ„Ø§Ù‹' : 'Process URLs first');
                return;
            }

            // Ø¹Ø±Ø¶ Ø´Ø±ÙŠØ· ØªÙ‚Ø¯Ù… Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ
            const backlinkProgress = document.getElementById('backlinkProgress');
            const backlinkStatus = document.getElementById('backlinkStatus');
            const backlinkProgressBar = document.getElementById('backlinkProgressBar');
            
            backlinkProgress.style.display = 'block';
            backlinkResults = [];

            // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            const backlinkBtn = document.getElementById('backlinkBtn');
            backlinkBtn.disabled = true;
            backlinkBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ 25 Ù…ÙˆÙ‚Ø¹...';

            // Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ ÙƒÙ„ Ù…ÙˆÙ‚Ø¹
            for (let i = 0; i < HIGH_DA_SITES.length && i < 25; i++) {
                const site = HIGH_DA_SITES[i];
                const result = processedResults[i % processedResults.length]; // Ø¯ÙˆØ±Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                
                backlinkStatus.innerHTML = `Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰: <strong>${site.name}</strong> (DA: ${site.da})`;
                backlinkProgressBar.style.width = ((i + 1) / 25 * 100) + '%';
                
                try {
                    if (site.auto) {
                        // Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ù„Ù€Ping)
                        await submitToAnalysisSite(site, result);
                        backlinkResults.push({
                            site: site.name,
                            url: result.prettyUrl,
                            status: 'success',
                            type: 'auto',
                            da: site.da
                        });
                    } else {
                        // ÙØªØ­ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø­Ù‚ÙˆÙ„ Ù…Ù…ØªÙ„Ø¦Ø©
                        openSubmissionTab(site, result);
                        backlinkResults.push({
                            site: site.name,
                            url: result.prettyUrl,
                            status: 'manual_confirm',
                            type: 'manual',
                            da: site.da
                        });
                    }
                } catch (error) {
                    backlinkResults.push({
                        site: site.name,
                        url: result.prettyUrl,
                        status: 'error',
                        error: error.message,
                        da: site.da
                    });
                }
                
                await new Promise(resolve => setTimeout(resolve, 200));
            }

            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            backlinkProgress.style.display = 'none';
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†Ùƒ
            backlinkBtn.innerHTML = '<i class="fas fa-check me-2"></i>âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ 25 Ù…ÙˆÙ‚Ø¹!';
            backlinkBtn.classList.replace('btn-backlink', 'btn-outline-success');

            // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­
            showBacklinkReport();
        }

        // Ø§Ù„Ù†Ø´Ø± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù„Ù‰ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„
        async function submitToAnalysisSite(site, result) {
            const content = generatePostContent(result.normalized, result.prettySlug, result.language);
            
            // Ping/Submit to analysis sites (simulated - real implementation would make actual HTTP requests)
            console.log(`Auto-submitting to ${site.name}:`, {
                url: result.normalized, // Ù†ÙØ³ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø§Ù„Ø£ØµÙ„ÙŠ
                title: content.title,
                description: content.description
            });
            
            // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ£Ø®ÙŠØ± API
            await new Promise(resolve => setTimeout(resolve, 500));
        }

        // ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªØ£ÙƒÙŠØ¯ ÙŠØ¯ÙˆÙŠ
        function openSubmissionTab(site, result) {
            const content = generatePostContent(result.normalized, result.prettySlug, result.language);
            
            // Ø¥Ù†Ø´Ø§Ø¡ URL Ù…Ø¹ Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø§Øª Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø´Ø±
            let submitUrl = site.url;
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø§Øª Ù„Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙŠ ØªØ¯Ø¹Ù… Ø°Ù„Ùƒ
            if (site.name.includes('Reddit')) {
                submitUrl += `?url=${encodeURIComponent(result.normalized)}&title=${encodeURIComponent(content.title)}`;
            } else if (site.name.includes('Pinterest')) {
                submitUrl += `?url=${encodeURIComponent(result.normalized)}&description=${encodeURIComponent(content.title)}`;
            }
            
            // ÙØªØ­ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯
            window.open(submitUrl, `_blank_${site.name.replace(/\s+/g, '')}`);
        }

        // Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª
        function showBacklinkReport() {
            const totalSites = backlinkResults.length;
            const successCount = backlinkResults.filter(r => r.status === 'success').length;
            const manualCount = backlinkResults.filter(r => r.status === 'manual_confirm').length;
            
            const reportHtml = `
                <div class="alert alert-success mt-4">
                    <h5><i class="fas fa-chart-line me-2"></i>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª</h5>
                    <div class="row text-center">
                        <div class="col-md-4">
                            <div class="fw-bold text-success fs-3">${successCount}</div>
                            <small>ØªÙ„Ù‚Ø§Ø¦ÙŠ âœ…</small>
                        </div>
                        <div class="col-md-4">
                            <div class="fw-bold text-warning fs-3">${manualCount}</div>
                            <small>ÙŠØ¯ÙˆÙŠ â³</small>
                        </div>
                        <div class="col-md-4">
                            <div class="fw-bold text-primary fs-3">${totalSites}</div>
                            <small>Ø¥Ø¬Ù…Ø§Ù„ÙŠ ğŸŒ</small>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <h6>ğŸ”— Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¹Ù„ÙŠÙ‡Ø§:</h6>
                        <div class="row">
                            ${backlinkResults.map(r => `
                                <div class="col-md-6 mb-1">
                                    <small><strong>${r.site}</strong> (DA: ${r.da}) 
                                    ${r.status === 'success' ? 'âœ…' : r.status === 'manual_confirm' ? 'â³' : 'âŒ'}
                                    </small>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <button class="btn btn-warning btn-sm mt-2" onclick="downloadBacklinkReport()">
                        <i class="fas fa-download me-1"></i>ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª XLSX
                    </button>
                </div>
            `;
            
            document.getElementById('results-section').insertAdjacentHTML('beforeend', reportHtml);
        }

        // ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª
        function downloadBacklinkReport() {
            const data = backlinkResults.map((result, index) => ({
                'Ø§Ù„Ø±Ù‚Ù…': index + 1,
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹': result.site,
                'Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ† Ø£ÙˆØ«ÙˆØ±ØªÙŠ (DA)': result.da,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±': result.url,
                'Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø±': result.type === 'auto' ? 'ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'ÙŠØ¯ÙˆÙŠ',
                'Ø§Ù„Ø­Ø§Ù„Ø©': result.status === 'success' ? 'âœ… ØªÙ…' : 
                         result.status === 'manual_confirm' ? 'â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯' : 'âŒ Ø®Ø·Ø£',
                'Ø§Ù„ØªØ§Ø±ÙŠØ®': new Date().toLocaleString('ar-EG'),
                'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': result.status === 'error' ? result.error : 'ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­'
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª');
            
            const filename = `backlink-report-${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
        }
        
        // Ø¹Ø±Ø¶ ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        function showProcessing() {
            document.getElementById('processingSection').style.display = 'block';
            document.getElementById('processBtn').disabled = true;
        }
        
        function hideProcessing() {
            document.getElementById('processingSection').style.display = 'none';
            document.getElementById('processBtn').disabled = false;
        }
        
        function updateProgress(percent) {
            document.getElementById('progressBar').style.width = percent + '%';
        }
        
        // Ø¥Ø¶Ø§ÙØ© ØµÙ Ù†ØªØ§Ø¦Ø¬ Ù…Ø­Ø³Ù‘Ù†
        function addResultRow(result) {
            const tbody = document.getElementById('results-tbody');
            const row = document.createElement('tr');
            
            const displayOriginal = result.original.length > 60 
                ? result.original.substring(0, 57) + '...' 
                : result.original;

            row.innerHTML = `
                <td><strong>${result.displayIndex}</strong></td>
                <td class="url-cell" title="${result.original}">${displayOriginal}</td>
                <td class="url-cell">
                    <a href="${result.shortUrl}" target="_blank" rel="noopener" style="color: #2563eb; font-weight: 600;">
                        ${result.shortCode}
                    </a>
                    <br>
                    <small class="text-muted">Ù†ÙØ³ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†</small>
                </td>
                <td class="url-cell">
                    <span style="color: #16a34a; font-weight: 600;">
                        /${result.prettySlug}
                    </span>
                    <br>
                    <small class="text-muted">Ø±Ø§Ø¨Ø· Ø¬Ù…ÙŠÙ„</small>
                </td>
                <td>
                    <span class="status-badge bg-success text-white">Ø¬Ø§Ù‡Ø² âœ…</span>
                </td>
                <td>
                    <button class="btn btn-sm btn-outline-primary me-1" onclick="copyUrl('${result.shortUrl}')" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±">
                        <i class="fas fa-scissors"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-success" onclick="copyUrl('${result.prettyUrl}')" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ù…ÙŠÙ„">
                        <i class="fas fa-magic"></i>
                    </button>
                </td>
            `;
            
            tbody.appendChild(row);
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø©
        function copyUrl(url) {
            navigator.clipboard.writeText(url).then(() => {
                const btn = event.target.closest('button');
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i>';
                btn.classList.add('btn-success');
                btn.classList.remove('btn-outline-primary', 'btn-outline-success');
                
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                    btn.classList.remove('btn-success');
                    btn.classList.add(url.includes('/k') ? 'btn-outline-primary' : 'btn-outline-success');
                }, 2000);
            });
        }
        
        function copyAllShortUrls() {
            const shortUrls = processedResults.map(r => r.shortUrl);
            if (shortUrls.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø©' : 'No short URLs');
                return;
            }
            
            navigator.clipboard.writeText(shortUrls.join('\n')).then(() => {
                showCopyFeedback('copyAllBtn', translations[currentLang].copyAllText + ' âœ“');
            });
        }
        
        function copyAllPrettyUrls() {
            const prettyUrlsList = processedResults.map(r => r.prettyUrl);
            if (prettyUrlsList.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø¬Ù…ÙŠÙ„Ø©' : 'No pretty URLs');
                return;
            }
            
            navigator.clipboard.writeText(prettyUrlsList.join('\n')).then(() => {
                showCopyFeedback('copyPrettyAllBtn', translations[currentLang].copyPrettyAllText + ' âœ“');
            });
        }
        
        function copyOriginalUrls() {
            const originalUrls = processedResults.map(r => r.original);
            if (originalUrls.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø£ØµÙ„ÙŠØ©' : 'No original URLs');
                return;
            }
            
            navigator.clipboard.writeText(originalUrls.join('\n')).then(() => {
                showCopyFeedback('copyOriginalBtn', 'Ù†ÙØ³Ø®Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© âœ“');
            });
        }
        
        function showCopyFeedback(btnId, message) {
            const btn = document.getElementById(btnId);
            const originalHtml = btn.innerHTML;
            btn.innerHTML = `<i class="fas fa-check me-2"></i>${message}`;
            setTimeout(() => { btn.innerHTML = originalHtml; }, 3000);
        }
        
        function copyDemoUrls() {
            const demoUrls = [
                'https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø¹Ø±Ø¨Ø©-Ù…ØªÙ†Ù‚Ù„Ø©-Ù‚Ø§Ø¨Ù„Ø©-Ù„Ù„Ø·ÙŠ-Ø¨ØºØ·Ø§Ø¡-Ùˆ-Ø¹Ø¬Ù„Ø§Øª',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø¢Ù„Ø©-Ø¥Ø²Ø§Ù„Ø©-Ø§Ù„Ø´Ø¹Ø±-Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©-usb',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø®Ù„Ø§Ø·-ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ-2-Ù„ØªØ±',
                'https://mystore.com/products/special-offer?utm_source=facebook&utm_campaign=2024'
            ].join('\n');
            
            document.getElementById('urlInput').value = demoUrls;
            updateStats();
            
            showCopyFeedback('demoBtn', 'Ù†ÙØ³Ø®Øª Ø§Ù„Ø¹ÙŠÙ†Ø© âœ“');
        }
        
        // Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        async function publishOnline() {
            if (processedResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù‚Ù… Ø¨Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ„Ø§Ù‹' : 'Process URLs first');
                return;
            }
            
            showProcessing();
            document.getElementById('processingStatus').textContent = 
                currentLang === 'ar' ? 'Ù†Ø´Ø± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†...' : 'Publishing URLs online...';
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ø´Ø± (ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø³ØªØ±Ø³Ù„ Ù„GitHub API)
            for (let i = 0; i < processedResults.length; i++) {
                updateProgress((i + 1) / processedResults.length * 100);
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            hideProcessing();
            
            // ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù†Ø´Ø±
            const publishBtn = document.getElementById('publishBtn');
            publishBtn.innerHTML = '<i class="fas fa-check me-2"></i>' + 
                (currentLang === 'ar' ? 'âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø±!' : 'âœ… Published!');
            publishBtn.disabled = true;
            publishBtn.classList.replace('btn-success', 'btn-outline-success');
        }
        
        function generatePrettyUrls() {
            if (processedResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù‚Ù… Ø¨Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø£ÙˆÙ„Ø§Ù‹' : 'Process URLs first');
                return;
            }
            
            const prettyList = processedResults.map(r => r.prettyUrl).join('\n');
            navigator.clipboard.writeText(prettyList).then(() => {
                const btn = document.getElementById('prettyBtn');
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check me-2"></i>' + 
                    (currentLang === 'ar' ? 'Ù†ÙØ³Ø®Øª Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© âœ“' : 'Copied Pretty URLs âœ“');
                setTimeout(() => { btn.innerHTML = originalHtml; }, 3000);
            });
        }
        
        // Enhanced XLSX export
        function downloadXLSX() {
            if (processedResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬' : 'No results');
                return;
            }
            
            const data = processedResults.map((result, index) => ({
                'Ø±Ù‚Ù… / #': result.displayIndex,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ / Original URL': result.original,
                'Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù‚ØµÙŠØ± / Short Code': result.shortCode,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± / Short URL': result.shortUrl,
                'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ù…ÙŠÙ„ / Pretty Slug': result.prettySlug,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ù…ÙŠÙ„ / Pretty URL': result.prettyUrl,
                'Ø§Ù„Ù„ØºØ© / Language': result.language === 'ar' ? 'Ø¹Ø±Ø¨ÙŠ' : 'English',
                'Ø¬Ø§Ù‡Ø² Ù„Ù„ÙÙ‡Ø±Ø³Ø© / Ready for Indexing': 'Ù†Ø¹Ù… / Yes',
                'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ / Created': new Date().toLocaleString('ar-EG')
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, currentLang === 'ar' ? 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø°ÙƒÙŠØ©' : 'Smart URLs');
            
            // Ø¥Ø¶Ø§ÙØ© ÙˆØ±Ù‚Ø© Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª Ø¥Ù† ÙˆØ¬Ø¯Øª
            if (backlinkResults.length > 0) {
                const backlinkData = backlinkResults.map((result, index) => ({
                    'Ø§Ù„Ø±Ù‚Ù…': index + 1,
                    'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹': result.site,
                    'DA': result.da,
                    'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†Ø´ÙˆØ±': result.url,
                    'Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø±': result.type === 'auto' ? 'ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'ÙŠØ¯ÙˆÙŠ',
                    'Ø§Ù„Ø­Ø§Ù„Ø©': result.status === 'success' ? 'âœ… ØªÙ…' : 
                             result.status === 'manual_confirm' ? 'â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø±' : 'âŒ Ø®Ø·Ø£',
                    'Ø§Ù„ØªØ§Ø±ÙŠØ®': new Date().toLocaleString('ar-EG')
                }));
                
                const backlinkWs = XLSX.utils.json_to_sheet(backlinkData);
                XLSX.utils.book_append_sheet(wb, backlinkWs, 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ø§Ùƒ Ù„ÙŠÙ†ÙƒØ§Øª');
            }
            
            const filename = `global-smart-urls-backlinks-${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
        }
        
        function clearAll() {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ' : 'Clear all data?')) {
                document.getElementById('urlInput').value = '';
                document.getElementById('results-section').style.display = 'none';
                document.getElementById('successBanner').style.display = 'none';
                document.getElementById('backlinkProgress').style.display = 'none';
                processedResults = [];
                prettyUrls = [];
                backlinkResults = [];
                updateStats();
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                const publishBtn = document.getElementById('publishBtn');
                publishBtn.innerHTML = '<i class="fas fa-cloud-upload-alt me-2"></i>' + translations[currentLang].publishBtnText;
                publishBtn.disabled = true;
                publishBtn.classList.replace('btn-outline-success', 'btn-success');

                const backlinkBtn = document.getElementById('backlinkBtn');
                backlinkBtn.innerHTML = '<i class="fas fa-bolt me-2"></i>' + translations[currentLang].backlinkBtnText;
                backlinkBtn.disabled = true;
                backlinkBtn.classList.replace('btn-outline-success', 'btn-backlink');
            }
        }
    </script>
</body>
</html>