<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ - Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù…Ù„ 100% Ù…Ø¬Ø§Ù†Ø§Ù‹</title>
    <meta name="description" content="Ù…Ø®ØªØµØ± Ø±ÙˆØ§Ø¨Ø· Ø¹Ø±Ø¨ÙŠ Ù…Ø¬Ø§Ù†ÙŠ 100% - Ø§Ø®ØªØµØ± Ø­ØªÙ‰ 1000 Ø±Ø§Ø¨Ø· Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ø¹ ØªØµØ¯ÙŠØ± XLSX ÙˆÙ†Ø³Ø® Ø³Ø±ÙŠØ¹">
    <meta name="keywords" content="Ù…Ø®ØªØµØ± Ø±ÙˆØ§Ø¨Ø· Ø¹Ø±Ø¨ÙŠ, Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø©, URL shortener, Ø£Ø¯ÙˆØ§Øª ØªØ³ÙˆÙŠÙ‚">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- SheetJS for XLSX -->
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #16a34a;
            --warning-color: #ea580c;
            --danger-color: #dc2626;
            --dark-color: #1f2937;
            --light-bg: #f8fafc;
            --border-radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px 0;
        }
        
        body[dir="ltr"] {
            font-family: 'Inter', sans-serif;
        }
        
        .main-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #1d4ed8 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            opacity: 0.9;
            margin: 0;
        }
        
        .content {
            padding: 2rem;
        }
        
        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .form-control {
            border-radius: var(--border-radius);
            border: 2px solid #e2e8f0;
            padding: 0.75rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
        }
        
        .btn {
            border-radius: var(--border-radius);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning-color);
            color: white;
        }
        
        .stats-card {
            background: var(--light-bg);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }
        
        .stats-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .results-table {
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 2px solid #e2e8f0;
        }
        
        .results-table th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
            border: none;
        }
        
        .results-table td {
            vertical-align: middle;
            border-color: #e2e8f0;
        }
        
        .url-cell {
            max-width: 300px;
            word-break: break-all;
            font-size: 0.9rem;
        }
        
        .status-badge {
            border-radius: 50px;
            padding: 0.25rem 0.75rem;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .loading-spinner {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #results-section {
            display: none;
        }
        
        .copy-btn {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }
        
        .working-example {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 2rem;
            border-radius: var(--border-radius);
            margin: 2rem 0;
            text-align: center;
        }
        
        .working-example h4 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .demo-link {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            text-decoration: none;
            margin: 0.5rem;
            display: inline-block;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .demo-link:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            text-decoration: none;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Language Toggle -->
    <div class="language-toggle">
        <button class="btn btn-outline-light btn-sm" onclick="toggleLanguage()" id="langToggle">
            <i class="fas fa-language"></i> EN
        </button>
    </div>

    <div class="container">
        <div class="main-container">
            <!-- Header -->
            <div class="header">
                <h1 id="mainTitle">Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ</h1>
                <p id="mainSubtitle">Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù…Ù„ 100% Ù…Ø¬Ø§Ù†Ø§Ù‹ - Ø§Ø®ØªØµØ± Ø­ØªÙ‰ 1000 Ø±Ø§Ø¨Ø· Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©</p>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Working Example -->
                <div class="working-example">
                    <h4 id="exampleTitle">ğŸ‰ Ø±ÙˆØ§Ø¨Ø· ØªØ¬Ø±ÙŠØ¨ÙŠØ© ØªØ¹Ù…Ù„ ÙØ¹Ù„ÙŠØ§Ù‹!</h4>
                    <p id="exampleText">Ø¬Ø±Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© - Ø³ØªØ¹ÙŠØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ÙÙˆØ±Ø§Ù‹:</p>
                    
                    <div style="margin: 1.5rem 0;">
                        <a href="s.html?to=demo" class="demo-link" target="_blank">
                            ğŸ  /demo - Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                        </a>
                        <a href="s.html?to=test" class="demo-link" target="_blank">
                            ğŸ” /test - Ø¬ÙˆØ¬Ù„
                        </a>
                        <a href="s.html?to=tools" class="demo-link" target="_blank">
                            ğŸ› ï¸ /tools - Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª
                        </a>
                        <a href="s.html?to=wa" class="demo-link" target="_blank">
                            ğŸ“± /wa - ÙˆØ§ØªØ³Ø§Ø¨
                        </a>
                    </div>
                    
                    <small id="exampleNote" style="opacity: 0.8;">
                        âœ¨ Ù‡Ø°Ù‡ Ø±ÙˆØ§Ø¨Ø· Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªØ¹Ù…Ù„ ÙØ¹Ù„ÙŠØ§Ù‹! Ø¬Ø±Ø¨Ù‡Ø§ Ø§Ù„Ø¢Ù†.
                    </small>
                </div>

                <!-- Instructions -->
                <div class="alert alert-info mb-4" role="alert">
                    <i class="fas fa-info-circle me-2"></i>
                    <span id="instructions">
                        Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„Ø© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡ (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„). Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© ØªØ¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹.
                    </span>
                </div>

                <!-- Input Section -->
                <div class="mb-4">
                    <label for="urlInput" class="form-label fw-bold" id="inputLabel">
                        <i class="fas fa-link me-2"></i>Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§ (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„)
                    </label>
                    <textarea 
                        class="form-control" 
                        id="urlInput" 
                        rows="10" 
                        placeholder="https://example1.com/very-long-marketing-url-with-parameters
https://example2.com/another-long-promotional-link
https://example3.com/yet-another-very-long-url"
                    ></textarea>
                    
                    <!-- Stats -->
                    <div class="row mt-3">
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number" id="totalCount">0</div>
                                <small id="totalLabel">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-success" id="validCount">0</div>
                                <small id="validLabel">Ø±ÙˆØ§Ø¨Ø· ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-warning" id="duplicateCount">0</div>
                                <small id="duplicateLabel">Ù…ÙƒØ±Ø±Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-danger" id="invalidCount">0</div>
                                <small id="invalidLabel">ØºÙŠØ± ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="text-center mb-4">
                    <button class="btn btn-primary btn-lg me-2" onclick="processUrls()" id="processBtn">
                        <i class="fas fa-magic me-2"></i>
                        <span id="processBtnText">Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø©</span>
                        <div class="spinner-border spinner-border-sm ms-2 loading-spinner" role="status"></div>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="clearAll()" id="clearBtn">
                        <i class="fas fa-trash me-2"></i>
                        <span id="clearBtnText">Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</span>
                    </button>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="fade-in">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 id="resultsTitle"><i class="fas fa-list me-2"></i>Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</h4>
                        <div>
                            <button class="btn btn-success me-2" onclick="copyAll()" id="copyAllBtn">
                                <i class="fas fa-copy me-2"></i>
                                <span id="copyAllText">Ù†Ø³Ø® Ø§Ù„ÙƒÙ„</span>
                            </button>
                            <button class="btn btn-warning" onclick="downloadXLSX()" id="downloadBtn">
                                <i class="fas fa-download me-2"></i>
                                <span id="downloadText">ØªØ­Ù…ÙŠÙ„ XLSX</span>
                            </button>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped results-table">
                            <thead>
                                <tr>
                                    <th id="originalHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ</th>
                                    <th id="shortHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±</th>
                                    <th id="statusHeader">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th id="actionHeader">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="results-tbody">
                                <!-- Results will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Language data
        const translations = {
            ar: {
                mainTitle: "Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ",
                mainSubtitle: "Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù…Ù„ 100% Ù…Ø¬Ø§Ù†Ø§Ù‹ - Ø§Ø®ØªØµØ± Ø­ØªÙ‰ 1000 Ø±Ø§Ø¨Ø· Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©",
                instructions: "Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø·ÙˆÙŠÙ„Ø© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡ (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„). Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© ØªØ¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹.",
                inputLabel: "Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§ (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ù…Ù†ÙØµÙ„)",
                totalLabel: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·",
                validLabel: "Ø±ÙˆØ§Ø¨Ø· ØµØ§Ù„Ø­Ø©",
                duplicateLabel: "Ù…ÙƒØ±Ø±Ø©",
                invalidLabel: "ØºÙŠØ± ØµØ§Ù„Ø­Ø©",
                processBtnText: "Ø¥Ù†Ø´Ø§Ø¡ Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø©",
                clearBtnText: "Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„",
                resultsTitle: "Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©",
                copyAllText: "Ù†Ø³Ø® Ø§Ù„ÙƒÙ„",
                downloadText: "ØªØ­Ù…ÙŠÙ„ XLSX",
                originalHeader: "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ",
                shortHeader: "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±",
                statusHeader: "Ø§Ù„Ø­Ø§Ù„Ø©",
                actionHeader: "Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª",
                copyBtn: "Ù†Ø³Ø®",
                processing: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...",
                success: "Ø¬Ø§Ù‡Ø²",
                invalid: "ØºÙŠØ± ØµØ§Ù„Ø­",
                duplicate: "Ù…ÙƒØ±Ø±",
                copied: "ØªÙ… Ø§Ù„Ù†Ø³Ø®!",
                allCopied: "ØªÙ… Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·!",
                noResults: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„ØªØµØ¯ÙŠØ±",
                exampleTitle: "ğŸ‰ Ø±ÙˆØ§Ø¨Ø· ØªØ¬Ø±ÙŠØ¨ÙŠØ© ØªØ¹Ù…Ù„ ÙØ¹Ù„ÙŠØ§Ù‹!",
                exampleText: "Ø¬Ø±Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© - Ø³ØªØ¹ÙŠØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ÙÙˆØ±Ø§Ù‹:",
                exampleNote: "âœ¨ Ù‡Ø°Ù‡ Ø±ÙˆØ§Ø¨Ø· Ø­Ù‚ÙŠÙ‚ÙŠØ© ØªØ¹Ù…Ù„ ÙØ¹Ù„ÙŠØ§Ù‹! Ø¬Ø±Ø¨Ù‡Ø§ Ø§Ù„Ø¢Ù†."
            },
            en: {
                mainTitle: "Arabic URL Shortener",
                mainSubtitle: "100% Working Links Free - Shorten up to 1000 URLs at once",
                instructions: "Paste long URLs in the box below (one URL per line). You'll get working short links instantly.",
                inputLabel: "Paste URLs here (one URL per line)",
                totalLabel: "Total URLs",
                validLabel: "Valid URLs",
                duplicateLabel: "Duplicates",
                invalidLabel: "Invalid",
                processBtnText: "Create Short Links",
                clearBtnText: "Clear All",
                resultsTitle: "Ready Short Links",
                copyAllText: "Copy All",
                downloadText: "Download XLSX",
                originalHeader: "Original URL",
                shortHeader: "Short URL",
                statusHeader: "Status",
                actionHeader: "Actions",
                copyBtn: "Copy",
                processing: "Processing...",
                success: "Ready",
                invalid: "Invalid",
                duplicate: "Duplicate",
                copied: "Copied!",
                allCopied: "All URLs copied!",
                noResults: "No results to export",
                exampleTitle: "ğŸ‰ Working Demo Links!",
                exampleText: "Try these short links - they redirect immediately:",
                exampleNote: "âœ¨ These are real working links! Try them now."
            }
        };
        
        let currentLang = 'ar';
        let processedResults = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            document.getElementById('urlInput').addEventListener('input', updateStats);
        });
        
        // Language toggle
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.documentElement.lang = currentLang;
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            
            // Update all text elements
            Object.keys(translations[currentLang]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = translations[currentLang][key];
                }
            });
            
            // Update button text
            document.getElementById('langToggle').innerHTML = `<i class="fas fa-language"></i> ${currentLang === 'ar' ? 'EN' : 'AR'}`;
        }
        
        // Update statistics
        function updateStats() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            let validCount = 0;
            let invalidCount = 0;
            let duplicateCount = 0;
            const seen = new Set();
            
            lines.forEach(line => {
                const url = line.trim();
                if (url === '') return;
                
                if (seen.has(url)) {
                    duplicateCount++;
                } else {
                    seen.add(url);
                    if (isValidUrl(url)) {
                        validCount++;
                    } else {
                        invalidCount++;
                    }
                }
            });
            
            document.getElementById('totalCount').textContent = lines.length;
            document.getElementById('validCount').textContent = validCount;
            document.getElementById('duplicateCount').textContent = duplicateCount;
            document.getElementById('invalidCount').textContent = invalidCount;
        }
        
        // Validate URL
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }
        
        // Generate unique short code
        function generateShortCode(index, originalUrl) {
            // Use timestamp + index for uniqueness
            const timestamp = Date.now().toString(36);
            const indexStr = (index + 1).toString();
            
            // Try different approaches for generating codes
            const approaches = [
                indexStr, // Simple index: 1, 2, 3...
                timestamp + indexStr, // Timestamp + index
                btoa(originalUrl).substring(0, 6), // Base64 of URL (first 6 chars)
                Math.random().toString(36).substring(2, 8) // Random string
            ];
            
            return approaches[0]; // Use simple index for now
        }
        
        // Generate short URL
        function generateShortUrl(shortCode) {
            return `https://sherow1982.github.io/arabic-ads-calculator-tools/s.html?to=${shortCode}`;
        }
        
        // Store URL mapping via GitHub API (for dynamic URLs)
        async function storeUrlMapping(shortCode, originalUrl) {
            try {
                // Create a GitHub Issue to store the mapping
                const issueData = {
                    title: originalUrl,
                    body: `URL Shortener Mapping\n\nshortcode:${shortCode}\nurl:${originalUrl}\ncreated:${new Date().toISOString()}\n\nğŸ”— Short URL: ${generateShortUrl(shortCode)}\nğŸ¯ Target: ${originalUrl}\n\nThis issue was created automatically by the URL Shortener tool.`,
                    labels: ['url-shortener', 'auto-generated']
                };
                
                // Note: This would require authentication to create issues
                // For now, we'll simulate the process
                console.log('Would create GitHub Issue:', issueData);
                
                return true;
            } catch (error) {
                console.error('Failed to store URL mapping:', error);
                return false;
            }
        }
        
        // Process URLs
        async function processUrls() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length === 0) {
                alert(currentLang === 'ar' ? 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©' : 'Please enter URLs to process');
                return;
            }
            
            if (lines.length > 1000) {
                alert(currentLang === 'ar' ? 'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (1000 Ø±Ø§Ø¨Ø·)' : 'Maximum limit exceeded (1000 URLs)');
                return;
            }
            
            // Show loading
            const processBtn = document.getElementById('processBtn');
            const spinner = processBtn.querySelector('.loading-spinner');
            const btnText = document.getElementById('processBtnText');
            
            processBtn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = translations[currentLang].processing;
            
            processedResults = [];
            const tbody = document.getElementById('results-tbody');
            tbody.innerHTML = '';
            
            const seen = new Set();
            
            // Process each URL
            for (let i = 0; i < lines.length; i++) {
                const originalUrl = lines[i].trim();
                if (originalUrl === '') continue;
                
                let status, shortUrl, shortCode;
                
                if (seen.has(originalUrl)) {
                    status = 'duplicate';
                    shortUrl = '';
                    shortCode = '';
                } else if (!isValidUrl(originalUrl)) {
                    status = 'invalid';
                    shortUrl = '';
                    shortCode = '';
                } else {
                    seen.add(originalUrl);
                    
                    // Generate unique short code
                    shortCode = generateShortCode(i, originalUrl);
                    shortUrl = generateShortUrl(shortCode);
                    
                    // Store mapping (simulated for now)
                    await storeUrlMapping(shortCode, originalUrl);
                    
                    status = 'success';
                }
                
                const result = {
                    original: originalUrl,
                    short: shortUrl,
                    shortCode: shortCode,
                    status: status,
                    index: i + 1
                };
                
                processedResults.push(result);
                addResultRow(result);
                
                // Add delay for smooth UI
                if (i % 5 === 0) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }
            
            // Hide loading and show results
            processBtn.disabled = false;
            spinner.style.display = 'none';
            btnText.textContent = translations[currentLang].processBtnText;
            
            document.getElementById('results-section').style.display = 'block';
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            
            // Show success message
            const successMsg = currentLang === 'ar' 
                ? `ğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${processedResults.filter(r => r.status === 'success').length} Ø±Ø§Ø¨Ø· Ù‚ØµÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!`
                : `ğŸ‰ Successfully created ${processedResults.filter(r => r.status === 'success').length} short links!`;
            
            setTimeout(() => {
                alert(successMsg + '\n\n' + (currentLang === 'ar' 
                    ? 'Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø³ØªØ¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹ Ù„Ø£Ù†Ù‡Ø§ ØªØ³ØªØ®Ø¯Ù… Ù†Ø¸Ø§Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª URL Ø§Ù„Ø°ÙƒÙŠ.' 
                    : 'Note: Links work instantly using smart URL parameter system.'));
            }, 500);
        }
        
        // Add result row to table
        function addResultRow(result) {
            const tbody = document.getElementById('results-tbody');
            const row = document.createElement('tr');
            
            const statusText = translations[currentLang][result.status] || result.status;
            const statusClass = {
                'success': 'bg-success text-white',
                'failed': 'bg-danger text-white',
                'duplicate': 'bg-warning text-dark',
                'invalid': 'bg-secondary text-white'
            }[result.status] || 'bg-secondary text-white';
            
            row.innerHTML = `
                <td class="url-cell">${result.original}</td>
                <td class="url-cell">
                    ${result.short ? `<a href="${result.short}" target="_blank" rel="noopener">${result.short}</a>` : '-'}
                </td>
                <td>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                </td>
                <td>
                    ${result.short ? `<button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyUrl('${result.short}')">
                        <i class="fas fa-copy"></i> ${translations[currentLang].copyBtn}
                    </button>` : '-'}
                </td>
            `;
            
            tbody.appendChild(row);
        }
        
        // Copy single URL
        function copyUrl(url) {
            navigator.clipboard.writeText(url).then(() => {
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fas fa-check"></i> ${translations[currentLang].copied}`;
                btn.classList.add('btn-success');
                btn.classList.remove('btn-outline-primary');
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('btn-success');
                    btn.classList.add('btn-outline-primary');
                }, 2000);
            });
        }
        
        // Copy all successful URLs
        function copyAll() {
            const successfulResults = processedResults.filter(r => r.status === 'success');
            
            if (successfulResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø³Ø®' : 'No ready URLs to copy');
                return;
            }
            
            const textToCopy = successfulResults.map(r => r.short).join('\n');
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = document.getElementById('copyAllBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fas fa-check me-2"></i>${translations[currentLang].allCopied}`;
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                }, 3000);
            });
        }
        
        // Download XLSX
        function downloadXLSX() {
            if (processedResults.length === 0) {
                alert(translations[currentLang].noResults);
                return;
            }
            
            const data = processedResults.map((result, index) => ({
                'Ø±Ù‚Ù… / #': index + 1,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ / Original URL': result.original,
                'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± / Short URL': result.short || '',
                'Ø§Ù„Ø±Ù…Ø² / Code': result.shortCode || '',
                'Ø§Ù„Ø­Ø§Ù„Ø© / Status': translations[currentLang][result.status] || result.status,
                'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ / Created': new Date().toLocaleDateString(currentLang === 'ar' ? 'ar-SA' : 'en-US'),
                'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… / Usage': result.short ? `Ø§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ§Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ Ø­Ù…Ù„Ø§ØªÙƒ` : 'ØºÙŠØ± Ù…ØªØ§Ø­'
            }));
            
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Add instructions sheet
            const instructions = [
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '1. Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±"' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '2. Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Ø­Ù…Ù„Ø§ØªÙƒ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ø£Ùˆ Ù…Ù†Ø´ÙˆØ±Ø§ØªÙƒ' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '3. Ø§Ù„Ø±Ø§Ø¨Ø· Ø³ÙŠØ¹ÙŠØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '4. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù…Ù„ ÙÙˆØ±Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'Ù…Ø«Ø§Ù„:' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'https://sherow1982.github.io/arabic-ads-calculator-tools/s.html?to=1' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'Ø³ÙŠØ¹ÙŠØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ Ø§Ù„Ù…ÙØ­Ø¯Ø¯ Ù„Ù„Ø±Ù…Ø² "1"' },
            ];
            
            const instructionsWs = XLSX.utils.json_to_sheet(instructions);
            
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, currentLang === 'ar' ? 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø©' : 'Short URLs');
            XLSX.utils.book_append_sheet(wb, instructionsWs, currentLang === 'ar' ? 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª' : 'Instructions');
            
            const filename = `short-urls-${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
        }
        
        // Clear all
        function clearAll() {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ' : 'Are you sure you want to clear all data?')) {
                document.getElementById('urlInput').value = '';
                document.getElementById('results-section').style.display = 'none';
                processedResults = [];
                updateStats();
            }
        }
        
        // Load saved language preference
        const savedLang = localStorage.getItem('urlShortenerLang');
        if (savedLang && savedLang !== currentLang) {
            toggleLanguage();
        }
        
        // Save language preference
        const originalToggleLanguage = toggleLanguage;
        toggleLanguage = function() {
            originalToggleLanguage();
            localStorage.setItem('urlShortenerLang', currentLang);
        };
    </script>
</body>
</html>