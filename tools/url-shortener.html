<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ - ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</title>
    <meta name="description" content="Ù…Ø®ØªØµØ± Ø±ÙˆØ§Ø¨Ø· Ø¹Ø§Ù„Ù…ÙŠ Ù…Ø¬Ø§Ù†ÙŠ - ÙŠØ¯Ø¹Ù… Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ - Ø§Ø®ØªØµØ± 1000 Ø±Ø§Ø¨Ø· Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Noto+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- SheetJS for XLSX -->
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <style>
        :root {
            --primary-color: #2563eb;
            --success-color: #16a34a;
            --warning-color: #ea580c;
            --danger-color: #dc2626;
            --info-color: #0ea5e9;
            --dark-color: #1f2937;
            --light-bg: #f8fafc;
            --border-radius: 12px;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Cairo', 'Noto Sans Arabic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px 0;
        }
        
        body[dir="ltr"] {
            font-family: 'Inter', 'Roboto', sans-serif;
        }
        
        .main-container {
            background: white; border-radius: var(--border-radius);
            box-shadow: var(--shadow); overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #1d4ed8 100%);
            color: white; padding: 2rem; text-align: center;
        }
        
        .header h1 {
            font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;
        }
        
        .header p {
            opacity: 0.9; margin: 0;
        }
        
        .content { padding: 2rem; }
        
        .language-toggle {
            position: absolute; top: 20px; right: 20px; z-index: 1000;
        }
        
        .form-control {
            border-radius: var(--border-radius);
            border: 2px solid #e2e8f0; padding: 0.75rem;
            transition: all 0.3s ease; font-family: inherit;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
        }
        
        .btn {
            border-radius: var(--border-radius); padding: 0.75rem 1.5rem;
            font-weight: 600; transition: all 0.3s ease; border: none;
        }
        
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: #1d4ed8; transform: translateY(-2px); }
        .btn-success { background: var(--success-color); color: white; }
        .btn-warning { background: var(--warning-color); color: white; }
        .btn-info { background: var(--info-color); color: white; }
        
        .stats-card {
            background: var(--light-bg); border-radius: var(--border-radius);
            padding: 1.5rem; text-align: center; border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            transform: translateY(-4px); box-shadow: var(--shadow);
        }
        
        .stats-number {
            font-size: 2rem; font-weight: 700; color: var(--primary-color);
        }
        
        .results-table {
            border-radius: var(--border-radius); overflow: hidden;
            border: 2px solid #e2e8f0;
        }
        
        .results-table th {
            background: var(--primary-color); color: white;
            font-weight: 600; border: none;
        }
        
        .results-table td {
            vertical-align: middle; border-color: #e2e8f0;
        }
        
        .url-cell {
            max-width: 300px; word-break: break-all;
            font-size: 0.9rem; font-family: monospace;
            background: #f1f5f9; padding: 0.5rem;
            border-radius: 6px;
        }
        
        .status-badge {
            border-radius: 50px; padding: 0.25rem 0.75rem;
            font-size: 0.8rem; font-weight: 600;
        }
        
        .loading-spinner { display: none; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        #results-section { display: none; }
        .copy-btn { font-size: 0.8rem; padding: 0.25rem 0.5rem; }
        
        .global-features {
            background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%);
            color: white; padding: 2rem; border-radius: var(--border-radius);
            margin: 2rem 0; text-align: center;
        }
        
        .feature-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem; margin: 1.5rem 0;
        }
        
        .feature-item {
            background: rgba(255, 255, 255, 0.2); padding: 1rem;
            border-radius: 12px; text-align: center;
        }
        
        .feature-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .feature-text { font-size: 0.9rem; opacity: 0.9; }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem; border-radius: var(--border-radius);
            margin: 1rem 0;
        }
        
        .demo-url {
            font-family: monospace; background: rgba(0, 0, 0, 0.2);
            padding: 0.5rem; border-radius: 8px; margin: 0.3rem 0;
            font-size: 0.85rem; word-break: break-all;
        }
    </style>
</head>
<body>
    <!-- Language Toggle -->
    <div class="language-toggle">
        <button class="btn btn-outline-light btn-sm" onclick="toggleLanguage()" id="langToggle">
            <i class="fas fa-globe"></i> EN
        </button>
    </div>

    <div class="container">
        <div class="main-container">
            <!-- Header -->
            <div class="header">
                <h1 id="mainTitle">ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h1>
                <p id="mainSubtitle">ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª ÙˆØ§Ù„Ø±Ù…ÙˆØ² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Ø¹Ø±Ø¨ÙŠ â€¢ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ â€¢ Ø±Ù…ÙˆØ² â€¢ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ</p>
            </div>

            <!-- Content -->
            <div class="content">
                <!-- Global Features -->
                <div class="global-features">
                    <h4 id="featuresTitle">ğŸ† Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ</h4>
                    
                    <div class="feature-grid">
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‡ºğŸ‡¸</div>
                            <div class="feature-text" id="feature1">English URLs<br>Ø±ÙˆØ§Ø¨Ø· Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‡ªğŸ‡¬</div>
                            <div class="feature-text" id="feature2">Ø¹Ø±Ø¨ÙŠ Arabic<br>Ø±ÙˆØ§Ø¨Ø· Ø¹Ø±Ø¨ÙŠØ©</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸš€</div>
                            <div class="feature-text" id="feature3">Ø±Ù…ÙˆØ² Symbols<br>#@$%&*</div>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">ğŸ‰</div>
                            <div class="feature-text" id="feature4">Emoji Ø¥ÙŠÙ…ÙˆØ¬ÙŠ<br>ğŸ˜ğŸš€ğŸ‰ğŸ“±</div>
                        </div>
                    </div>
                    
                    <p id="featuresNote" style="opacity: 0.9; font-size: 0.95rem;">
                        âœ¨ Ù†Ø¸Ø§Ù… ØªØ±Ù…ÙŠØ² Ø°ÙƒÙŠ - ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø±Ù…ÙˆØ²
                    </p>
                </div>

                <!-- Demo Section with Real Examples -->
                <div class="demo-section">
                    <h5 id="demoTitle">ğŸ“ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø±ÙˆØ§Ø¨Ø·Ùƒ (Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø³Ø®)</h5>
                    <p id="demoNote">Ø§Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙˆØ±Ø§Ù‹:</p>
                    
                    <div id="demoUrls">
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©</div>
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=Ø¹Ø±Ø¨Ø©-Ù…ØªÙ†Ù‚Ù„Ø©-Ù‚Ø§Ø¨Ù„Ø©-Ù„Ù„Ø·ÙŠ-Ø¨ØºØ·Ø§Ø¡-Ùˆ-Ø¹Ø¬Ù„Ø§Øª</div>
                        <div class="demo-url">https://kuwait-matjar.arabsad.com/./product.html?name=Ø¢Ù„Ø©-Ø¥Ø²Ø§Ù„Ø©-Ø§Ù„Ø´Ø¹Ø±-Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©-usb</div>
                    </div>
                    
                    <button class="btn btn-info btn-sm" onclick="copyDemoUrls()" id="copyDemoBtn">
                        ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    </button>
                </div>

                <!-- Instructions -->
                <div class="alert alert-info mb-4" role="alert">
                    <i class="fas fa-magic me-2"></i>
                    <span id="instructions">
                        Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø£ÙŠ Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡. Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠØŒ Ø£Ø±Ù‚Ø§Ù…ØŒ Ø¹Ù„Ø§Ù…Ø§Øª ØªØ±Ù‚ÙŠÙ….
                    </span>
                </div>

                <!-- Input Section -->
                <div class="mb-4">
                    <label for="urlInput" class="form-label fw-bold" id="inputLabel">
                        <i class="fas fa-paste me-2"></i>Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§ (Ø¨Ø£ÙŠ Ù„ØºØ©)
                    </label>
                    <textarea 
                        class="form-control" 
                        id="urlInput" 
                        rows="12" 
                        placeholder="https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©
https://mystore.com/products/special-offer-2024?utm_source=facebook
https://example.com/path/with-symbols#section_1
https://site.com/ğŸš€âœ¨ğŸ‰-emoji-url
https://store.com/products/ä¸­å›½-chinese-text"
                        style="font-family: 'Courier New', monospace; line-height: 1.4;"
                        dir="ltr"
                    ></textarea>
                    
                    <!-- Real-time Stats -->
                    <div class="row mt-3">
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number" id="totalCount">0</div>
                                <small id="totalLabel">Ø¥Ø¬Ù…Ø§Ù„ÙŠ</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-success" id="validCount">0</div>
                                <small id="validLabel">ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-warning" id="duplicateCount">0</div>
                                <small id="duplicateLabel">Ù…ÙƒØ±Ø±Ø©</small>
                            </div>
                        </div>
                        <div class="col-md-3 mb-2">
                            <div class="stats-card">
                                <div class="stats-number text-danger" id="invalidCount">0</div>
                                <small id="invalidLabel">ØºÙŠØ± ØµØ§Ù„Ø­Ø©</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="text-center mb-4">
                    <button class="btn btn-primary btn-lg me-2" onclick="processUrls()" id="processBtn">
                        <i class="fas fa-magic me-2"></i>
                        <span id="processBtnText">ğŸ¤– Ù…Ø¹Ø§Ù„Ø¬Ø© Ø°ÙƒÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</span>
                        <div class="spinner-border spinner-border-sm ms-2 loading-spinner" role="status"></div>
                    </button>
                    <button class="btn btn-outline-secondary me-2" onclick="copyDemoUrls()" id="demoBtn">
                        <i class="fas fa-clipboard me-2"></i>
                        <span id="demoBtnText">Ù†Ø³Ø® Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±</span>
                    </button>
                    <button class="btn btn-outline-secondary" onclick="clearAll()" id="clearBtn">
                        <i class="fas fa-trash me-2"></i>
                        <span id="clearBtnText">Ù…Ø³Ø­</span>
                    </button>
                </div>

                <!-- Results Section -->
                <div id="results-section" class="fade-in">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 id="resultsTitle">
                            <i class="fas fa-list-check me-2"></i>Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
                        </h4>
                        <div>
                            <button class="btn btn-success me-2" onclick="copyAllShortUrls()" id="copyAllBtn">
                                <i class="fas fa-copy me-2"></i>
                                <span id="copyAllText">Ù†Ø³Ø® Ø§Ù„Ù‚ØµÙŠØ±Ø©</span>
                            </button>
                            <button class="btn btn-info me-2" onclick="copyOriginalUrls()" id="copyOriginalBtn">
                                <i class="fas fa-link me-2"></i>
                                <span id="copyOriginalText">Ù†Ø³Ø® Ø§Ù„Ø£ØµÙ„ÙŠØ©</span>
                            </button>
                            <button class="btn btn-warning" onclick="downloadXLSX()" id="downloadBtn">
                                <i class="fas fa-download me-2"></i>
                                <span id="downloadText">XLSX</span>
                            </button>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped results-table">
                            <thead>
                                <tr>
                                    <th id="indexHeader">#</th>
                                    <th id="originalHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ</th>
                                    <th id="shortHeader">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±</th>
                                    <th id="statusHeader">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th id="actionHeader">Ù†Ø³Ø®</th>
                                </tr>
                            </thead>
                            <tbody id="results-tbody">
                                <!-- Results will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Language translations
        const translations = {
            ar: {
                mainTitle: "ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ",
                mainSubtitle: "ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª ÙˆØ§Ù„Ø±Ù…ÙˆØ² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Ø¹Ø±Ø¨ÙŠ â€¢ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ â€¢ Ø±Ù…ÙˆØ² â€¢ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ",
                featuresTitle: "ğŸ† Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ",
                featuresNote: "âœ¨ Ù†Ø¸Ø§Ù… ØªØ±Ù…ÙŠØ² Ø°ÙƒÙŠ - ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø±Ù…ÙˆØ²",
                demoTitle: "ğŸ“ Ø¹ÙŠÙ†Ø© Ù…Ù† Ø±ÙˆØ§Ø¨Ø·Ùƒ (Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ù†Ø³Ø®)",
                demoNote: "Ø§Ù†Ø³Ø® Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙˆØ±Ø§Ù‹:",
                copyDemoBtn: "ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±",
                instructions: "Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¨Ø£ÙŠ Ù„ØºØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ø¯Ù†Ø§Ù‡. Ø§Ù„Ù†Ø¸Ø§Ù… Ø³ÙŠØ¹Ø§Ù„Ø¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹: Ø¹Ø±Ø¨ÙŠØŒ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØŒ Ø±Ù…ÙˆØ²ØŒ Ø¥ÙŠÙ…ÙˆØ¬ÙŠØŒ Ø£Ø±Ù‚Ø§Ù…ØŒ Ø¹Ù„Ø§Ù…Ø§Øª ØªØ±Ù‚ÙŠÙ….",
                inputLabel: "Ø§Ù„ØµÙ‚ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ù‡Ù†Ø§ (Ø¨Ø£ÙŠ Ù„ØºØ©)",
                totalLabel: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
                validLabel: "ØµØ§Ù„Ø­Ø©",
                duplicateLabel: "Ù…ÙƒØ±Ø±Ø©",
                invalidLabel: "ØºÙŠØ± ØµØ§Ù„Ø­Ø©",
                processBtnText: "ğŸ¤– Ù…Ø¹Ø§Ù„Ø¬Ø© Ø°ÙƒÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©",
                demoBtnText: "Ù†Ø³Ø® Ø¹ÙŠÙ†Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±",
                clearBtnText: "Ù…Ø³Ø­",
                resultsTitle: "Ø±ÙˆØ§Ø¨Ø· Ù‚ØµÙŠØ±Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…",
                copyAllText: "Ù†Ø³Ø® Ø§Ù„Ù‚ØµÙŠØ±Ø©",
                copyOriginalText: "Ù†Ø³Ø® Ø§Ù„Ø£ØµÙ„ÙŠØ©",
                downloadText: "XLSX",
                indexHeader: "#",
                originalHeader: "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ",
                shortHeader: "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±",
                statusHeader: "Ø§Ù„Ø­Ø§Ù„Ø©",
                actionHeader: "Ù†Ø³Ø®",
                copyBtn: "ğŸ“‹",
                processing: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ©...",
                success: "Ø¬Ø§Ù‡Ø² âœ…",
                invalid: "ØºÙŠØ± ØµØ§Ù„Ø­ âŒ",
                duplicate: "Ù…ÙƒØ±Ø± âš ï¸",
                copied: "ØªÙ…!",
                allCopied: "Ù†ÙØ³Ø®Øª Ø¬Ù…ÙŠØ¹Ø§Ù‹!",
                noResults: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬",
                demoCopied: "ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¹ÙŠÙ†Ø©!"
            },
            en: {
                mainTitle: "ğŸŒ Global URL Shortener",
                mainSubtitle: "Supports all languages and symbols automatically - Arabic â€¢ English â€¢ Symbols â€¢ Emoji",
                featuresTitle: "ğŸ† Global System Features",
                featuresNote: "âœ¨ Smart encoding system - handles all text types and symbols automatically",
                demoTitle: "ğŸ“ Sample URLs (Ready to Copy)",
                demoNote: "Copy these URLs into the box below for instant testing:",
                copyDemoBtn: "ğŸ“‹ Copy Sample for Testing",
                instructions: "Paste URLs in any language below. System will automatically handle: Arabic, English, symbols, emoji, numbers, special characters.",
                inputLabel: "Paste URLs here (any language)",
                totalLabel: "Total",
                validLabel: "Valid",
                duplicateLabel: "Duplicates",
                invalidLabel: "Invalid",
                processBtnText: "ğŸ¤– Smart Auto Processing",
                demoBtnText: "Copy Sample for Test",
                clearBtnText: "Clear",
                resultsTitle: "Ready Short Links",
                copyAllText: "Copy Short URLs",
                copyOriginalText: "Copy Original URLs",
                downloadText: "XLSX",
                indexHeader: "#",
                originalHeader: "Original URL",
                shortHeader: "Short URL",
                statusHeader: "Status",
                actionHeader: "Copy",
                copyBtn: "ğŸ“‹",
                processing: "Smart processing...",
                success: "Ready âœ…",
                invalid: "Invalid âŒ",
                duplicate: "Duplicate âš ï¸",
                copied: "Done!",
                allCopied: "All copied!",
                noResults: "No results",
                demoCopied: "Sample copied!"
            }
        };
        
        let currentLang = 'ar';
        let processedResults = [];
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            document.getElementById('urlInput').addEventListener('input', updateStats);
            
            // Load saved language preference
            const savedLang = localStorage.getItem('urlShortenerLang');
            if (savedLang && savedLang !== currentLang) {
                toggleLanguage();
            }
        });
        
        // Language toggle
        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.documentElement.lang = currentLang;
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            
            // Update all text elements
            Object.keys(translations[currentLang]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = translations[currentLang][key];
                }
            });
            
            // Update button text
            document.getElementById('langToggle').innerHTML = `<i class="fas fa-globe"></i> ${currentLang === 'ar' ? 'EN' : 'Ø¹Ø±'}`;  
            
            // Save language preference
            localStorage.setItem('urlShortenerLang', currentLang);
        }
        
        // Advanced URL validation and normalization
        function normalizeUrl(url) {
            if (!url) return url;
            
            try {
                // Clean whitespace and control characters
                url = url.trim().replace(/[\u0000-\u001F\u007F-\u009F]/g, '');
                
                // Add protocol if missing
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                
                // Parse and normalize
                const urlObj = new URL(url);
                
                // Clean pathname: remove /./ and multiple slashes
                let pathname = urlObj.pathname.replace(/\/\.\/+/g, '/').replace(/\/+/g, '/');
                
                // Rebuild normalized URL
                return `${urlObj.protocol}//${urlObj.hostname}${urlObj.port ? ':' + urlObj.port : ''}${pathname}${urlObj.search}${urlObj.hash}`;
                
            } catch (error) {
                console.log('URL normalization failed:', error.message, 'for URL:', url);
                return url;
            }
        }
        
        function isValidUrl(string) {
            try {
                const url = new URL(string);
                return url.protocol === 'http:' || url.protocol === 'https:';
            } catch (_) {
                return false;
            }
        }
        
        // Smart encoding for international URLs
        function smartEncodeUrl(url) {
            try {
                // Normalize first
                const normalized = normalizeUrl(url);
                
                // Parse URL components
                const urlObj = new URL(normalized);
                
                // Encode only the parts that need encoding, preserve structure
                const encodedSearch = urlObj.search ? '?' + urlObj.search.substring(1).split('&')
                    .map(param => {
                        const [key, value] = param.split('=');
                        return `${encodeURIComponent(key)}=${encodeURIComponent(value || '')}`;
                    }).join('&') : '';
                
                // Reconstruct with smart encoding
                return `${urlObj.protocol}//${urlObj.host}${urlObj.pathname}${encodedSearch}${urlObj.hash}`;
                
            } catch (error) {
                console.log('Smart encoding failed:', error.message);
                return encodeURIComponent(url);
            }
        }
        
        function generateShortUrl(originalUrl, index) {
            const baseUrl = 'https://sherow1982.github.io/arabic-ads-calculator-tools/s.html';
            
            // Try to use direct URL encoding for maximum compatibility
            const encodedOriginal = encodeURIComponent(originalUrl);
            
            // If encoded URL is reasonably short, use direct mode
            if (encodedOriginal.length < 2000) {
                return `${baseUrl}?to=${encodedOriginal}`;
            }
            
            // Otherwise use index-based approach
            return `${baseUrl}?to=${index}`;
        }
        
        // Update statistics with enhanced validation
        function updateStats() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            let validCount = 0;
            let invalidCount = 0;
            let duplicateCount = 0;
            const seen = new Set();
            
            lines.forEach(line => {
                const url = line.trim();
                if (url === '') return;
                
                const normalizedUrl = normalizeUrl(url);
                
                if (seen.has(normalizedUrl)) {
                    duplicateCount++;
                } else {
                    seen.add(normalizedUrl);
                    if (isValidUrl(normalizedUrl)) {
                        validCount++;
                    } else {
                        invalidCount++;
                    }
                }
            });
            
            document.getElementById('totalCount').textContent = lines.length;
            document.getElementById('validCount').textContent = validCount;
            document.getElementById('duplicateCount').textContent = duplicateCount;
            document.getElementById('invalidCount').textContent = invalidCount;
        }
        
        // Process URLs with smart encoding
        async function processUrls() {
            const input = document.getElementById('urlInput').value;
            const lines = input.split('\n').filter(line => line.trim() !== '');
            
            if (lines.length === 0) {
                alert(currentLang === 'ar' ? 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©' : 'Please enter URLs to process');
                return;
            }
            
            if (lines.length > 1000) {
                alert(currentLang === 'ar' ? 'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ (1000 Ø±Ø§Ø¨Ø·)' : 'Maximum limit exceeded (1000 URLs)');
                return;
            }
            
            // Show loading
            const processBtn = document.getElementById('processBtn');
            const spinner = processBtn.querySelector('.loading-spinner');
            const btnText = document.getElementById('processBtnText');
            
            processBtn.disabled = true;
            spinner.style.display = 'inline-block';
            btnText.textContent = translations[currentLang].processing;
            
            processedResults = [];
            const tbody = document.getElementById('results-tbody');
            tbody.innerHTML = '';
            
            const seenUrls = new Set();
            let validIndex = 1;
            
            // Process each URL with smart encoding
            for (let i = 0; i < lines.length; i++) {
                const originalUrl = lines[i].trim();
                if (originalUrl === '') continue;
                
                const normalizedUrl = normalizeUrl(originalUrl);
                let status, shortUrl, shortCode;
                
                if (seenUrls.has(normalizedUrl)) {
                    status = 'duplicate';
                    shortUrl = '';
                    shortCode = '';
                } else if (!isValidUrl(normalizedUrl)) {
                    status = 'invalid';
                    shortUrl = '';
                    shortCode = '';
                } else {
                    seenUrls.add(normalizedUrl);
                    
                    // Generate short URL with smart encoding
                    shortCode = validIndex.toString();
                    shortUrl = generateShortUrl(normalizedUrl, validIndex);
                    
                    validIndex++;
                    status = 'success';
                }
                
                const result = {
                    original: originalUrl,
                    normalized: normalizedUrl,
                    short: shortUrl,
                    shortCode: shortCode,
                    status: status,
                    displayIndex: i + 1
                };
                
                processedResults.push(result);
                addResultRow(result);
                
                // Smooth UI updates
                if (i % 3 === 0) {
                    await new Promise(resolve => setTimeout(resolve, 50));
                }
            }
            
            // Hide loading and show results
            processBtn.disabled = false;
            spinner.style.display = 'none';
            btnText.innerHTML = translations[currentLang].processBtnText;
            
            document.getElementById('results-section').style.display = 'block';
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth' });
            
            // Success notification
            const successCount = processedResults.filter(r => r.status === 'success').length;
            const successMsg = currentLang === 'ar' 
                ? `ğŸ‰ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${successCount} Ø±Ø§Ø¨Ø· Ù‚ØµÙŠØ± Ø¨Ù†Ø¬Ø§Ø­!`
                : `ğŸ‰ Successfully created ${successCount} short links!`;
            
            setTimeout(() => {
                alert(successMsg + '\n\n' + (currentLang === 'ar' 
                    ? 'âœ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· ØªØ¹Ù…Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ - Ø¨Ø£ÙŠ Ù„ØºØ© ÙˆØ±Ù…ÙˆØ²!' 
                    : 'âœ¨ All links work instantly - with any language and symbols!'));
            }, 500);
        }
        
        // Enhanced result row with better encoding display
        function addResultRow(result) {
            const tbody = document.getElementById('results-tbody');
            const row = document.createElement('tr');
            
            const statusText = translations[currentLang][result.status] || result.status;
            const statusClass = {
                'success': 'bg-success text-white',
                'failed': 'bg-danger text-white',
                'duplicate': 'bg-warning text-dark',
                'invalid': 'bg-secondary text-white'
            }[result.status] || 'bg-secondary text-white';
            
            // Truncate very long URLs for display
            const displayOriginal = result.original.length > 80 
                ? result.original.substring(0, 77) + '...' 
                : result.original;
            
            row.innerHTML = `
                <td><strong>${result.displayIndex}</strong></td>
                <td class="url-cell" title="${result.original}">${displayOriginal}</td>
                <td class="url-cell">
                    ${result.short ? `<a href="${result.short}" target="_blank" rel="noopener" style="color: #2563eb; font-weight: 600;">Ø±Ø§Ø¨Ø· Ù‚ØµÙŠØ± #${result.shortCode}</a>` : '-'}
                </td>
                <td>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                </td>
                <td>
                    ${result.short ? `<button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyUrl('${result.short}')" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±">
                        ${translations[currentLang].copyBtn}
                    </button>` : '-'}
                </td>
            `;
            
            tbody.appendChild(row);
        }
        
        // Copy functions with enhanced feedback
        function copyUrl(url) {
            navigator.clipboard.writeText(url).then(() => {
                const btn = event.target.closest('button');
                const originalText = btn.innerHTML;
                btn.innerHTML = translations[currentLang].copied;
                btn.classList.add('btn-success');
                btn.classList.remove('btn-outline-primary');
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('btn-success');
                    btn.classList.add('btn-outline-primary');
                }, 2000);
            });
        }
        
        function copyAllShortUrls() {
            const successfulResults = processedResults.filter(r => r.status === 'success');
            if (successfulResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø¬Ø§Ù‡Ø²Ø©' : 'No ready URLs');
                return;
            }
            
            const textToCopy = successfulResults.map(r => r.short).join('\n');
            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = document.getElementById('copyAllBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fas fa-check me-2"></i>${translations[currentLang].allCopied}`;
                setTimeout(() => { btn.innerHTML = originalText; }, 3000);
            });
        }
        
        function copyOriginalUrls() {
            const successfulResults = processedResults.filter(r => r.status === 'success');
            if (successfulResults.length === 0) {
                alert(currentLang === 'ar' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ø¬Ø§Ù‡Ø²Ø©' : 'No ready URLs');
                return;
            }
            
            const textToCopy = successfulResults.map(r => r.original).join('\n');
            navigator.clipboard.writeText(textToCopy).then(() => {
                const btn = document.getElementById('copyOriginalBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i class="fas fa-check me-2"></i>Ù†ÙØ³Ø®Øª!`;
                setTimeout(() => { btn.innerHTML = originalText; }, 3000);
            });
        }
        
        function copyDemoUrls() {
            const demoUrls = [
                'https://kuwait-matjar.arabsad.com/./product.html?name=3-Ù‚Ø·Ø¹-ÙƒØ§Ù…ÙŠØ±Ø§-Ù…Ø±Ø§Ù‚Ø¨Ø©-ØªØ¹Ù…Ù„-Ø¨Ø§Ù„Ø·Ø§Ù‚Ø©-Ø§Ù„Ø´Ù…Ø³ÙŠØ©',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø¹Ø±Ø¨Ø©-Ù…ØªÙ†Ù‚Ù„Ø©-Ù‚Ø§Ø¨Ù„Ø©-Ù„Ù„Ø·ÙŠ-Ø¨ØºØ·Ø§Ø¡-Ùˆ-Ø¹Ø¬Ù„Ø§Øª',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø¢Ù„Ø©-Ø¥Ø²Ø§Ù„Ø©-Ø§Ù„Ø´Ø¹Ø±-Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©-usb',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ø®Ù„Ø§Ø·-ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ-2-Ù„ØªØ±',
                'https://kuwait-matjar.arabsad.com/./product.html?name=Ù…Ù†Ø¸Ù…-Ø¸Ù‡Ø±-Ù„Ù…Ù‚Ø¹Ø¯-Ø§Ù„Ø³ÙŠØ§Ø±Ø©'
            ].join('\n');
            
            document.getElementById('urlInput').value = demoUrls;
            updateStats();
            
            const btn = document.getElementById('demoBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = `<i class="fas fa-check me-2"></i>${translations[currentLang].demoCopied}`;
            setTimeout(() => { btn.innerHTML = originalText; }, 2000);
        }
        
        // Enhanced XLSX export with encoding information
        function downloadXLSX() {
            if (processedResults.length === 0) {
                alert(translations[currentLang].noResults);
                return;
            }
            
            const data = processedResults.map((result, index) => {
                const shortUrl = result.short ? result.short.substring(result.short.indexOf('s.html')) : '';
                
                return {
                    'Ø±Ù‚Ù… / #': result.displayIndex,
                    'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ / Original URL': result.original,
                    'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± / Short URL': result.short || '',
                    'Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ / Full Short URL': result.short || '',
                    'Ø§Ù„Ø±Ù…Ø² / Code': result.shortCode || '',
                    'Ø§Ù„Ø­Ø§Ù„Ø© / Status': translations[currentLang][result.status] || result.status,
                    'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ±Ù…ÙŠØ² / Encoding Info': result.normalized !== result.original ? 'ØªÙ… Ø§Ù„ØªØ·Ø¨ÙŠØ¹' : 'Ø¹Ø§Ø¯ÙŠ',
                    'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ / Created': new Date().toLocaleString(currentLang === 'ar' ? 'ar-EG' : 'en-US')
                };
            });
            
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Instructions sheet with encoding details
            const instructions = [
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'ğŸŒ Ù…Ø®ØªØµØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ - ÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„ØºØ§Øª' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'âœ… Ù…Ø§ ÙŠØ¯Ø¹Ù…Ù‡ Ø§Ù„Ù†Ø¸Ø§Ù…:' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'â€¢ Ø±ÙˆØ§Ø¨Ø· Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø§Øª Ø¹Ø±Ø¨ÙŠØ©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'â€¢ Ø±ÙˆØ§Ø¨Ø· Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ø±Ù…ÙˆØ² Ø®Ø§ØµØ©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'â€¢ Ø±ÙˆØ§Ø¨Ø· Ø¨Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙˆØ±Ù…ÙˆØ² Unicode' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'â€¢ Ù…Ø¹Ø§Ù„Ø¬Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„ØºÙŠØ± Ù‚ÙŠØ§Ø³ÙŠØ©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'â€¢ ØªØ±Ù…ÙŠØ² UTF-8 Ø¢Ù…Ù† Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØµØ§Øª' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'ğŸš€ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '1. Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ± Ù…Ù† Ø¹Ù…ÙˆØ¯ "Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±"' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '2. Ø§Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ Ø­Ù…Ù„Ø§ØªÙƒ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ÙŠØ©' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '3. Ø§Ù„Ø±Ø§Ø¨Ø· Ø³ÙŠØ¹ÙŠØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø£ØµÙ„ÙŠ' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '4. Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØµØ§Øª: FB, Google, Snap, TikTok' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': '' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ:' },
                { 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª / Instructions': 'https://sherow1982.github.io/arabic-ads-calculator-tools/s.html?to=1' }
            ];
            
            const instructionsWs = XLSX.utils.json_to_sheet(instructions);
            
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, currentLang === 'ar' ? 'Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø©' : 'Short URLs');
            XLSX.utils.book_append_sheet(wb, instructionsWs, currentLang === 'ar' ? 'Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª' : 'Instructions');
            
            const filename = `global-short-urls-${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
        }
        
        function clearAll() {
            if (confirm(currentLang === 'ar' ? 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ' : 'Clear all data?')) {
                document.getElementById('urlInput').value = '';
                document.getElementById('results-section').style.display = 'none';
                processedResults = [];
                updateStats();
            }
        }
    </script>
</body>
</html>