<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø®ØªØµØ±/Ù…Ø¬Ù…Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· - Ø¹Ø±Ø¨ÙŠ</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body{font-family:'Cairo',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh}
    .app{background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.1);margin:24px auto;max-width:1100px;overflow:hidden}
    .header{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff;padding:28px;text-align:center}
    .pill{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.3);padding:8px 14px;border-radius:999px;display:inline-flex;gap:8px;align-items:center}
    .tool-tabs{display:flex;gap:10px;flex-wrap:wrap}
    .tool-tabs .btn{border-radius:999px}
    .card{border:2px solid #e2e8f0;border-radius:14px}
    textarea{font-family:monospace;direction:ltr}
    .url-cell{font-family:monospace;background:#f8fafc;border-radius:8px;padding:6px}
    .badge-soft{border-radius:999px;padding:.35rem .7rem;border:1px solid #e2e8f0}
  </style>
</head>
<body>
  <div class="container app">
    <div class="header">
      <h1 class="h3 fw-bold mb-2">ğŸŒ Ù…Ø®ØªØµØ±/Ù…Ø¬Ù…Ù„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ</h1>
      <div class="pill">ÙŠØ¯Ø¹Ù…: ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø· â€¢ ØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚Ø¨ÙŠØ­Ø© (Pretty URLs)</div>
    </div>

    <div class="p-4">
      <div class="tool-tabs mb-3">
        <button class="btn btn-primary btn-sm" id="tabShorten"><i class="fa-solid fa-scissors me-1"></i> ØªÙ‚ØµÙŠØ± Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</button>
        <button class="btn btn-outline-primary btn-sm" id="tabPretty"><i class="fa-solid fa-wand-magic-sparkles me-1"></i> ØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ø¨ÙŠØ­</button>
      </div>

      <div class="alert alert-info" id="infoShorten">
        Ø§Ù„ØµÙ‚ Ø­ØªÙ‰ 1000 Ø±Ø§Ø¨Ø· ÙˆØ³Ù†ÙÙ†Ø´Ø¦ Ù„Ùƒ Ø£ÙƒÙˆØ§Ø¯ Ù‚ØµÙŠØ±Ø© Ù…Ø«Ù„ k1, k2 ... ØªØ¹Ù…Ù„ Ø¹Ø¨Ø±: s.html?to=CODE
      </div>
      <div class="alert alert-success d-none" id="infoPretty">
        Ø§Ù„ØµÙ‚ Ø±Ø§Ø¨Ø·Ø§Ù‹ "Ù‚Ø¨ÙŠØ­Ø§Ù‹" (Ø¨Ø§Ø±Ø§Ù…ØªØ±Ø§Øª Ø·ÙˆÙŠÙ„Ø©/Ø£Ø­Ø±Ù ØºÙŠØ± Ù†Ø¸ÙŠÙØ©) ÙˆØ³Ù†ÙÙ†Ø´Ø¦ Ù„Ùƒ Ø±Ø§Ø¨Ø·Ø§Ù‹ Ø¬Ù…ÙŠÙ„Ø§Ù‹ ÙˆÙ‚ØµÙŠØ±Ø§Ù‹ ÙˆØ«Ø§Ø¨ØªØ§Ù‹ (Slug) + Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ ØªØ¹Ù…Ù„.
      </div>

      <div class="mb-3">
        <label class="form-label fw-bold"><i class="fa-solid fa-link me-1"></i> Ø§Ù„Ø±ÙˆØ§Ø¨Ø· (ÙƒÙ„ Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø±)</label>
        <textarea id="input" class="form-control" rows="10" placeholder="https://example.com/product?id=123&name=Ù…Ù†ØªØ¬-ØªØ¬Ø±ÙŠØ¨ÙŠ&src=fb"></textarea>
      </div>

      <div class="d-flex gap-2 mb-3">
        <button class="btn btn-primary" id="actionShorten"><i class="fa-solid fa-scissors me-2"></i>ØªÙ‚ØµÙŠØ±</button>
        <button class="btn btn-success" id="actionPretty"><i class="fa-solid fa-wand-magic-sparkles me-2"></i>ØªØ¬Ù…ÙŠÙ„</button>
        <button class="btn btn-outline-secondary" id="clear"><i class="fa-solid fa-trash me-2"></i>Ù…Ø³Ø­</button>
      </div>

      <div id="results" class="card p-3 d-none">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="m-0"><i class="fa-solid fa-list-ul me-2"></i>Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h5>
          <div class="d-flex gap-2">
            <button class="btn btn-sm btn-success" id="copyShort"><i class="fa-solid fa-copy me-1"></i>Ù†Ø³Ø® Ø§Ù„Ù‚ØµÙŠØ±Ø©</button>
            <button class="btn btn-sm btn-info text-white" id="copyPretty"><i class="fa-solid fa-copy me-1"></i>Ù†Ø³Ø® Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©</button>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table align-middle">
            <thead>
              <tr>
                <th>#</th>
                <th>Ø§Ù„Ø£ØµÙ„ÙŠ</th>
                <th>Ø§Ù„Ù‚ØµÙŠØ±</th>
                <th>Ø§Ù„Ø¬Ù…ÙŠÙ„ (Slug)</th>
                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    const BASE = 'https://sherow1982.github.io/arabic-ads-calculator-tools';
    const SHORT_BASE = `${BASE}/s.html?to=`; // s.html?to=CODE

    // Arabic-friendly slugify (URL beautifier)
    function slugify(input){
      if(!input) return '';
      let s = input.trim();
      try{ s = decodeURIComponent(s); }catch(_){ }
      // Ø§Ø³ØªØ®Ø±Ø¬ name= Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¥Ù† ÙˆÙØ¬Ø¯
      try{
        const u = new URL(s);
        const qp = new URLSearchParams(u.search);
        const name = qp.get('name') || qp.get('title') || qp.get('q') || '';
        if(name) s = name;
      }catch(_){ }
      // Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ© Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§ + Ø£Ø±Ù‚Ø§Ù… + Ø´Ø±Ø·Ø©
      s = s
        .replace(/[\u0000-\u001F\u007F]/g,'')
        .replace(/\s+/g,'-')
        .replace(/[\u0600-\u06FFa-zA-Z0-9\-]+/g, m=>m)
        .replace(/[^\u0600-\u06FFa-zA-Z0-9\-]+/g,'-')
        .replace(/-+/g,'-')
        .replace(/^-|-$/g,'')
        .toLowerCase();
      return s.substring(0,80);
    }

    function normalizeUrl(url){
      url = url.trim();
      if(!/^https?:\/\//.test(url)) url = 'https://' + url;
      try{
        const u = new URL(url);
        const cleanPath = u.pathname.replace(/\/\.\//g,'/').replace(/\/+/g,'/');
        return `${u.protocol}//${u.host}${cleanPath}${u.search}${u.hash}`;
      }catch{ return url; }
    }

    function genShort(i, url){
      return SHORT_BASE + 'k' + i; // k1,k2,k3...
    }

    function genPretty(url){
      const slug = slugify(url);
      // ØµÙŠØºØ© Ø±Ø§Ø¨Ø· Ø¬Ù…ÙŠÙ„ Ø«Ø§Ø¨Øª Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹
      return { slug, pretty: `${BASE}/${slug}` };
    }

    function process(mode){
      const lines = document.getElementById('input').value.split('\n').filter(l=>l.trim()!== '');
      const tbody = document.getElementById('tbody');
      tbody.innerHTML = '';
      const shortList = []; const prettyList = [];
      lines.forEach((line, idx)=>{
        const original = normalizeUrl(line);
        const shortUrl = genShort(idx+1, original);
        const {slug, pretty} = genPretty(original);
        shortList.push(shortUrl);
        prettyList.push(pretty);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${idx+1}</td>
          <td class="url-cell" dir="ltr">${original}</td>
          <td class="url-cell"><a href="${shortUrl}" target="_blank">${shortUrl}</a></td>
          <td class="url-cell"><span class="badge badge-soft">/${slug}</span> <a href="${pretty}" target="_blank">${pretty}</a></td>
          <td><span class="badge bg-success">Ø¬Ø§Ù‡Ø²</span></td>`;
        tbody.appendChild(tr);
      });
      document.getElementById('results').classList.remove('d-none');
      document.getElementById('copyShort').onclick = ()=> navigator.clipboard.writeText(shortList.join('\n'));
      document.getElementById('copyPretty').onclick = ()=> navigator.clipboard.writeText(prettyList.join('\n'));
    }

    // Tabs
    const tabShorten = document.getElementById('tabShorten');
    const tabPretty  = document.getElementById('tabPretty');
    const infoShorten= document.getElementById('infoShorten');
    const infoPretty = document.getElementById('infoPretty');

    tabShorten.onclick = ()=>{
      tabShorten.classList.replace('btn-outline-primary','btn-primary');
      tabPretty.classList.replace('btn-primary','btn-outline-primary');
      infoShorten.classList.remove('d-none');
      infoPretty.classList.add('d-none');
    };
    tabPretty.onclick = ()=>{
      tabPretty.classList.replace('btn-outline-primary','btn-primary');
      tabShorten.classList.replace('btn-primary','btn-outline-primary');
      infoPretty.classList.remove('d-none');
      infoShorten.classList.add('d-none');
    };

    // Actions
    document.getElementById('actionShorten').onclick = ()=>process('shorten');
    document.getElementById('actionPretty').onclick  = ()=>process('pretty');
    document.getElementById('clear').onclick = ()=>{
      document.getElementById('input').value='';
      document.getElementById('results').classList.add('d-none');
    };
  </script>
</body>
</html>
